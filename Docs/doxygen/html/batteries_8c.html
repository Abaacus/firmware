<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>BMU: /Users/Richard/Documents/Waterloo/WFE/Code.nosync/2018_bmu-2/Src/batteries.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">BMU
   </div>
   <div id="projectbrief">BatteryManagementUnit</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_413f4e031a85da0d68269c6fd2f76e1c.html">Src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">batteries.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Battery Monitoring, Charging, HV Bus Sense, IMD monitor.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="batteries_8h_source.html">batteries.h</a>&quot;</code><br />
<code>#include &quot;FreeRTOS.h&quot;</code><br />
<code>#include &quot;cmsis_os.h&quot;</code><br />
<code>#include &quot;task.h&quot;</code><br />
<code>#include &quot;<a class="el" href="control_state_machine_8h_source.html">controlStateMachine.h</a>&quot;</code><br />
<code>#include &quot;debug.h&quot;</code><br />
<code>#include &quot;math.h&quot;</code><br />
<code>#include &quot;<a class="el" href="_b_m_u__can_8h_source.html">BMU_can.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_b_m_u__dtc_8h_source.html">BMU_dtc.h</a>&quot;</code><br />
<code>#include &quot;boardTypes.h&quot;</code><br />
<code>#include &quot;watchdog.h&quot;</code><br />
<code>#include &quot;<a class="el" href="can_receive_8h_source.html">canReceive.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="charger_control_8h_source.html">chargerControl.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for batteries.c:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8c__incl.png" border="0" usemap="#_2_users_2_richard_2_documents_2_waterloo_2_w_f_e_2_code_8nosync_22018__bmu-2_2_src_2batteries_8c" alt=""/></div>
<map name="_2_users_2_richard_2_documents_2_waterloo_2_w_f_e_2_code_8nosync_22018__bmu-2_2_src_2batteries_8c" id="_2_users_2_richard_2_documents_2_waterloo_2_w_f_e_2_code_8nosync_22018__bmu-2_2_src_2batteries_8c">
<area shape="rect" title="Battery Monitoring, Charging, HV Bus Sense, IMD monitor." alt="" coords="740,5,932,61"/>
<area shape="rect" href="batteries_8h.html" title=" " alt="" coords="535,109,617,136"/>
<area shape="rect" title=" " alt="" coords="495,184,591,211"/>
<area shape="rect" title=" " alt="" coords="406,259,506,285"/>
<area shape="rect" title=" " alt="" coords="911,109,1001,136"/>
<area shape="rect" title=" " alt="" coords="1025,109,1084,136"/>
<area shape="rect" href="control_state_machine_8h.html" title=" " alt="" coords="149,109,301,136"/>
<area shape="rect" title=" " alt="" coords="1109,109,1177,136"/>
<area shape="rect" title=" " alt="" coords="1201,109,1263,136"/>
<area shape="rect" href="_b_m_u__can_8h.html" title=" " alt="" coords="369,109,460,136"/>
<area shape="rect" href="_b_m_u__dtc_8h.html" title=" " alt="" coords="1288,109,1376,136"/>
<area shape="rect" title=" " alt="" coords="1401,109,1490,136"/>
<area shape="rect" href="can_receive_8h.html" title=" " alt="" coords="785,109,887,136"/>
<area shape="rect" href="charger_control_8h.html" title=" " alt="" coords="642,109,761,136"/>
<area shape="rect" title=" " alt="" coords="615,184,683,211"/>
<area shape="rect" href="bsp_8h.html" title="Board support package (BSP) header file." alt="" coords="707,184,762,211"/>
<area shape="rect" title=" " alt="" coords="876,259,937,285"/>
<area shape="rect" title=" " alt="" coords="962,259,1017,285"/>
<area shape="rect" title=" " alt="" coords="531,259,581,285"/>
<area shape="rect" title=" " alt="" coords="605,259,680,285"/>
<area shape="rect" title=" " alt="" coords="705,259,765,285"/>
<area shape="rect" title=" " alt="" coords="789,259,851,285"/>
<area shape="rect" title=" " alt="" coords="166,184,285,211"/>
<area shape="rect" title=" " alt="" coords="23,184,142,211"/>
<area shape="rect" title=" " alt="" coords="309,184,419,211"/>
<area shape="rect" title=" " alt="" coords="1291,184,1373,211"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:aadfade60a9946687e6a1a4a24b70fb4c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#aadfade60a9946687e6a1a4a24b70fb4c">ENABLE_IMD</a></td></tr>
<tr class="separator:aadfade60a9946687e6a1a4a24b70fb4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa31c40ba22e94296395602249e2b25eb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#aa31c40ba22e94296395602249e2b25eb">ENABLE_HV_MEASURE</a></td></tr>
<tr class="separator:aa31c40ba22e94296395602249e2b25eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2828019bbccc5743ed8275fc9a4fe1a3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a2828019bbccc5743ed8275fc9a4fe1a3">ENABLE_AMS</a></td></tr>
<tr class="separator:a2828019bbccc5743ed8275fc9a4fe1a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fea424f5555dcbb0ba5c1e4871e855f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a9fea424f5555dcbb0ba5c1e4871e855f">ENABLE_CHARGER</a></td></tr>
<tr class="separator:a9fea424f5555dcbb0ba5c1e4871e855f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ba2127550d368f846692fdcf3ca095f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a8ba2127550d368f846692fdcf3ca095f">ENABLE_BALANCE</a></td></tr>
<tr class="separator:a8ba2127550d368f846692fdcf3ca095f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62b353ffb0e0f9735e0c6a32712e85b2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a62b353ffb0e0f9735e0c6a32712e85b2">BATTERY_TASK_PERIOD_MS</a>&#160;&#160;&#160;100</td></tr>
<tr class="separator:a62b353ffb0e0f9735e0c6a32712e85b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d5ce7bfac0354a10a78a45aa0ebaacf"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a6d5ce7bfac0354a10a78a45aa0ebaacf">BATTERY_CHARGE_TASK_PERIOD_MS</a>&#160;&#160;&#160;2000</td></tr>
<tr class="separator:a6d5ce7bfac0354a10a78a45aa0ebaacf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb85d8df3b9f6218cb677ccd44760cd4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#aeb85d8df3b9f6218cb677ccd44760cd4">BATTERY_TASK_ID</a>&#160;&#160;&#160;2</td></tr>
<tr class="separator:aeb85d8df3b9f6218cb677ccd44760cd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4b530cc846953d732a4582912f703d2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#aa4b530cc846953d732a4582912f703d2">LIMIT_OVERVOLTAGE</a>&#160;&#160;&#160;4.2F</td></tr>
<tr class="separator:aa4b530cc846953d732a4582912f703d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a582698c135482c98c6911f0bdbf8d1ad"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a582698c135482c98c6911f0bdbf8d1ad">LIMIT_HIGHVOLTAGE</a>&#160;&#160;&#160;4.2F</td></tr>
<tr class="separator:a582698c135482c98c6911f0bdbf8d1ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f9e0b5026ad096458f1bdcc559cfab7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a2f9e0b5026ad096458f1bdcc559cfab7">LIMIT_LOWVOLTAGE</a>&#160;&#160;&#160;3.0F</td></tr>
<tr class="separator:a2f9e0b5026ad096458f1bdcc559cfab7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6136cb9cd8ceabce6e9fdda8cb05c3bd"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a6136cb9cd8ceabce6e9fdda8cb05c3bd">LIMIT_UNDERVOLTAGE</a>&#160;&#160;&#160;3.0F</td></tr>
<tr class="separator:a6136cb9cd8ceabce6e9fdda8cb05c3bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4cdc344852b65658b9d24c04473f26d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#ab4cdc344852b65658b9d24c04473f26d">LIMIT_LOWVOLTAGE_WARNING</a>&#160;&#160;&#160;3.2F</td></tr>
<tr class="separator:ab4cdc344852b65658b9d24c04473f26d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a374bf63b81c93c7d9e76601f46b9f184"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a374bf63b81c93c7d9e76601f46b9f184">CELL_TIME_TO_FAILURE_ALLOWABLE</a>&#160;&#160;&#160;(6.0)</td></tr>
<tr class="separator:a374bf63b81c93c7d9e76601f46b9f184"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace79b123d44fbbb7d6b78e0e9fa98930"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#ace79b123d44fbbb7d6b78e0e9fa98930">CELL_DCR</a>&#160;&#160;&#160;(0.01)</td></tr>
<tr class="separator:ace79b123d44fbbb7d6b78e0e9fa98930"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16227ae24d95ceebf83b650ccdb0dfa4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a16227ae24d95ceebf83b650ccdb0dfa4">CELL_HEAT_CAPACITY</a>&#160;&#160;&#160;(1034.2)</td></tr>
<tr class="separator:a16227ae24d95ceebf83b650ccdb0dfa4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8fec377e4c098c8c294afce44c6c69d0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a8fec377e4c098c8c294afce44c6c69d0">CELL_MASS</a>&#160;&#160;&#160;(0.496)</td></tr>
<tr class="separator:a8fec377e4c098c8c294afce44c6c69d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa72653c5b21b8d21a14cdba38e71c6eb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#aa72653c5b21b8d21a14cdba38e71c6eb">CELL_OVERTEMP</a>&#160;&#160;&#160;(<a class="el" href="batteries_8h.html#aca152be2322f2c62c655e2a234c88fd3">CELL_MAX_TEMP_C</a>)</td></tr>
<tr class="separator:aa72653c5b21b8d21a14cdba38e71c6eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8531f997baa2780a823499e18bdebec3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a8531f997baa2780a823499e18bdebec3">CELL_OVERTEMP_WARNING</a>&#160;&#160;&#160;(<a class="el" href="batteries_8h.html#aca152be2322f2c62c655e2a234c88fd3">CELL_MAX_TEMP_C</a> - 10)</td></tr>
<tr class="separator:a8531f997baa2780a823499e18bdebec3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5819e811f281911c5854f40cf58960f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#ad5819e811f281911c5854f40cf58960f">BALANCE_START_VOLTAGE</a>&#160;&#160;&#160;(3.5F)</td></tr>
<tr class="memdesc:ad5819e811f281911c5854f40cf58960f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Block balancing below this cell voltage.  <a href="batteries_8c.html#ad5819e811f281911c5854f40cf58960f">More...</a><br /></td></tr>
<tr class="separator:ad5819e811f281911c5854f40cf58960f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7647190367a5af57c404c325ede1e56"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#ae7647190367a5af57c404c325ede1e56">CELL_RELAXATION_TIME_MS</a>&#160;&#160;&#160;(1000)</td></tr>
<tr class="memdesc:ae7647190367a5af57c404c325ede1e56"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pause balancing for this length when reading cell voltages to get good readings.  <a href="batteries_8c.html#ae7647190367a5af57c404c325ede1e56">More...</a><br /></td></tr>
<tr class="separator:ae7647190367a5af57c404c325ede1e56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c3f97f617827a946894da14b7e6e4d4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a1c3f97f617827a946894da14b7e6e4d4">CHARGE_STOP_SOC</a>&#160;&#160;&#160;(98.0)</td></tr>
<tr class="memdesc:a1c3f97f617827a946894da14b7e6e4d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">SoC to stop charging at (of the cell with lowest SoC)  <a href="batteries_8c.html#a1c3f97f617827a946894da14b7e6e4d4">More...</a><br /></td></tr>
<tr class="separator:a1c3f97f617827a946894da14b7e6e4d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3840db84d2eaac3f4fe59941e21ff410"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a3840db84d2eaac3f4fe59941e21ff410">CHARGE_CART_HEARTBEAT_MAX_PERIOD</a>&#160;&#160;&#160;(1000)</td></tr>
<tr class="separator:a3840db84d2eaac3f4fe59941e21ff410"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68aaf77b085834ea0c03a6ab2e2910f6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a68aaf77b085834ea0c03a6ab2e2910f6">CHARGE_DEFAULT_MAX_CURRENT</a>&#160;&#160;&#160;5</td></tr>
<tr class="memdesc:a68aaf77b085834ea0c03a6ab2e2910f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default charging current limit (Amps)  <a href="batteries_8c.html#a68aaf77b085834ea0c03a6ab2e2910f6">More...</a><br /></td></tr>
<tr class="separator:a68aaf77b085834ea0c03a6ab2e2910f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa9233fe54ffd66274a5dd46390b36e5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#aaa9233fe54ffd66274a5dd46390b36e5">BALANCE_RECHECK_PERIOD_MS</a>&#160;&#160;&#160;(3000)</td></tr>
<tr class="separator:aaa9233fe54ffd66274a5dd46390b36e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ec6365ec832a79d6e0633c4f49b3b55"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a4ec6365ec832a79d6e0633c4f49b3b55">NUM_SOC_LOOKUP_VALS</a>&#160;&#160;&#160;101</td></tr>
<tr class="separator:a4ec6365ec832a79d6e0633c4f49b3b55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affc1e4ab7cea9fe57082528ac006cc50"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#affc1e4ab7cea9fe57082528ac006cc50">HV_MEASURE_TASK_PERIOD_MS</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:affc1e4ab7cea9fe57082528ac006cc50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4536de5261b4bd382b10d69f857dbe3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#ab4536de5261b4bd382b10d69f857dbe3">HV_MEASURE_TASK_ID</a>&#160;&#160;&#160;4</td></tr>
<tr class="separator:ab4536de5261b4bd382b10d69f857dbe3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0fc9cbf2e0173158d4cd0536059a272f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a0fc9cbf2e0173158d4cd0536059a272f">STATE_BUS_HV_CAN_SEND_PERIOD_MS</a>&#160;&#160;&#160;500</td></tr>
<tr class="separator:a0fc9cbf2e0173158d4cd0536059a272f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a918bb56d5d536252807bb42ab03b3728"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a918bb56d5d536252807bb42ab03b3728">IMD_TASK_PERIOD_MS</a>&#160;&#160;&#160;1000</td></tr>
<tr class="separator:a918bb56d5d536252807bb42ab03b3728"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a2f513c66eeae901bf7536957487e74"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a5a2f513c66eeae901bf7536957487e74">IMD_TASK_ID</a>&#160;&#160;&#160;5</td></tr>
<tr class="separator:a5a2f513c66eeae901bf7536957487e74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1951643638039378eccc6e0ffef18a22"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a1951643638039378eccc6e0ffef18a22">IBUS_FILTER_ALPHA</a>&#160;&#160;&#160;0.24</td></tr>
<tr class="memdesc:a1951643638039378eccc6e0ffef18a22"><td class="mdescLeft">&#160;</td><td class="mdescRight">Filter constant for HV Bus current low pass filter Designed around 1 ms sample period and 50 Hz cuttoff. See the wikipedia page for the calculation: <a href="https://en.wikipedia.org/wiki/Low-pass_filter#Simple_infinite_impulse_response_filter">https://en.wikipedia.org/wiki/Low-pass_filter#Simple_infinite_impulse_response_filter</a>.  <a href="batteries_8c.html#a1951643638039378eccc6e0ffef18a22">More...</a><br /></td></tr>
<tr class="separator:a1951643638039378eccc6e0ffef18a22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4389fd57fbbb4a3c70d7a626285eaa0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#ad4389fd57fbbb4a3c70d7a626285eaa0">MAX_ERROR_COUNT</a>&#160;&#160;&#160;3</td></tr>
<tr class="memdesc:ad4389fd57fbbb4a3c70d7a626285eaa0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum number of errors battery task can encounter before reporting error.  <a href="batteries_8c.html#ad4389fd57fbbb4a3c70d7a626285eaa0">More...</a><br /></td></tr>
<tr class="separator:ad4389fd57fbbb4a3c70d7a626285eaa0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b3fe58b53cbf8d5fbc53709ed5a278b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a9b3fe58b53cbf8d5fbc53709ed5a278b">CELL_VOLTAGE_FILTER_ALPHA</a>&#160;&#160;&#160;0.18</td></tr>
<tr class="separator:a9b3fe58b53cbf8d5fbc53709ed5a278b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab75dbcd7e0a59fc3d1fc3715de87544a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#ab75dbcd7e0a59fc3d1fc3715de87544a">CAN_CELL_SEND_PERIOD_MS</a>&#160;&#160;&#160;40</td></tr>
<tr class="memdesc:ab75dbcd7e0a59fc3d1fc3715de87544a"><td class="mdescLeft">&#160;</td><td class="mdescRight">The period to send cell voltage and temperature CAN messages.  <a href="batteries_8c.html#ab75dbcd7e0a59fc3d1fc3715de87544a">More...</a><br /></td></tr>
<tr class="separator:ab75dbcd7e0a59fc3d1fc3715de87544a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a57d972b2a0b68887bd7afab4c1d2553f"><td class="memItemLeft" align="right" valign="top">typedef enum <a class="el" href="batteries_8c.html#a2f80b01711da374b25803fa818de09b1">ChargeReturn</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a57d972b2a0b68887bd7afab4c1d2553f">ChargeReturn</a></td></tr>
<tr class="separator:a57d972b2a0b68887bd7afab4c1d2553f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a2f80b01711da374b25803fa818de09b1"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a2f80b01711da374b25803fa818de09b1">ChargeReturn</a> { <a class="el" href="batteries_8c.html#a2f80b01711da374b25803fa818de09b1a0abf13e2a7d6435eb5b31d33abeadad7">CHARGE_DONE</a>, 
<a class="el" href="batteries_8c.html#a2f80b01711da374b25803fa818de09b1a3db9c119e634b77566daafdde61b29f1">CHARGE_STOPPED</a>, 
<a class="el" href="batteries_8c.html#a2f80b01711da374b25803fa818de09b1ad0605183af862ee76169e8b41c7fd927">CHARGE_ERROR</a>
 }</td></tr>
<tr class="separator:a2f80b01711da374b25803fa818de09b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a1300d8fea84c20d3945380460f61f81d"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a1300d8fea84c20d3945380460f61f81d">filterIBus</a> (float IBus)</td></tr>
<tr class="memdesc:a1300d8fea84c20d3945380460f61f81d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Low pass filters the HV Bus current measurement.  <a href="batteries_8c.html#a1300d8fea84c20d3945380460f61f81d">More...</a><br /></td></tr>
<tr class="separator:a1300d8fea84c20d3945380460f61f81d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a951b2aac55838c4b1abd243f38e2ca47"><td class="memItemLeft" align="right" valign="top">HAL_StatusTypeDef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a951b2aac55838c4b1abd243f38e2ca47">initBusVoltagesAndCurrentQueues</a> ()</td></tr>
<tr class="memdesc:a951b2aac55838c4b1abd243f38e2ca47"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates queues for HV Bus measurements Queue overwrite, Queue peek, and queue size of 1 is used to ensure only the most recent data is in the queue and read from the queue. Queues use Amps and Volts for units.  <a href="batteries_8c.html#a951b2aac55838c4b1abd243f38e2ca47">More...</a><br /></td></tr>
<tr class="separator:a951b2aac55838c4b1abd243f38e2ca47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37d4140213dc1708776032fc935e0b39"><td class="memItemLeft" align="right" valign="top">HAL_StatusTypeDef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a37d4140213dc1708776032fc935e0b39">publishBusVoltagesAndCurrent</a> (float *pIBus, float *pVBus, float *pVBatt)</td></tr>
<tr class="memdesc:a37d4140213dc1708776032fc935e0b39"><td class="mdescLeft">&#160;</td><td class="mdescRight">Publishes the most recent HV Bus measurements to queues for other tasks to read from Queue overwrite, Queue peek, and queue size of 1 is used to ensure only the most recent data is in the queue and read from the queue.  <a href="batteries_8c.html#a37d4140213dc1708776032fc935e0b39">More...</a><br /></td></tr>
<tr class="separator:a37d4140213dc1708776032fc935e0b39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d72951e5a03e396bb864b5c45bda0f0"><td class="memItemLeft" align="right" valign="top">HAL_StatusTypeDef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a4d72951e5a03e396bb864b5c45bda0f0">readBusVoltagesAndCurrents</a> (float *IBus, float *VBus, float *VBatt)</td></tr>
<tr class="memdesc:a4d72951e5a03e396bb864b5c45bda0f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Measures HV voltages and currents using the HV ADC.  <a href="batteries_8c.html#a4d72951e5a03e396bb864b5c45bda0f0">More...</a><br /></td></tr>
<tr class="separator:a4d72951e5a03e396bb864b5c45bda0f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ee7fbdeb8e2e8413b4fc77ba59223d5"><td class="memItemLeft" align="right" valign="top">HAL_StatusTypeDef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a0ee7fbdeb8e2e8413b4fc77ba59223d5">getIBus</a> (float *IBus)</td></tr>
<tr class="memdesc:a0ee7fbdeb8e2e8413b4fc77ba59223d5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the most recent bus current reading.  <a href="batteries_8c.html#a0ee7fbdeb8e2e8413b4fc77ba59223d5">More...</a><br /></td></tr>
<tr class="separator:a0ee7fbdeb8e2e8413b4fc77ba59223d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff30116cb629c2efdad61c2ccaec0c36"><td class="memItemLeft" align="right" valign="top">HAL_StatusTypeDef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#aff30116cb629c2efdad61c2ccaec0c36">getVBatt</a> (float *VBatt)</td></tr>
<tr class="memdesc:aff30116cb629c2efdad61c2ccaec0c36"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the most recent battery voltage reading (from the HV ADC). Note: this is only equal to the battery voltage when both contactors are closed. to get the battery voltage in all times, use <a class="el" href="batteries_8h.html#ab07aef73f633627b5a1a78e40f15961f">getPackVoltage</a>.  <a href="batteries_8c.html#aff30116cb629c2efdad61c2ccaec0c36">More...</a><br /></td></tr>
<tr class="separator:aff30116cb629c2efdad61c2ccaec0c36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6fbf3bf910348af26a580fc418f89f5e"><td class="memItemLeft" align="right" valign="top">HAL_StatusTypeDef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a6fbf3bf910348af26a580fc418f89f5e">getVBus</a> (float *VBus)</td></tr>
<tr class="memdesc:a6fbf3bf910348af26a580fc418f89f5e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the most recent HV Bus voltage reading (from the HV ADC)  <a href="batteries_8c.html#a6fbf3bf910348af26a580fc418f89f5e">More...</a><br /></td></tr>
<tr class="separator:a6fbf3bf910348af26a580fc418f89f5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e1bc0d2209bd309c4db0a06009a339a"><td class="memItemLeft" align="right" valign="top">HAL_StatusTypeDef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a6e1bc0d2209bd309c4db0a06009a339a">cliSetVBatt</a> (float VBatt)</td></tr>
<tr class="memdesc:a6e1bc0d2209bd309c4db0a06009a339a"><td class="mdescLeft">&#160;</td><td class="mdescRight">For nucleo testing, allows setting a dummy value for the VBatt reading.  <a href="batteries_8c.html#a6e1bc0d2209bd309c4db0a06009a339a">More...</a><br /></td></tr>
<tr class="separator:a6e1bc0d2209bd309c4db0a06009a339a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ab7e555695e672e38894f394a31a3ef"><td class="memItemLeft" align="right" valign="top">HAL_StatusTypeDef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a2ab7e555695e672e38894f394a31a3ef">cliSetVBus</a> (float VBus)</td></tr>
<tr class="memdesc:a2ab7e555695e672e38894f394a31a3ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">For nucleo testing, allows setting a dummy value for the VBus reading.  <a href="batteries_8c.html#a2ab7e555695e672e38894f394a31a3ef">More...</a><br /></td></tr>
<tr class="separator:a2ab7e555695e672e38894f394a31a3ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19d5fb02c3547746d76a121bf9f10807"><td class="memItemLeft" align="right" valign="top">HAL_StatusTypeDef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a19d5fb02c3547746d76a121bf9f10807">cliSetIBus</a> (float IBus)</td></tr>
<tr class="memdesc:a19d5fb02c3547746d76a121bf9f10807"><td class="mdescLeft">&#160;</td><td class="mdescRight">For nucleo testing, allows setting a dummy value for the IBus reading.  <a href="batteries_8c.html#a19d5fb02c3547746d76a121bf9f10807">More...</a><br /></td></tr>
<tr class="separator:a19d5fb02c3547746d76a121bf9f10807"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ef8191389452a8f21cb2d02b20cba29"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a1ef8191389452a8f21cb2d02b20cba29">HVMeasureTask</a> (void *pvParamaters)</td></tr>
<tr class="separator:a1ef8191389452a8f21cb2d02b20cba29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f0375c4fc87fa9cfd8fbc1c5fcd33c9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a1f0375c4fc87fa9cfd8fbc1c5fcd33c9">imdTask</a> (void *pvParamaters)</td></tr>
<tr class="memdesc:a1f0375c4fc87fa9cfd8fbc1c5fcd33c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Monitors the Insulation Monitoring Device (IMD). Raises error if IMD reports fault.  <a href="batteries_8c.html#a1f0375c4fc87fa9cfd8fbc1c5fcd33c9">More...</a><br /></td></tr>
<tr class="separator:a1f0375c4fc87fa9cfd8fbc1c5fcd33c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36a3c81e474331b59839cb2f565c7704"><td class="memItemLeft" align="right" valign="top">HAL_StatusTypeDef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a36a3c81e474331b59839cb2f565c7704">readCellVoltagesAndTemps</a> ()</td></tr>
<tr class="memdesc:a36a3c81e474331b59839cb2f565c7704"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads the cell voltages and temperatures from the AMS boards. The battery temperature and cell voltages are stored in the global arrays which are also used for sending them over CAN.  <a href="batteries_8c.html#a36a3c81e474331b59839cb2f565c7704">More...</a><br /></td></tr>
<tr class="separator:a36a3c81e474331b59839cb2f565c7704"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34364371025450fc6bc3f0d86df0e5ca"><td class="memItemLeft" align="right" valign="top">HAL_StatusTypeDef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a34364371025450fc6bc3f0d86df0e5ca">initVoltageAndTempArrays</a> ()</td></tr>
<tr class="memdesc:a34364371025450fc6bc3f0d86df0e5ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">This functions sets all cell voltages and temps to known values. This is necessary for testing on Nucleo so it doesn't immediately error before the user can manually set the Voltages and Temperatures.  <a href="batteries_8c.html#a34364371025450fc6bc3f0d86df0e5ca">More...</a><br /></td></tr>
<tr class="separator:a34364371025450fc6bc3f0d86df0e5ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7b6a3fe5ae01ef7695d9c36da0f832b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#ad7b6a3fe5ae01ef7695d9c36da0f832b">BatteryTaskError</a> ()</td></tr>
<tr class="memdesc:ad7b6a3fe5ae01ef7695d9c36da0f832b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called if an error with batteries is detected. Raises error and stops battery task execution (without tripping watchdog)  <a href="batteries_8c.html#ad7b6a3fe5ae01ef7695d9c36da0f832b">More...</a><br /></td></tr>
<tr class="separator:ad7b6a3fe5ae01ef7695d9c36da0f832b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a796b02ffebbe6ba22dca62df11bcb05c"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a796b02ffebbe6ba22dca62df11bcb05c">boundedContinue</a> ()</td></tr>
<tr class="memdesc:a796b02ffebbe6ba22dca62df11bcb05c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called by battery task it an error is encountered that is not immediately fatal. This causes the task to retry its readings/whatever else failed MAX_ERROR_COUNT times, then fail and send error event. TODO: ensure this is max 500 ms to meet rules for cell reading times.  <a href="batteries_8c.html#a796b02ffebbe6ba22dca62df11bcb05c">More...</a><br /></td></tr>
<tr class="separator:a796b02ffebbe6ba22dca62df11bcb05c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd3cd9ec15fdceb68c5516f59552605c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#acd3cd9ec15fdceb68c5516f59552605c">ERROR_COUNTER_SUCCESS</a> ()</td></tr>
<tr class="memdesc:acd3cd9ec15fdceb68c5516f59552605c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Call on a succesful run through main loop. Decrements error counter on succesful run through main loop.  <a href="batteries_8c.html#acd3cd9ec15fdceb68c5516f59552605c">More...</a><br /></td></tr>
<tr class="separator:acd3cd9ec15fdceb68c5516f59552605c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1d79ed043eedc99cbc01f7c59ce369e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#ae1d79ed043eedc99cbc01f7c59ce369e">filterCellVoltages</a> (float *cellVoltages, float *<a class="el" href="batteries_8c.html#afa99b901194e86a7784f6213f9420089">cellVoltagesFiltered</a>)</td></tr>
<tr class="memdesc:ae1d79ed043eedc99cbc01f7c59ce369e"><td class="mdescLeft">&#160;</td><td class="mdescRight">This takes an array of the instantaneous cell volages, and filters them on an ongoing basis using the cellVoltagesFiltered array. For check cell voltages, a filtered version of cell voltages is needed to eliminate noise due to bad contact with AMS boards. The hypothesis is that the pogo pins make bad contact with the ams boards when the motors spin, thus the need for filtering. This hasn't been proven however, but the filtering fixed the errors we saw before (info up to date as of May 2020) NB: Filter voltages shouldn't be sent over CAN, only used with error checking.  <a href="batteries_8c.html#ae1d79ed043eedc99cbc01f7c59ce369e">More...</a><br /></td></tr>
<tr class="separator:ae1d79ed043eedc99cbc01f7c59ce369e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7090234402b08bb512cf5db06702c9f0"><td class="memItemLeft" align="right" valign="top">HAL_StatusTypeDef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a7090234402b08bb512cf5db06702c9f0">checkCellVoltagesAndTemps</a> (float *maxVoltage, float *minVoltage, float *maxTemp, float *minTemp, float *packVoltage)</td></tr>
<tr class="memdesc:a7090234402b08bb512cf5db06702c9f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks cell voltages and temperatures to ensure they are within safe limits, as well as sending out warnings when the values get close to their limits and updating max/min voltages/temps and calculated pack voltage NB: This skips checking temperatures of cells specified as having faulty measurements in <a class="el" href="batteries_8c.html#a4bb357024aa0bb23dcfba57009d3f836">isTempCellWorking</a> array.  <a href="batteries_8c.html#a7090234402b08bb512cf5db06702c9f0">More...</a><br /></td></tr>
<tr class="separator:a7090234402b08bb512cf5db06702c9f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b2f1ad817d75d1c5c590814371b5062"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a6b2f1ad817d75d1c5c590814371b5062">calculateStateOfPower</a> ()</td></tr>
<tr class="memdesc:a6b2f1ad817d75d1c5c590814371b5062"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the state of power of the battery pack. TODO: this calculation is from 2017, so should be updated for the 2020 pack.  <a href="batteries_8c.html#a6b2f1ad817d75d1c5c590814371b5062">More...</a><br /></td></tr>
<tr class="separator:a6b2f1ad817d75d1c5c590814371b5062"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b0e95f68b412d5d5e9620ffbae8750d"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a7b0e95f68b412d5d5e9620ffbae8750d">calculateStateOfCharge</a> ()</td></tr>
<tr class="memdesc:a7b0e95f68b412d5d5e9620ffbae8750d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the state of charge of the battery pack. This is a measure of how much capacity the pack has left on its current charge. Currently its implemented as a simple ratio of min cell voltage versus safe limits.  <a href="batteries_8c.html#a7b0e95f68b412d5d5e9620ffbae8750d">More...</a><br /></td></tr>
<tr class="separator:a7b0e95f68b412d5d5e9620ffbae8750d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb2f305c6977c16734384de553edfa73"><td class="memItemLeft" align="right" valign="top">HAL_StatusTypeDef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#aeb2f305c6977c16734384de553edfa73">batteryStart</a> ()</td></tr>
<tr class="memdesc:aeb2f305c6977c16734384de553edfa73"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the battery task.  <a href="batteries_8c.html#aeb2f305c6977c16734384de553edfa73">More...</a><br /></td></tr>
<tr class="separator:aeb2f305c6977c16734384de553edfa73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa698a16023626be583ce5082c76f5ec"><td class="memItemLeft" align="right" valign="top">HAL_StatusTypeDef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#afa698a16023626be583ce5082c76f5ec">publishPackVoltage</a> (float packVoltage)</td></tr>
<tr class="memdesc:afa698a16023626be583ce5082c76f5ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Publishes the current pack voltage value to the queue for other tasks to read from.  <a href="batteries_8c.html#afa698a16023626be583ce5082c76f5ec">More...</a><br /></td></tr>
<tr class="separator:afa698a16023626be583ce5082c76f5ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab07aef73f633627b5a1a78e40f15961f"><td class="memItemLeft" align="right" valign="top">HAL_StatusTypeDef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#ab07aef73f633627b5a1a78e40f15961f">getPackVoltage</a> (float *packVoltage)</td></tr>
<tr class="memdesc:ab07aef73f633627b5a1a78e40f15961f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the current pack voltage. This returns the pack voltage as calculated by summing all the cell voltages.  <a href="batteries_8c.html#ab07aef73f633627b5a1a78e40f15961f">More...</a><br /></td></tr>
<tr class="separator:ab07aef73f633627b5a1a78e40f15961f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92932081ca58208175ca6c4e0971f06d"><td class="memItemLeft" align="right" valign="top">HAL_StatusTypeDef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a92932081ca58208175ca6c4e0971f06d">initPackVoltageQueue</a> ()</td></tr>
<tr class="memdesc:a92932081ca58208175ca6c4e0971f06d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates the pack voltage queue. Needs to be called before RTOS starts.  <a href="batteries_8c.html#a92932081ca58208175ca6c4e0971f06d">More...</a><br /></td></tr>
<tr class="separator:a92932081ca58208175ca6c4e0971f06d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacf3b5ff9648b813208cb6f91b370fef"><td class="memItemLeft" align="right" valign="top">HAL_StatusTypeDef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#aacf3b5ff9648b813208cb6f91b370fef">setMaxChargeCurrent</a> (float maxCurrent)</td></tr>
<tr class="memdesc:aacf3b5ff9648b813208cb6f91b370fef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the maximum current for the charger.  <a href="batteries_8c.html#aacf3b5ff9648b813208cb6f91b370fef">More...</a><br /></td></tr>
<tr class="separator:aacf3b5ff9648b813208cb6f91b370fef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43ea41cc1c21bd36b3622076e20b596c"><td class="memItemLeft" align="right" valign="top">HAL_StatusTypeDef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a43ea41cc1c21bd36b3622076e20b596c">startCharging</a> ()</td></tr>
<tr class="memdesc:a43ea41cc1c21bd36b3622076e20b596c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends the maximum charge current and voltage to the charger and waits for the charger to start charging.  <a href="batteries_8c.html#a43ea41cc1c21bd36b3622076e20b596c">More...</a><br /></td></tr>
<tr class="separator:a43ea41cc1c21bd36b3622076e20b596c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a533907b25f7b1dbb355151d336ed9ff6"><td class="memItemLeft" align="right" valign="top">HAL_StatusTypeDef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a533907b25f7b1dbb355151d336ed9ff6">continueCharging</a> ()</td></tr>
<tr class="memdesc:a533907b25f7b1dbb355151d336ed9ff6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends messages to the charger. The charger expects a message every second so this needs to be repeatedly called during charging.  <a href="batteries_8c.html#a533907b25f7b1dbb355151d336ed9ff6">More...</a><br /></td></tr>
<tr class="separator:a533907b25f7b1dbb355151d336ed9ff6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5cf6c235603af078c2dc841ae579f3b5"><td class="memItemLeft" align="right" valign="top">HAL_StatusTypeDef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a5cf6c235603af078c2dc841ae579f3b5">stopCharging</a> ()</td></tr>
<tr class="memdesc:a5cf6c235603af078c2dc841ae579f3b5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends a command to the charger to stop charging.  <a href="batteries_8c.html#a5cf6c235603af078c2dc841ae579f3b5">More...</a><br /></td></tr>
<tr class="separator:a5cf6c235603af078c2dc841ae579f3b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad54912c48ac30fc66796b2aeca58cea7"><td class="memItemLeft" align="right" valign="top">HAL_StatusTypeDef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#ad54912c48ac30fc66796b2aeca58cea7">stopBalance</a> ()</td></tr>
<tr class="memdesc:ad54912c48ac30fc66796b2aeca58cea7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stops all cells balancing by sending command to AMS boards.  <a href="batteries_8c.html#ad54912c48ac30fc66796b2aeca58cea7">More...</a><br /></td></tr>
<tr class="separator:ad54912c48ac30fc66796b2aeca58cea7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa04706789e98d82797970064b10dd0c9"><td class="memItemLeft" align="right" valign="top">HAL_StatusTypeDef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#aa04706789e98d82797970064b10dd0c9">pauseBalance</a> ()</td></tr>
<tr class="memdesc:aa04706789e98d82797970064b10dd0c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stops all cells balancing, but stores which cells were balancing to allowing resuming of balance for cells that were balancing.  <a href="batteries_8c.html#aa04706789e98d82797970064b10dd0c9">More...</a><br /></td></tr>
<tr class="separator:aa04706789e98d82797970064b10dd0c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82969943d42e6067b966c64c61196dcd"><td class="memItemLeft" align="right" valign="top">HAL_StatusTypeDef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a82969943d42e6067b966c64c61196dcd">resumeBalance</a> ()</td></tr>
<tr class="memdesc:a82969943d42e6067b966c64c61196dcd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resumes balancing after call to <a class="el" href="batteries_8c.html#aa04706789e98d82797970064b10dd0c9">pauseBalance</a>.  <a href="batteries_8c.html#a82969943d42e6067b966c64c61196dcd">More...</a><br /></td></tr>
<tr class="separator:a82969943d42e6067b966c64c61196dcd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaacb3ffbd5367bbde01d4e8120fdbea0"><td class="memItemLeft" align="right" valign="top">HAL_StatusTypeDef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#aaacb3ffbd5367bbde01d4e8120fdbea0">balance_cell</a> (int cell, bool set)</td></tr>
<tr class="memdesc:aaacb3ffbd5367bbde01d4e8120fdbea0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Control the balance state of an individual cell. NB: this is inneficient if balancing multiple cells, as he entire balance config is sent to the AMS boards every time this is called. Instead, use the lower level batt_balance_cell/batt_stop_balance_cell to change state for all cells, then call batt_write_config to send the new balance config.  <a href="batteries_8c.html#aaacb3ffbd5367bbde01d4e8120fdbea0">More...</a><br /></td></tr>
<tr class="separator:aaacb3ffbd5367bbde01d4e8120fdbea0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed5d06c4a55e40673204ceacf2fde819"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#aed5d06c4a55e40673204ceacf2fde819">map_range_float</a> (float in, float low, float high, float low_out, float high_out)</td></tr>
<tr class="memdesc:aed5d06c4a55e40673204ceacf2fde819"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maps a value from one range to another in a linear manner.  <a href="batteries_8c.html#aed5d06c4a55e40673204ceacf2fde819">More...</a><br /></td></tr>
<tr class="separator:aed5d06c4a55e40673204ceacf2fde819"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d41850a2fe8400978c4f68163d726be"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a3d41850a2fe8400978c4f68163d726be">getSOCFromVoltage</a> (float cellVoltage)</td></tr>
<tr class="memdesc:a3d41850a2fe8400978c4f68163d726be"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the SoC of a cell from the cell's voltage.  <a href="batteries_8c.html#a3d41850a2fe8400978c4f68163d726be">More...</a><br /></td></tr>
<tr class="separator:a3d41850a2fe8400978c4f68163d726be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9144cd162ceec3e710baea6601149b43"><td class="memItemLeft" align="right" valign="top"><a class="el" href="batteries_8c.html#a2f80b01711da374b25803fa818de09b1">ChargeReturn</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a9144cd162ceec3e710baea6601149b43">balanceCharge</a> ()</td></tr>
<tr class="memdesc:a9144cd162ceec3e710baea6601149b43"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs balance charging. For more info, see the BMU page on confluence.  <a href="batteries_8c.html#a9144cd162ceec3e710baea6601149b43">More...</a><br /></td></tr>
<tr class="separator:a9144cd162ceec3e710baea6601149b43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3364449b5cc8a93c89985f5d9fa2984b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a3364449b5cc8a93c89985f5d9fa2984b">batteryTask</a> (void *pvParameter)</td></tr>
<tr class="memdesc:a3364449b5cc8a93c89985f5d9fa2984b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Task to monitor cell voltages and temperatures, as well as perform balance charging.  <a href="batteries_8c.html#a3364449b5cc8a93c89985f5d9fa2984b">More...</a><br /></td></tr>
<tr class="separator:a3364449b5cc8a93c89985f5d9fa2984b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd55a62448b408952283c28d12dd4c1d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#acd55a62448b408952283c28d12dd4c1d">setSendOnlyOneCell</a> (int cellIdx)</td></tr>
<tr class="memdesc:acd55a62448b408952283c28d12dd4c1d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Repeatedly send the cell voltage and temperature for a specific cell. This is instead of the normal behaviour which cycles through all the cells sending a message every <a class="el" href="batteries_8c.html#ab75dbcd7e0a59fc3d1fc3715de87544a">CAN_CELL_SEND_PERIOD_MS</a>. Useful for battery testing to monitor a cell at higher frequency.  <a href="batteries_8c.html#acd55a62448b408952283c28d12dd4c1d">More...</a><br /></td></tr>
<tr class="separator:acd55a62448b408952283c28d12dd4c1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade4720060f19979c4071eae3fb08ff92"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#ade4720060f19979c4071eae3fb08ff92">clearSendOnlyOneCell</a> ()</td></tr>
<tr class="memdesc:ade4720060f19979c4071eae3fb08ff92"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stop sending only one cell repeatedly, and go back to sending all cells over CAN.  <a href="batteries_8c.html#ade4720060f19979c4071eae3fb08ff92">More...</a><br /></td></tr>
<tr class="separator:ade4720060f19979c4071eae3fb08ff92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a445bbbf2332f3c63a4bfcddf4b78ff43"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a445bbbf2332f3c63a4bfcddf4b78ff43">canSendCellTask</a> (void *pvParameters)</td></tr>
<tr class="memdesc:a445bbbf2332f3c63a4bfcddf4b78ff43"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends the cell voltages and temperatures over CAN.  <a href="batteries_8c.html#a445bbbf2332f3c63a4bfcddf4b78ff43">More...</a><br /></td></tr>
<tr class="separator:a445bbbf2332f3c63a4bfcddf4b78ff43"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:aa95731d4ff40893bc5d4c80cc0fa055f"><td class="memItemLeft" align="right" valign="top">osThreadId&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#aa95731d4ff40893bc5d4c80cc0fa055f">BatteryTaskHandle</a></td></tr>
<tr class="separator:aa95731d4ff40893bc5d4c80cc0fa055f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a098ac94ec41c0b74569366cf7660c680"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a098ac94ec41c0b74569366cf7660c680">maxChargeCurrent</a> = <a class="el" href="batteries_8c.html#a68aaf77b085834ea0c03a6ab2e2910f6">CHARGE_DEFAULT_MAX_CURRENT</a></td></tr>
<tr class="memdesc:a098ac94ec41c0b74569366cf7660c680"><td class="mdescLeft">&#160;</td><td class="mdescRight">Charging current limit.  <a href="batteries_8c.html#a098ac94ec41c0b74569366cf7660c680">More...</a><br /></td></tr>
<tr class="separator:a098ac94ec41c0b74569366cf7660c680"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e19984c8df58b545da1c8f8b5547acd"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a1e19984c8df58b545da1c8f8b5547acd">maxChargeVoltage</a> = <a class="el" href="batteries_8c.html#aa4b530cc846953d732a4582912f703d2">LIMIT_OVERVOLTAGE</a> * <a class="el" href="_b_m_u__can_8h.html#ab438e1bff44c116778101ab624f3359f">VOLTAGECELL_COUNT</a></td></tr>
<tr class="separator:a1e19984c8df58b545da1c8f8b5547acd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afeb7e3ce5be75e8a7d03ae9bbc3c2150"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#afeb7e3ce5be75e8a7d03ae9bbc3c2150">warningSentForCellVoltage</a> [<a class="el" href="_b_m_u__can_8h.html#ab438e1bff44c116778101ab624f3359f">VOLTAGECELL_COUNT</a>]</td></tr>
<tr class="separator:afeb7e3ce5be75e8a7d03ae9bbc3c2150"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61bd11f0a0377192a9a1950e18664728"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a61bd11f0a0377192a9a1950e18664728">warningSentForCellTemp</a> [<a class="el" href="_b_m_u__can_8h.html#aa1408c5c3cd5903a4d88611eabf5ce4c">TEMPCELL_COUNT</a>]</td></tr>
<tr class="separator:a61bd11f0a0377192a9a1950e18664728"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bb357024aa0bb23dcfba57009d3f836"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a4bb357024aa0bb23dcfba57009d3f836">isTempCellWorking</a> [<a class="el" href="_b_m_u__can_8h.html#aa1408c5c3cd5903a4d88611eabf5ce4c">TEMPCELL_COUNT</a>]</td></tr>
<tr class="separator:a4bb357024aa0bb23dcfba57009d3f836"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab483cabe57068f7e0fd4bcaee6c1fb59"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#ab483cabe57068f7e0fd4bcaee6c1fb59">voltageToSOCLookup</a> [<a class="el" href="batteries_8c.html#a4ec6365ec832a79d6e0633c4f49b3b55">NUM_SOC_LOOKUP_VALS</a>]</td></tr>
<tr class="separator:ab483cabe57068f7e0fd4bcaee6c1fb59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a141159dacb84bda6d1ce0a156c258177"><td class="memItemLeft" align="right" valign="top">QueueHandle_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a141159dacb84bda6d1ce0a156c258177">IBusQueue</a></td></tr>
<tr class="memdesc:a141159dacb84bda6d1ce0a156c258177"><td class="mdescLeft">&#160;</td><td class="mdescRight">Queue holding most recent bus current measurement.  <a href="batteries_8c.html#a141159dacb84bda6d1ce0a156c258177">More...</a><br /></td></tr>
<tr class="separator:a141159dacb84bda6d1ce0a156c258177"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abafdcf601bccb3238fcb8534b517d130"><td class="memItemLeft" align="right" valign="top">QueueHandle_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#abafdcf601bccb3238fcb8534b517d130">VBusQueue</a></td></tr>
<tr class="memdesc:abafdcf601bccb3238fcb8534b517d130"><td class="mdescLeft">&#160;</td><td class="mdescRight">Queue holding most recent bus volage measurement.  <a href="batteries_8c.html#abafdcf601bccb3238fcb8534b517d130">More...</a><br /></td></tr>
<tr class="separator:abafdcf601bccb3238fcb8534b517d130"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad64f368c4f439a41338c59c0c4b685e2"><td class="memItemLeft" align="right" valign="top">QueueHandle_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#ad64f368c4f439a41338c59c0c4b685e2">VBattQueue</a></td></tr>
<tr class="memdesc:ad64f368c4f439a41338c59c0c4b685e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Queue holding most recent battery voltage measurement.  <a href="batteries_8c.html#ad64f368c4f439a41338c59c0c4b685e2">More...</a><br /></td></tr>
<tr class="separator:ad64f368c4f439a41338c59c0c4b685e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17c95138c88cf1a7a64a0dd006730b6c"><td class="memItemLeft" align="right" valign="top">QueueHandle_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a17c95138c88cf1a7a64a0dd006730b6c">PackVoltageQueue</a></td></tr>
<tr class="memdesc:a17c95138c88cf1a7a64a0dd006730b6c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Queue holding most recent battery voltage (calculated from sum of cell voltages) measurement.  <a href="batteries_8c.html#a17c95138c88cf1a7a64a0dd006730b6c">More...</a><br /></td></tr>
<tr class="separator:a17c95138c88cf1a7a64a0dd006730b6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af01c96d690887303a5e5d5432739801a"><td class="memItemLeft" align="right" valign="top">static uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#af01c96d690887303a5e5d5432739801a">errorCounter</a> = 0</td></tr>
<tr class="separator:af01c96d690887303a5e5d5432739801a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa99b901194e86a7784f6213f9420089"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#afa99b901194e86a7784f6213f9420089">cellVoltagesFiltered</a> [<a class="el" href="_b_m_u__can_8h.html#ab438e1bff44c116778101ab624f3359f">VOLTAGECELL_COUNT</a>]</td></tr>
<tr class="memdesc:afa99b901194e86a7784f6213f9420089"><td class="mdescLeft">&#160;</td><td class="mdescRight">Array is used to store the filtered voltages.  <a href="batteries_8c.html#afa99b901194e86a7784f6213f9420089">More...</a><br /></td></tr>
<tr class="separator:afa99b901194e86a7784f6213f9420089"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58c53a03f6ed59b66477d9ff778a7ec1"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a58c53a03f6ed59b66477d9ff778a7ec1">isCellBalancing</a> [<a class="el" href="_b_m_u__can_8h.html#ab438e1bff44c116778101ab624f3359f">VOLTAGECELL_COUNT</a>] = {0}</td></tr>
<tr class="memdesc:a58c53a03f6ed59b66477d9ff778a7ec1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Array to store if a cell is balancing.  <a href="batteries_8c.html#a58c53a03f6ed59b66477d9ff778a7ec1">More...</a><br /></td></tr>
<tr class="separator:a58c53a03f6ed59b66477d9ff778a7ec1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08165bcd985456a8bb4f39d29b0132d8"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a08165bcd985456a8bb4f39d29b0132d8">sendOneCellVoltAndTemp</a> = false</td></tr>
<tr class="separator:a08165bcd985456a8bb4f39d29b0132d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45eac5b187ae199e0de1fa376e2024b3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8c.html#a45eac5b187ae199e0de1fa376e2024b3">cellToSend</a></td></tr>
<tr class="separator:a45eac5b187ae199e0de1fa376e2024b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Battery Monitoring, Charging, HV Bus Sense, IMD monitor. </p>
<dl class="section author"><dt>Author</dt><dd>Richard Matthews</dd></dl>
<p>This file contains a number of tasks and related functions:</p><ul>
<li>Battery Monitoring and Charging (batteryTask): Monitors the voltage and temperature of all cells by communicating with the AMS boards, performs balance charging and communicates with the charger over CAN</li>
<li>HV Bus Sense (HVMeasureTask): Measures the voltage and current on the HV Bus as well as the HV battery pack voltage</li>
<li>IMD Monitoring (imdTask): Measures the signals from the insulation monitoring device (IMD) to check for insulation faults</li>
<li>canSendCellTask: Sends the cell voltage and temperatures over CAN using the multiplexed CAN messages </li>
</ul>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="aaa9233fe54ffd66274a5dd46390b36e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa9233fe54ffd66274a5dd46390b36e5">&#9670;&nbsp;</a></span>BALANCE_RECHECK_PERIOD_MS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BALANCE_RECHECK_PERIOD_MS&#160;&#160;&#160;(3000)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Period at which cell SoCs are checked to determine which cells to balance. This should be long enough so cells aren't constantly being toggled between balance and not </p>

</div>
</div>
<a id="ad5819e811f281911c5854f40cf58960f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5819e811f281911c5854f40cf58960f">&#9670;&nbsp;</a></span>BALANCE_START_VOLTAGE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BALANCE_START_VOLTAGE&#160;&#160;&#160;(3.5F)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Block balancing below this cell voltage. </p>

</div>
</div>
<a id="a6d5ce7bfac0354a10a78a45aa0ebaacf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d5ce7bfac0354a10a78a45aa0ebaacf">&#9670;&nbsp;</a></span>BATTERY_CHARGE_TASK_PERIOD_MS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BATTERY_CHARGE_TASK_PERIOD_MS&#160;&#160;&#160;2000</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aeb85d8df3b9f6218cb677ccd44760cd4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb85d8df3b9f6218cb677ccd44760cd4">&#9670;&nbsp;</a></span>BATTERY_TASK_ID</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BATTERY_TASK_ID&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a62b353ffb0e0f9735e0c6a32712e85b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62b353ffb0e0f9735e0c6a32712e85b2">&#9670;&nbsp;</a></span>BATTERY_TASK_PERIOD_MS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BATTERY_TASK_PERIOD_MS&#160;&#160;&#160;100</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab75dbcd7e0a59fc3d1fc3715de87544a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab75dbcd7e0a59fc3d1fc3715de87544a">&#9670;&nbsp;</a></span>CAN_CELL_SEND_PERIOD_MS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CAN_CELL_SEND_PERIOD_MS&#160;&#160;&#160;40</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The period to send cell voltage and temperature CAN messages. </p>

</div>
</div>
<a id="ace79b123d44fbbb7d6b78e0e9fa98930"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace79b123d44fbbb7d6b78e0e9fa98930">&#9670;&nbsp;</a></span>CELL_DCR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CELL_DCR&#160;&#160;&#160;(0.01)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a16227ae24d95ceebf83b650ccdb0dfa4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16227ae24d95ceebf83b650ccdb0dfa4">&#9670;&nbsp;</a></span>CELL_HEAT_CAPACITY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CELL_HEAT_CAPACITY&#160;&#160;&#160;(1034.2)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a8fec377e4c098c8c294afce44c6c69d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8fec377e4c098c8c294afce44c6c69d0">&#9670;&nbsp;</a></span>CELL_MASS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CELL_MASS&#160;&#160;&#160;(0.496)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aa72653c5b21b8d21a14cdba38e71c6eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa72653c5b21b8d21a14cdba38e71c6eb">&#9670;&nbsp;</a></span>CELL_OVERTEMP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CELL_OVERTEMP&#160;&#160;&#160;(<a class="el" href="batteries_8h.html#aca152be2322f2c62c655e2a234c88fd3">CELL_MAX_TEMP_C</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a8531f997baa2780a823499e18bdebec3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8531f997baa2780a823499e18bdebec3">&#9670;&nbsp;</a></span>CELL_OVERTEMP_WARNING</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CELL_OVERTEMP_WARNING&#160;&#160;&#160;(<a class="el" href="batteries_8h.html#aca152be2322f2c62c655e2a234c88fd3">CELL_MAX_TEMP_C</a> - 10)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ae7647190367a5af57c404c325ede1e56"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7647190367a5af57c404c325ede1e56">&#9670;&nbsp;</a></span>CELL_RELAXATION_TIME_MS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CELL_RELAXATION_TIME_MS&#160;&#160;&#160;(1000)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Pause balancing for this length when reading cell voltages to get good readings. </p>

</div>
</div>
<a id="a374bf63b81c93c7d9e76601f46b9f184"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a374bf63b81c93c7d9e76601f46b9f184">&#9670;&nbsp;</a></span>CELL_TIME_TO_FAILURE_ALLOWABLE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CELL_TIME_TO_FAILURE_ALLOWABLE&#160;&#160;&#160;(6.0)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a9b3fe58b53cbf8d5fbc53709ed5a278b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b3fe58b53cbf8d5fbc53709ed5a278b">&#9670;&nbsp;</a></span>CELL_VOLTAGE_FILTER_ALPHA</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CELL_VOLTAGE_FILTER_ALPHA&#160;&#160;&#160;0.18</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Alpha value for cell voltage filter For a 10-90 rise time of 1 sec, set the bandwidth to 0.35 Hz See: <a href="https://www.edn.com/electronics-blogs/bogatin-s-rules-of-thumb/4424573/Rule-of-Thumb&ndash;1&ndash;The-bandwidth-of-a-signal-from-its-rise-time">https://www.edn.com/electronics-blogs/bogatin-s-rules-of-thumb/4424573/Rule-of-Thumb&amp;ndash;1&amp;ndash;The-bandwidth-of-a-signal-from-its-rise-time</a> This cuttoff, with a sampling frequency of 100 ms gives an alpha of 0.18 See the wikipedia page for the alpha calculation: <a href="https://en.wikipedia.org/wiki/Low-pass_filter#Simple_infinite_impulse_response_filter">https://en.wikipedia.org/wiki/Low-pass_filter#Simple_infinite_impulse_response_filter</a> </p>

</div>
</div>
<a id="a3840db84d2eaac3f4fe59941e21ff410"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3840db84d2eaac3f4fe59941e21ff410">&#9670;&nbsp;</a></span>CHARGE_CART_HEARTBEAT_MAX_PERIOD</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CHARGE_CART_HEARTBEAT_MAX_PERIOD&#160;&#160;&#160;(1000)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>If using charge cart heartbeat, this heartbeat timeout. NB: We are phasing out use of charge cart as a board with a microcontroller </p>

</div>
</div>
<a id="a68aaf77b085834ea0c03a6ab2e2910f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68aaf77b085834ea0c03a6ab2e2910f6">&#9670;&nbsp;</a></span>CHARGE_DEFAULT_MAX_CURRENT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CHARGE_DEFAULT_MAX_CURRENT&#160;&#160;&#160;5</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Default charging current limit (Amps) </p>

</div>
</div>
<a id="a1c3f97f617827a946894da14b7e6e4d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c3f97f617827a946894da14b7e6e4d4">&#9670;&nbsp;</a></span>CHARGE_STOP_SOC</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CHARGE_STOP_SOC&#160;&#160;&#160;(98.0)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>SoC to stop charging at (of the cell with lowest SoC) </p>

</div>
</div>
<a id="a2828019bbccc5743ed8275fc9a4fe1a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2828019bbccc5743ed8275fc9a4fe1a3">&#9670;&nbsp;</a></span>ENABLE_AMS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ENABLE_AMS</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a8ba2127550d368f846692fdcf3ca095f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ba2127550d368f846692fdcf3ca095f">&#9670;&nbsp;</a></span>ENABLE_BALANCE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ENABLE_BALANCE</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a9fea424f5555dcbb0ba5c1e4871e855f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9fea424f5555dcbb0ba5c1e4871e855f">&#9670;&nbsp;</a></span>ENABLE_CHARGER</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ENABLE_CHARGER</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aa31c40ba22e94296395602249e2b25eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa31c40ba22e94296395602249e2b25eb">&#9670;&nbsp;</a></span>ENABLE_HV_MEASURE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ENABLE_HV_MEASURE</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aadfade60a9946687e6a1a4a24b70fb4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aadfade60a9946687e6a1a4a24b70fb4c">&#9670;&nbsp;</a></span>ENABLE_IMD</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ENABLE_IMD</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab4536de5261b4bd382b10d69f857dbe3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4536de5261b4bd382b10d69f857dbe3">&#9670;&nbsp;</a></span>HV_MEASURE_TASK_ID</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HV_MEASURE_TASK_ID&#160;&#160;&#160;4</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="affc1e4ab7cea9fe57082528ac006cc50"></a>
<h2 class="memtitle"><span class="permalink"><a href="#affc1e4ab7cea9fe57082528ac006cc50">&#9670;&nbsp;</a></span>HV_MEASURE_TASK_PERIOD_MS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HV_MEASURE_TASK_PERIOD_MS&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a1951643638039378eccc6e0ffef18a22"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1951643638039378eccc6e0ffef18a22">&#9670;&nbsp;</a></span>IBUS_FILTER_ALPHA</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IBUS_FILTER_ALPHA&#160;&#160;&#160;0.24</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Filter constant for HV Bus current low pass filter Designed around 1 ms sample period and 50 Hz cuttoff. See the wikipedia page for the calculation: <a href="https://en.wikipedia.org/wiki/Low-pass_filter#Simple_infinite_impulse_response_filter">https://en.wikipedia.org/wiki/Low-pass_filter#Simple_infinite_impulse_response_filter</a>. </p>

</div>
</div>
<a id="a5a2f513c66eeae901bf7536957487e74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a2f513c66eeae901bf7536957487e74">&#9670;&nbsp;</a></span>IMD_TASK_ID</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IMD_TASK_ID&#160;&#160;&#160;5</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a918bb56d5d536252807bb42ab03b3728"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a918bb56d5d536252807bb42ab03b3728">&#9670;&nbsp;</a></span>IMD_TASK_PERIOD_MS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IMD_TASK_PERIOD_MS&#160;&#160;&#160;1000</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a582698c135482c98c6911f0bdbf8d1ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a582698c135482c98c6911f0bdbf8d1ad">&#9670;&nbsp;</a></span>LIMIT_HIGHVOLTAGE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LIMIT_HIGHVOLTAGE&#160;&#160;&#160;4.2F</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a2f9e0b5026ad096458f1bdcc559cfab7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f9e0b5026ad096458f1bdcc559cfab7">&#9670;&nbsp;</a></span>LIMIT_LOWVOLTAGE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LIMIT_LOWVOLTAGE&#160;&#160;&#160;3.0F</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab4cdc344852b65658b9d24c04473f26d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4cdc344852b65658b9d24c04473f26d">&#9670;&nbsp;</a></span>LIMIT_LOWVOLTAGE_WARNING</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LIMIT_LOWVOLTAGE_WARNING&#160;&#160;&#160;3.2F</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aa4b530cc846953d732a4582912f703d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4b530cc846953d732a4582912f703d2">&#9670;&nbsp;</a></span>LIMIT_OVERVOLTAGE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LIMIT_OVERVOLTAGE&#160;&#160;&#160;4.2F</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a6136cb9cd8ceabce6e9fdda8cb05c3bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6136cb9cd8ceabce6e9fdda8cb05c3bd">&#9670;&nbsp;</a></span>LIMIT_UNDERVOLTAGE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LIMIT_UNDERVOLTAGE&#160;&#160;&#160;3.0F</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ad4389fd57fbbb4a3c70d7a626285eaa0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4389fd57fbbb4a3c70d7a626285eaa0">&#9670;&nbsp;</a></span>MAX_ERROR_COUNT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_ERROR_COUNT&#160;&#160;&#160;3</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum number of errors battery task can encounter before reporting error. </p>

</div>
</div>
<a id="a4ec6365ec832a79d6e0633c4f49b3b55"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ec6365ec832a79d6e0633c4f49b3b55">&#9670;&nbsp;</a></span>NUM_SOC_LOOKUP_VALS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NUM_SOC_LOOKUP_VALS&#160;&#160;&#160;101</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a0fc9cbf2e0173158d4cd0536059a272f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0fc9cbf2e0173158d4cd0536059a272f">&#9670;&nbsp;</a></span>STATE_BUS_HV_CAN_SEND_PERIOD_MS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STATE_BUS_HV_CAN_SEND_PERIOD_MS&#160;&#160;&#160;500</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="a57d972b2a0b68887bd7afab4c1d2553f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57d972b2a0b68887bd7afab4c1d2553f">&#9670;&nbsp;</a></span>ChargeReturn</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef enum <a class="el" href="batteries_8c.html#a2f80b01711da374b25803fa818de09b1">ChargeReturn</a> <a class="el" href="batteries_8c.html#a2f80b01711da374b25803fa818de09b1">ChargeReturn</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return of balance charge function </p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="a2f80b01711da374b25803fa818de09b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f80b01711da374b25803fa818de09b1">&#9670;&nbsp;</a></span>ChargeReturn</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="batteries_8c.html#a2f80b01711da374b25803fa818de09b1">ChargeReturn</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return of balance charge function </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a2f80b01711da374b25803fa818de09b1a0abf13e2a7d6435eb5b31d33abeadad7"></a>CHARGE_DONE&#160;</td><td class="fielddoc"><p>Charging finished, cells reached fully charged. </p>
</td></tr>
<tr><td class="fieldname"><a id="a2f80b01711da374b25803fa818de09b1a3db9c119e634b77566daafdde61b29f1"></a>CHARGE_STOPPED&#160;</td><td class="fielddoc"><p>Charging was stopped as requested, cells not fully charged. </p>
</td></tr>
<tr><td class="fieldname"><a id="a2f80b01711da374b25803fa818de09b1ad0605183af862ee76169e8b41c7fd927"></a>CHARGE_ERROR&#160;</td><td class="fielddoc"><p>Error occured stopping charging, cells not fully charged. </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="aaacb3ffbd5367bbde01d4e8120fdbea0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaacb3ffbd5367bbde01d4e8120fdbea0">&#9670;&nbsp;</a></span>balance_cell()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_StatusTypeDef balance_cell </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>set</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Control the balance state of an individual cell. NB: this is inneficient if balancing multiple cells, as he entire balance config is sent to the AMS boards every time this is called. Instead, use the lower level batt_balance_cell/batt_stop_balance_cell to change state for all cells, then call batt_write_config to send the new balance config. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cell</td><td>The cell to change the balance state of </td></tr>
    <tr><td class="paramname">set</td><td>True if should balance cell</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>HAL_StatusTypeDef </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8c_aaacb3ffbd5367bbde01d4e8120fdbea0_cgraph.png" border="0" usemap="#batteries_8c_aaacb3ffbd5367bbde01d4e8120fdbea0_cgraph" alt=""/></div>
<map name="batteries_8c_aaacb3ffbd5367bbde01d4e8120fdbea0_cgraph" id="batteries_8c_aaacb3ffbd5367bbde01d4e8120fdbea0_cgraph">
<area shape="rect" title="Control the balance state of an individual cell. NB: this is inneficient if balancing multiple cells,..." alt="" coords="5,56,100,83"/>
<area shape="rect" href="ltc6811_8c.html#a7cf49fe3c9809ef6d0920eb322b640e0" title=" " alt="" coords="164,5,287,32"/>
<area shape="rect" href="ltc6811_8c.html#a265419e3399d2e64f36eba3e266ca7ed" title=" " alt="" coords="148,56,303,83"/>
<area shape="rect" href="ltc6811_8c.html#a2150f002603baac59966270488687aaa" title=" " alt="" coords="165,144,286,171"/>
<area shape="rect" href="ltc6811_8c.html#a195d06cb021b2d6e1c3f6877c7dce697" title=" " alt="" coords="357,5,516,32"/>
<area shape="rect" href="ltc6811_8c.html#ade492dd40b5c05cced4ddfc4dc11e473" title=" " alt="" coords="351,56,523,83"/>
<area shape="rect" href="ltc6811_8c.html#afc4b749b996cce4e7c4cb98f832a0e8b" title=" " alt="" coords="361,107,513,149"/>
<area shape="rect" href="ltc6811_8c.html#ae5189473d88cbc9c95bec62bea119690" title=" " alt="" coords="571,144,671,171"/>
<area shape="rect" href="ltc6811_8c.html#a877fbade1097a0f7a8d92cb1fe140fd4" title=" " alt="" coords="393,224,480,251"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8c_aaacb3ffbd5367bbde01d4e8120fdbea0_icgraph.png" border="0" usemap="#batteries_8c_aaacb3ffbd5367bbde01d4e8120fdbea0_icgraph" alt=""/></div>
<map name="batteries_8c_aaacb3ffbd5367bbde01d4e8120fdbea0_icgraph" id="batteries_8c_aaacb3ffbd5367bbde01d4e8120fdbea0_icgraph">
<area shape="rect" title="Control the balance state of an individual cell. NB: this is inneficient if balancing multiple cells,..." alt="" coords="204,5,299,32"/>
<area shape="rect" href="control_state_machine__mock_8c.html#a1ff8bdf04d048eab40c9b97f42dc0c23" title=" " alt="" coords="5,5,156,32"/>
</map>
</div>

</div>
</div>
<a id="a9144cd162ceec3e710baea6601149b43"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9144cd162ceec3e710baea6601149b43">&#9670;&nbsp;</a></span>balanceCharge()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="batteries_8c.html#a2f80b01711da374b25803fa818de09b1">ChargeReturn</a> balanceCharge </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs balance charging. For more info, see the BMU page on confluence. </p>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="batteries_8c.html#a57d972b2a0b68887bd7afab4c1d2553f">ChargeReturn</a> </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8c_a9144cd162ceec3e710baea6601149b43_cgraph.png" border="0" usemap="#batteries_8c_a9144cd162ceec3e710baea6601149b43_cgraph" alt=""/></div>
<map name="batteries_8c_a9144cd162ceec3e710baea6601149b43_cgraph" id="batteries_8c_a9144cd162ceec3e710baea6601149b43_cgraph">
<area shape="rect" title="Performs balance charging. For more info, see the BMU page on confluence." alt="" coords="5,530,115,557"/>
<area shape="rect" href="ltc6811_8c.html#a7cf49fe3c9809ef6d0920eb322b640e0" title=" " alt="" coords="473,23,596,50"/>
<area shape="rect" href="ltc6811_8c.html#a834a806df72b807b8adb49a05a1b7e1d" title=" " alt="" coords="192,378,353,405"/>
<area shape="rect" href="ltc6811_8c.html#a265419e3399d2e64f36eba3e266ca7ed" title=" " alt="" coords="705,277,860,303"/>
<area shape="rect" href="ltc6811_8c.html#a2150f002603baac59966270488687aaa" title=" " alt="" coords="722,105,843,131"/>
<area shape="rect" href="batteries_8c.html#ad7b6a3fe5ae01ef7695d9c36da0f832b" title="Called if an error with batteries is detected. Raises error and stops battery task execution (without..." alt="" coords="475,454,595,481"/>
<area shape="rect" href="batteries_8c.html#a796b02ffebbe6ba22dca62df11bcb05c" title="Called by battery task it an error is encountered that is not immediately fatal. This causes the task..." alt="" coords="211,429,334,455"/>
<area shape="rect" href="batteries_8c.html#a7b0e95f68b412d5d5e9620ffbae8750d" title="Calculates the state of charge of the battery pack. This is a measure of how much capacity the pack h..." alt="" coords="192,530,353,557"/>
<area shape="rect" href="batteries_8c.html#a6b2f1ad817d75d1c5c590814371b5062" title="Calculates the state of power of the battery pack. TODO: this calculation is from 2017,..." alt="" coords="195,581,351,607"/>
<area shape="rect" href="batteries_8c.html#a7090234402b08bb512cf5db06702c9f0" title="Checks cell voltages and temperatures to ensure they are within safe limits, as well as sending out w..." alt="" coords="176,631,369,658"/>
<area shape="rect" href="ltc6811_8c.html#ae1465efe2812c47454aa2472d07ba88f" title=" " alt="" coords="200,327,345,354"/>
<area shape="rect" href="batteries_8c.html#a533907b25f7b1dbb355151d336ed9ff6" title="Sends messages to the charger. The charger expects a message every second so this needs to be repeate..." alt="" coords="211,783,334,810"/>
<area shape="rect" href="batteries_8c.html#a43ea41cc1c21bd36b3622076e20b596c" title="Sends the maximum charge current and voltage to the charger and waits for the charger to start chargi..." alt="" coords="733,682,833,709"/>
<area shape="rect" href="batteries_8c.html#acd3cd9ec15fdceb68c5516f59552605c" title="Call on a succesful run through main loop. Decrements error counter on succesful run through main loo..." alt="" coords="163,834,382,861"/>
<area shape="rect" href="batteries_8c.html#a3d41850a2fe8400978c4f68163d726be" title="Calculates the SoC of a cell from the cell&#39;s voltage." alt="" coords="201,885,344,911"/>
<area shape="rect" href="batteries_8c.html#aa04706789e98d82797970064b10dd0c9" title="Stops all cells balancing, but stores which cells were balancing to allowing resuming of balance for ..." alt="" coords="221,226,325,253"/>
<area shape="rect" href="batteries_8c.html#ad54912c48ac30fc66796b2aeca58cea7" title="Stops all cells balancing by sending command to AMS boards." alt="" coords="487,175,582,202"/>
<area shape="rect" href="batteries_8c.html#afa698a16023626be583ce5082c76f5ec" title="Publishes the current pack voltage value to the queue for other tasks to read from." alt="" coords="204,935,341,962"/>
<area shape="rect" href="batteries_8c.html#a36a3c81e474331b59839cb2f565c7704" title="Reads the cell voltages and temperatures from the AMS boards. The battery temperature and cell voltag..." alt="" coords="181,986,364,1013"/>
<area shape="rect" href="batteries_8c.html#a82969943d42e6067b966c64c61196dcd" title="Resumes balancing after call to pauseBalance." alt="" coords="217,74,329,101"/>
<area shape="rect" href="_b_m_u__can_8h.html#ad57fbcfdfc9c7cb21469a803077961e4" title=" " alt="" coords="163,1125,383,1151"/>
<area shape="rect" href="batteries_8c.html#a5cf6c235603af078c2dc841ae579f3b5" title="Sends a command to the charger to stop charging." alt="" coords="223,733,322,759"/>
<area shape="rect" href="ltc6811_8c.html#a195d06cb021b2d6e1c3f6877c7dce697" title=" " alt="" coords="703,23,862,50"/>
<area shape="rect" href="ltc6811_8c.html#ade492dd40b5c05cced4ddfc4dc11e473" title=" " alt="" coords="933,275,1105,302"/>
<area shape="rect" href="ltc6811_8c.html#afc4b749b996cce4e7c4cb98f832a0e8b" title=" " alt="" coords="943,155,1095,196"/>
<area shape="rect" href="ltc6811_8c.html#ae5189473d88cbc9c95bec62bea119690" title=" " alt="" coords="1181,107,1281,134"/>
<area shape="rect" href="ltc6811_8c.html#a877fbade1097a0f7a8d92cb1fe140fd4" title=" " alt="" coords="1187,221,1274,247"/>
<area shape="rect" href="batteries_8c.html#ae1d79ed043eedc99cbc01f7c59ce369e" title="This takes an array of the instantaneous cell volages, and filters them on an ongoing basis using the..." alt="" coords="474,631,595,658"/>
<area shape="rect" href="ltc6811_8c.html#a5f28e02e9042fac10566ccd33055107b" title=" " alt="" coords="497,327,572,354"/>
<area shape="rect" href="ltc6811_8c.html#a5fa69ef198c71293dee9f06a19948197" title=" " alt="" coords="431,378,639,405"/>
<area shape="rect" href="ltc6811_8c.html#a34e3a15c6e14e689263ecf24e6976798" title=" " alt="" coords="724,530,841,557"/>
<area shape="rect" href="ltc6811_8c.html#ae28ae4cc57cf46a9e442fb231db8425a" title=" " alt="" coords="696,378,869,405"/>
<area shape="rect" href="ltc6811_8c.html#a33a22f924ede7e8772d0b4f56b344c41" title=" " alt="" coords="959,353,1079,379"/>
<area shape="rect" href="ltc6811_8c.html#ad6558a7978dc4e259a559dc105ae4f51" title=" " alt="" coords="1193,417,1268,443"/>
<area shape="rect" href="ltc6811_8c.html#a4ad01f53790d62f9da74fc4c413b4a84" title=" " alt="" coords="717,429,848,455"/>
<area shape="rect" href="ltc6811_8c.html#a8b81b1f445f3ea0a2ca4be7993a55fe1" title=" " alt="" coords="721,159,844,186"/>
<area shape="rect" href="charger_control_8c.html#a3924dbd41d109e69d729fefb4eae394f" title=" " alt="" coords="1160,783,1301,810"/>
<area shape="rect" href="charger_control_8c.html#a7be8905ea1fecd563a161d1479f42812" title=" " alt="" coords="457,733,613,759"/>
<area shape="rect" href="_b_m_u__charger__can_8h.html#aed1361c90fff728fcdda8e010dc39a7b" title=" " alt="" coords="687,783,879,810"/>
<area shape="rect" href="charger_control_8c.html#a5a2d967359b16e33f7e6631942424a62" title=" " alt="" coords="927,733,1112,759"/>
<area shape="rect" href="batteries_8c.html#aed5d06c4a55e40673204ceacf2fde819" title="Maps a value from one range to another in a linear manner." alt="" coords="475,885,594,911"/>
<area shape="rect" href="ltc6811_8c.html#a4daa19d51cc618af1f72e0b8094640df" title=" " alt="" coords="459,226,610,253"/>
<area shape="rect" href="ltc6811_8c.html#a2a661887e71a5361cf40681241c096b4" title=" " alt="" coords="710,211,855,252"/>
<area shape="rect" href="ltc6811_8c.html#a92a5527a207a1a7eab501cb274cfc4ec" title=" " alt="" coords="455,957,614,999"/>
<area shape="rect" href="_b_m_u__can_8c.html#a2e0be541583b43799a5c6d1fb5120623" title=" " alt="" coords="433,1175,636,1202"/>
<area shape="rect" href="_b_m_u__can_8c.html#af239160f65fdb7863240ad859710a8b5" title=" " alt="" coords="435,1226,634,1253"/>
<area shape="rect" href="_b_m_u__can_8c.html#a39e81e40fdd13319d9041359f6d0c984" title=" " alt="" coords="435,1277,634,1303"/>
<area shape="rect" href="_b_m_u__can_8c.html#a8434d9faa033265350eebaca4938ccd1" title=" " alt="" coords="470,1023,599,1050"/>
<area shape="rect" href="_b_m_u__can_8c.html#a29c707414d9c2f5afee129958aa39ab5" title=" " alt="" coords="460,1074,609,1101"/>
<area shape="rect" href="_b_m_u__can_8c.html#a8f0d074cf6cba96395c4605933066272" title=" " alt="" coords="462,1125,607,1151"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8c_a9144cd162ceec3e710baea6601149b43_icgraph.png" border="0" usemap="#batteries_8c_a9144cd162ceec3e710baea6601149b43_icgraph" alt=""/></div>
<map name="batteries_8c_a9144cd162ceec3e710baea6601149b43_icgraph" id="batteries_8c_a9144cd162ceec3e710baea6601149b43_icgraph">
<area shape="rect" title="Performs balance charging. For more info, see the BMU page on confluence." alt="" coords="144,5,253,32"/>
<area shape="rect" href="batteries_8c.html#a3364449b5cc8a93c89985f5d9fa2984b" title="Task to monitor cell voltages and temperatures, as well as perform balance charging." alt="" coords="5,5,96,32"/>
</map>
</div>

</div>
</div>
<a id="aeb2f305c6977c16734384de553edfa73"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb2f305c6977c16734384de553edfa73">&#9670;&nbsp;</a></span>batteryStart()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_StatusTypeDef batteryStart </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes the battery task. </p>
<dl class="section return"><dt>Returns</dt><dd>HAL_StatusTypeDef </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8c_aeb2f305c6977c16734384de553edfa73_cgraph.png" border="0" usemap="#batteries_8c_aeb2f305c6977c16734384de553edfa73_cgraph" alt=""/></div>
<map name="batteries_8c_aeb2f305c6977c16734384de553edfa73_cgraph" id="batteries_8c_aeb2f305c6977c16734384de553edfa73_cgraph">
<area shape="rect" title="Initializes the battery task." alt="" coords="5,97,96,124"/>
<area shape="rect" href="ltc6811_8c.html#a69e579b99844f6bd5f02bdfb7b835f3b" title=" " alt="" coords="144,97,212,124"/>
<area shape="rect" href="ltc6811_8c.html#aa34880d25e5271cdc802f42244f296eb" title=" " alt="" coords="260,21,409,48"/>
<area shape="rect" href="ltc6811_8c.html#a89185e147fa6785b3470869603e18acb" title=" " alt="" coords="275,72,394,99"/>
<area shape="rect" href="ltc6811_8c.html#a33a22f924ede7e8772d0b4f56b344c41" title=" " alt="" coords="275,123,395,149"/>
<area shape="rect" href="ltc6811_8c.html#a2150f002603baac59966270488687aaa" title=" " alt="" coords="274,173,395,200"/>
<area shape="rect" href="ltc6811_8c.html#ad6013027859c0de9b051f6e211e9573b" title=" " alt="" coords="457,47,565,73"/>
<area shape="rect" href="ltc6811_8c.html#afc4b749b996cce4e7c4cb98f832a0e8b" title=" " alt="" coords="613,166,765,207"/>
<area shape="rect" href="ltc6811_8c.html#abb934da9ceb6a1033ecca18dc302ff63" title=" " alt="" coords="647,5,732,32"/>
<area shape="rect" href="ltc6811_8c.html#a7f2f9d2ae185730e08b49bb6c76b8456" title=" " alt="" coords="632,56,747,83"/>
<area shape="rect" href="ltc6811_8c.html#ad8b550ce6ec58f283e62a96ffc5012e7" title=" " alt="" coords="652,107,727,133"/>
<area shape="rect" href="ltc6811_8c.html#ae5189473d88cbc9c95bec62bea119690" title=" " alt="" coords="813,173,913,200"/>
<area shape="rect" href="ltc6811_8c.html#a877fbade1097a0f7a8d92cb1fe140fd4" title=" " alt="" coords="468,148,555,175"/>
<area shape="rect" href="ltc6811_8c.html#ad6558a7978dc4e259a559dc105ae4f51" title=" " alt="" coords="474,97,549,124"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8c_aeb2f305c6977c16734384de553edfa73_icgraph.png" border="0" usemap="#batteries_8c_aeb2f305c6977c16734384de553edfa73_icgraph" alt=""/></div>
<map name="batteries_8c_aeb2f305c6977c16734384de553edfa73_icgraph" id="batteries_8c_aeb2f305c6977c16734384de553edfa73_icgraph">
<area shape="rect" title="Initializes the battery task." alt="" coords="144,5,235,32"/>
<area shape="rect" href="batteries_8c.html#a3364449b5cc8a93c89985f5d9fa2984b" title="Task to monitor cell voltages and temperatures, as well as perform balance charging." alt="" coords="5,5,96,32"/>
</map>
</div>

</div>
</div>
<a id="a3364449b5cc8a93c89985f5d9fa2984b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3364449b5cc8a93c89985f5d9fa2984b">&#9670;&nbsp;</a></span>batteryTask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void batteryTask </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>pvParameter</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Task to monitor cell voltages and temperatures, as well as perform balance charging. </p>
<p>!! Change the check in in bounded continue as well if you change this</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8c_a3364449b5cc8a93c89985f5d9fa2984b_cgraph.png" border="0" usemap="#batteries_8c_a3364449b5cc8a93c89985f5d9fa2984b_cgraph" alt=""/></div>
<map name="batteries_8c_a3364449b5cc8a93c89985f5d9fa2984b_cgraph" id="batteries_8c_a3364449b5cc8a93c89985f5d9fa2984b_cgraph">
<area shape="rect" title="Task to monitor cell voltages and temperatures, as well as perform balance charging." alt="" coords="5,593,96,619"/>
<area shape="rect" href="batteries_8c.html#a9144cd162ceec3e710baea6601149b43" title="Performs balance charging. For more info, see the BMU page on confluence." alt="" coords="181,567,291,594"/>
<area shape="rect" href="batteries_8c.html#ad7b6a3fe5ae01ef7695d9c36da0f832b" title="Called if an error with batteries is detected. Raises error and stops battery task execution (without..." alt="" coords="688,263,808,290"/>
<area shape="rect" href="batteries_8c.html#a796b02ffebbe6ba22dca62df11bcb05c" title="Called by battery task it an error is encountered that is not immediately fatal. This causes the task..." alt="" coords="425,263,547,290"/>
<area shape="rect" href="batteries_8c.html#a7b0e95f68b412d5d5e9620ffbae8750d" title="Calculates the state of charge of the battery pack. This is a measure of how much capacity the pack h..." alt="" coords="405,61,567,87"/>
<area shape="rect" href="batteries_8c.html#a6b2f1ad817d75d1c5c590814371b5062" title="Calculates the state of power of the battery pack. TODO: this calculation is from 2017,..." alt="" coords="408,111,564,138"/>
<area shape="rect" href="batteries_8c.html#a7090234402b08bb512cf5db06702c9f0" title="Checks cell voltages and temperatures to ensure they are within safe limits, as well as sending out w..." alt="" coords="389,10,583,37"/>
<area shape="rect" href="ltc6811_8c.html#ae1465efe2812c47454aa2472d07ba88f" title=" " alt="" coords="413,162,559,189"/>
<area shape="rect" href="batteries_8c.html#acd3cd9ec15fdceb68c5516f59552605c" title="Call on a succesful run through main loop. Decrements error counter on succesful run through main loo..." alt="" coords="377,973,595,999"/>
<area shape="rect" href="batteries_8c.html#afa698a16023626be583ce5082c76f5ec" title="Publishes the current pack voltage value to the queue for other tasks to read from." alt="" coords="417,1023,555,1050"/>
<area shape="rect" href="batteries_8c.html#a36a3c81e474331b59839cb2f565c7704" title="Reads the cell voltages and temperatures from the AMS boards. The battery temperature and cell voltag..." alt="" coords="395,922,577,949"/>
<area shape="rect" href="_b_m_u__can_8h.html#ad57fbcfdfc9c7cb21469a803077961e4" title=" " alt="" coords="376,1082,596,1109"/>
<area shape="rect" href="batteries_8c.html#aeb2f305c6977c16734384de553edfa73" title="Initializes the battery task." alt="" coords="191,821,281,847"/>
<area shape="rect" href="batteries_8c.html#a34364371025450fc6bc3f0d86df0e5ca" title="This functions sets all cell voltages and temps to known values. This is necessary for testing on Nuc..." alt="" coords="148,871,324,898"/>
<area shape="rect" href="_b_m_u__can_8h.html#a1af9d44d6482bda6199e7ddcf818c44b" title=" " alt="" coords="144,1053,328,1095"/>
<area shape="rect" href="ltc6811_8c.html#a7cf49fe3c9809ef6d0920eb322b640e0" title=" " alt="" coords="687,618,809,645"/>
<area shape="rect" href="ltc6811_8c.html#a834a806df72b807b8adb49a05a1b7e1d" title=" " alt="" coords="405,669,567,695"/>
<area shape="rect" href="ltc6811_8c.html#a265419e3399d2e64f36eba3e266ca7ed" title=" " alt="" coords="902,375,1057,402"/>
<area shape="rect" href="ltc6811_8c.html#a2150f002603baac59966270488687aaa" title=" " alt="" coords="919,546,1040,573"/>
<area shape="rect" href="batteries_8c.html#a533907b25f7b1dbb355151d336ed9ff6" title="Sends messages to the charger. The charger expects a message every second so this needs to be repeate..." alt="" coords="425,821,547,847"/>
<area shape="rect" href="batteries_8c.html#a43ea41cc1c21bd36b3622076e20b596c" title="Sends the maximum charge current and voltage to the charger and waits for the charger to start chargi..." alt="" coords="929,719,1029,746"/>
<area shape="rect" href="batteries_8c.html#a3d41850a2fe8400978c4f68163d726be" title="Calculates the SoC of a cell from the cell&#39;s voltage." alt="" coords="415,871,557,898"/>
<area shape="rect" href="batteries_8c.html#aa04706789e98d82797970064b10dd0c9" title="Stops all cells balancing, but stores which cells were balancing to allowing resuming of balance for ..." alt="" coords="434,415,538,442"/>
<area shape="rect" href="batteries_8c.html#ad54912c48ac30fc66796b2aeca58cea7" title="Stops all cells balancing by sending command to AMS boards." alt="" coords="701,466,795,493"/>
<area shape="rect" href="batteries_8c.html#a82969943d42e6067b966c64c61196dcd" title="Resumes balancing after call to pauseBalance." alt="" coords="430,567,542,594"/>
<area shape="rect" href="batteries_8c.html#a5cf6c235603af078c2dc841ae579f3b5" title="Sends a command to the charger to stop charging." alt="" coords="437,770,535,797"/>
<area shape="rect" href="ltc6811_8c.html#a195d06cb021b2d6e1c3f6877c7dce697" title=" " alt="" coords="900,618,1059,645"/>
<area shape="rect" href="ltc6811_8c.html#ade492dd40b5c05cced4ddfc4dc11e473" title=" " alt="" coords="1113,411,1285,438"/>
<area shape="rect" href="ltc6811_8c.html#afc4b749b996cce4e7c4cb98f832a0e8b" title=" " alt="" coords="1123,539,1275,580"/>
<area shape="rect" href="ltc6811_8c.html#ae5189473d88cbc9c95bec62bea119690" title=" " alt="" coords="1361,575,1461,602"/>
<area shape="rect" href="ltc6811_8c.html#a877fbade1097a0f7a8d92cb1fe140fd4" title=" " alt="" coords="1156,487,1243,514"/>
<area shape="rect" href="batteries_8c.html#ae1d79ed043eedc99cbc01f7c59ce369e" title="This takes an array of the instantaneous cell volages, and filters them on an ongoing basis using the..." alt="" coords="687,10,809,37"/>
<area shape="rect" href="ltc6811_8c.html#a5f28e02e9042fac10566ccd33055107b" title=" " alt="" coords="711,137,785,163"/>
<area shape="rect" href="ltc6811_8c.html#a5fa69ef198c71293dee9f06a19948197" title=" " alt="" coords="644,187,852,214"/>
<area shape="rect" href="charger_control_8c.html#a3924dbd41d109e69d729fefb4eae394f" title=" " alt="" coords="1340,795,1481,822"/>
<area shape="rect" href="charger_control_8c.html#a7be8905ea1fecd563a161d1479f42812" title=" " alt="" coords="670,770,826,797"/>
<area shape="rect" href="charger_control_8c.html#a5a2d967359b16e33f7e6631942424a62" title=" " alt="" coords="1107,770,1292,797"/>
<area shape="rect" href="batteries_8c.html#aed5d06c4a55e40673204ceacf2fde819" title="Maps a value from one range to another in a linear manner." alt="" coords="689,871,807,898"/>
<area shape="rect" href="ltc6811_8c.html#a4daa19d51cc618af1f72e0b8094640df" title=" " alt="" coords="673,415,823,442"/>
<area shape="rect" href="ltc6811_8c.html#a2a661887e71a5361cf40681241c096b4" title=" " alt="" coords="907,448,1052,489"/>
<area shape="rect" href="ltc6811_8c.html#a92a5527a207a1a7eab501cb274cfc4ec" title=" " alt="" coords="669,923,827,964"/>
<area shape="rect" href="_b_m_u__can_8c.html#a2e0be541583b43799a5c6d1fb5120623" title=" " alt="" coords="647,1191,849,1218"/>
<area shape="rect" href="_b_m_u__can_8c.html#af239160f65fdb7863240ad859710a8b5" title=" " alt="" coords="649,1242,847,1269"/>
<area shape="rect" href="_b_m_u__can_8c.html#a39e81e40fdd13319d9041359f6d0c984" title=" " alt="" coords="649,989,847,1015"/>
<area shape="rect" href="_b_m_u__can_8c.html#a8434d9faa033265350eebaca4938ccd1" title=" " alt="" coords="683,1039,813,1066"/>
<area shape="rect" href="_b_m_u__can_8c.html#a29c707414d9c2f5afee129958aa39ab5" title=" " alt="" coords="673,1090,823,1117"/>
<area shape="rect" href="_b_m_u__can_8c.html#a8f0d074cf6cba96395c4605933066272" title=" " alt="" coords="675,1141,821,1167"/>
<area shape="rect" href="ltc6811_8c.html#a69e579b99844f6bd5f02bdfb7b835f3b" title=" " alt="" coords="452,1209,520,1235"/>
<area shape="rect" href="ltc6811_8c.html#aa34880d25e5271cdc802f42244f296eb" title=" " alt="" coords="673,1343,823,1370"/>
<area shape="rect" href="_b_m_u__can_8c.html#aad2cf4f279b3101b47ab9d175c18fba9" title=" " alt="" coords="402,1259,570,1286"/>
</map>
</div>

</div>
</div>
<a id="ad7b6a3fe5ae01ef7695d9c36da0f832b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7b6a3fe5ae01ef7695d9c36da0f832b">&#9670;&nbsp;</a></span>BatteryTaskError()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BatteryTaskError </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Called if an error with batteries is detected. Raises error and stops battery task execution (without tripping watchdog) </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8c_ad7b6a3fe5ae01ef7695d9c36da0f832b_icgraph.png" border="0" usemap="#batteries_8c_ad7b6a3fe5ae01ef7695d9c36da0f832b_icgraph" alt=""/></div>
<map name="batteries_8c_ad7b6a3fe5ae01ef7695d9c36da0f832b_icgraph" id="batteries_8c_ad7b6a3fe5ae01ef7695d9c36da0f832b_icgraph">
<area shape="rect" title="Called if an error with batteries is detected. Raises error and stops battery task execution (without..." alt="" coords="472,26,592,53"/>
<area shape="rect" href="batteries_8c.html#a9144cd162ceec3e710baea6601149b43" title="Performs balance charging. For more info, see the BMU page on confluence." alt="" coords="144,26,253,53"/>
<area shape="rect" href="batteries_8c.html#a3364449b5cc8a93c89985f5d9fa2984b" title="Task to monitor cell voltages and temperatures, as well as perform balance charging." alt="" coords="5,26,96,53"/>
<area shape="rect" href="batteries_8c.html#a796b02ffebbe6ba22dca62df11bcb05c" title="Called by battery task it an error is encountered that is not immediately fatal. This causes the task..." alt="" coords="301,77,424,104"/>
</map>
</div>

</div>
</div>
<a id="a796b02ffebbe6ba22dca62df11bcb05c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a796b02ffebbe6ba22dca62df11bcb05c">&#9670;&nbsp;</a></span>boundedContinue()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool boundedContinue </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Called by battery task it an error is encountered that is not immediately fatal. This causes the task to retry its readings/whatever else failed MAX_ERROR_COUNT times, then fail and send error event. TODO: ensure this is max 500 ms to meet rules for cell reading times. </p>
<dl class="section return"><dt>Returns</dt><dd>true if errorCounter is below or equal to max error count, false otherwise </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8c_a796b02ffebbe6ba22dca62df11bcb05c_cgraph.png" border="0" usemap="#batteries_8c_a796b02ffebbe6ba22dca62df11bcb05c_cgraph" alt=""/></div>
<map name="batteries_8c_a796b02ffebbe6ba22dca62df11bcb05c_cgraph" id="batteries_8c_a796b02ffebbe6ba22dca62df11bcb05c_cgraph">
<area shape="rect" title="Called by battery task it an error is encountered that is not immediately fatal. This causes the task..." alt="" coords="5,5,128,32"/>
<area shape="rect" href="batteries_8c.html#ad7b6a3fe5ae01ef7695d9c36da0f832b" title="Called if an error with batteries is detected. Raises error and stops battery task execution (without..." alt="" coords="176,5,296,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8c_a796b02ffebbe6ba22dca62df11bcb05c_icgraph.png" border="0" usemap="#batteries_8c_a796b02ffebbe6ba22dca62df11bcb05c_icgraph" alt=""/></div>
<map name="batteries_8c_a796b02ffebbe6ba22dca62df11bcb05c_icgraph" id="batteries_8c_a796b02ffebbe6ba22dca62df11bcb05c_icgraph">
<area shape="rect" title="Called by battery task it an error is encountered that is not immediately fatal. This causes the task..." alt="" coords="301,31,424,57"/>
<area shape="rect" href="batteries_8c.html#a9144cd162ceec3e710baea6601149b43" title="Performs balance charging. For more info, see the BMU page on confluence." alt="" coords="144,5,253,32"/>
<area shape="rect" href="batteries_8c.html#a3364449b5cc8a93c89985f5d9fa2984b" title="Task to monitor cell voltages and temperatures, as well as perform balance charging." alt="" coords="5,31,96,57"/>
</map>
</div>

</div>
</div>
<a id="a7b0e95f68b412d5d5e9620ffbae8750d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b0e95f68b412d5d5e9620ffbae8750d">&#9670;&nbsp;</a></span>calculateStateOfCharge()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float calculateStateOfCharge </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the state of charge of the battery pack. This is a measure of how much capacity the pack has left on its current charge. Currently its implemented as a simple ratio of min cell voltage versus safe limits. </p>
<dl class="section return"><dt>Returns</dt><dd>State of Charge (percent) </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8c_a7b0e95f68b412d5d5e9620ffbae8750d_icgraph.png" border="0" usemap="#batteries_8c_a7b0e95f68b412d5d5e9620ffbae8750d_icgraph" alt=""/></div>
<map name="batteries_8c_a7b0e95f68b412d5d5e9620ffbae8750d_icgraph" id="batteries_8c_a7b0e95f68b412d5d5e9620ffbae8750d_icgraph">
<area shape="rect" title="Calculates the state of charge of the battery pack. This is a measure of how much capacity the pack h..." alt="" coords="301,31,463,57"/>
<area shape="rect" href="batteries_8c.html#a9144cd162ceec3e710baea6601149b43" title="Performs balance charging. For more info, see the BMU page on confluence." alt="" coords="144,5,253,32"/>
<area shape="rect" href="batteries_8c.html#a3364449b5cc8a93c89985f5d9fa2984b" title="Task to monitor cell voltages and temperatures, as well as perform balance charging." alt="" coords="5,31,96,57"/>
</map>
</div>

</div>
</div>
<a id="a6b2f1ad817d75d1c5c590814371b5062"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b2f1ad817d75d1c5c590814371b5062">&#9670;&nbsp;</a></span>calculateStateOfPower()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float calculateStateOfPower </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the state of power of the battery pack. TODO: this calculation is from 2017, so should be updated for the 2020 pack. </p>
<dl class="section return"><dt>Returns</dt><dd>The state of power of the battery pack (in Watts?) </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8c_a6b2f1ad817d75d1c5c590814371b5062_icgraph.png" border="0" usemap="#batteries_8c_a6b2f1ad817d75d1c5c590814371b5062_icgraph" alt=""/></div>
<map name="batteries_8c_a6b2f1ad817d75d1c5c590814371b5062_icgraph" id="batteries_8c_a6b2f1ad817d75d1c5c590814371b5062_icgraph">
<area shape="rect" title="Calculates the state of power of the battery pack. TODO: this calculation is from 2017,..." alt="" coords="301,31,457,57"/>
<area shape="rect" href="batteries_8c.html#a9144cd162ceec3e710baea6601149b43" title="Performs balance charging. For more info, see the BMU page on confluence." alt="" coords="144,5,253,32"/>
<area shape="rect" href="batteries_8c.html#a3364449b5cc8a93c89985f5d9fa2984b" title="Task to monitor cell voltages and temperatures, as well as perform balance charging." alt="" coords="5,31,96,57"/>
</map>
</div>

</div>
</div>
<a id="a445bbbf2332f3c63a4bfcddf4b78ff43"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a445bbbf2332f3c63a4bfcddf4b78ff43">&#9670;&nbsp;</a></span>canSendCellTask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void canSendCellTask </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>pvParameters</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sends the cell voltages and temperatures over CAN. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8c_a445bbbf2332f3c63a4bfcddf4b78ff43_cgraph.png" border="0" usemap="#batteries_8c_a445bbbf2332f3c63a4bfcddf4b78ff43_cgraph" alt=""/></div>
<map name="batteries_8c_a445bbbf2332f3c63a4bfcddf4b78ff43_cgraph" id="batteries_8c_a445bbbf2332f3c63a4bfcddf4b78ff43_cgraph">
<area shape="rect" title="Sends the cell voltages and temperatures over CAN." alt="" coords="5,85,129,112"/>
<area shape="rect" href="_b_m_u__can_8h.html#a9dbd675bf640a1a7f94d04e46428dce8" title=" " alt="" coords="183,56,362,83"/>
<area shape="rect" href="_b_m_u__can_8h.html#a6fb8cd081045bb5774818d1505f67df6" title=" " alt="" coords="177,115,368,141"/>
<area shape="rect" href="_b_m_u__can_8c.html#a0121f001f557553d39e331426469ad72" title=" " alt="" coords="416,5,639,32"/>
<area shape="rect" href="_b_m_u__can_8c.html#a0c2bd3ebc928be53bc88f27e3fde8ed2" title=" " alt="" coords="465,56,589,83"/>
<area shape="rect" href="_b_m_u__can_8c.html#a7eae5a05a1b60320a2ef3b7b767a33fa" title=" " alt="" coords="429,107,626,149"/>
<area shape="rect" href="_b_m_u__can_8c.html#a9c09ca4365c0517e5de5e2fb27a0800e" title=" " alt="" coords="459,173,595,200"/>
</map>
</div>

</div>
</div>
<a id="a7090234402b08bb512cf5db06702c9f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7090234402b08bb512cf5db06702c9f0">&#9670;&nbsp;</a></span>checkCellVoltagesAndTemps()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_StatusTypeDef checkCellVoltagesAndTemps </td>
          <td>(</td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>maxVoltage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>minVoltage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>maxTemp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>minTemp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>packVoltage</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks cell voltages and temperatures to ensure they are within safe limits, as well as sending out warnings when the values get close to their limits and updating max/min voltages/temps and calculated pack voltage NB: This skips checking temperatures of cells specified as having faulty measurements in <a class="el" href="batteries_8c.html#a4bb357024aa0bb23dcfba57009d3f836">isTempCellWorking</a> array. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">maxVoltage</td><td>The cell voltage of the cell with the max voltage </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">minVoltage</td><td>The cell voltage of the cell with the min voltage </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">maxTemp</td><td>The cell temperature of the cell with the max temperature </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">minTemp</td><td>The cell temperature of the cell with the min temperature </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">packVoltage</td><td>The sum of all the cell voltages, which should be the output voltage of the pack</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>HAL_StatusTypeDef </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8c_a7090234402b08bb512cf5db06702c9f0_cgraph.png" border="0" usemap="#batteries_8c_a7090234402b08bb512cf5db06702c9f0_cgraph" alt=""/></div>
<map name="batteries_8c_a7090234402b08bb512cf5db06702c9f0_cgraph" id="batteries_8c_a7090234402b08bb512cf5db06702c9f0_cgraph">
<area shape="rect" title="Checks cell voltages and temperatures to ensure they are within safe limits, as well as sending out w..." alt="" coords="5,5,199,32"/>
<area shape="rect" href="batteries_8c.html#ae1d79ed043eedc99cbc01f7c59ce369e" title="This takes an array of the instantaneous cell volages, and filters them on an ongoing basis using the..." alt="" coords="247,5,368,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8c_a7090234402b08bb512cf5db06702c9f0_icgraph.png" border="0" usemap="#batteries_8c_a7090234402b08bb512cf5db06702c9f0_icgraph" alt=""/></div>
<map name="batteries_8c_a7090234402b08bb512cf5db06702c9f0_icgraph" id="batteries_8c_a7090234402b08bb512cf5db06702c9f0_icgraph">
<area shape="rect" title="Checks cell voltages and temperatures to ensure they are within safe limits, as well as sending out w..." alt="" coords="301,31,495,57"/>
<area shape="rect" href="batteries_8c.html#a9144cd162ceec3e710baea6601149b43" title="Performs balance charging. For more info, see the BMU page on confluence." alt="" coords="144,5,253,32"/>
<area shape="rect" href="batteries_8c.html#a3364449b5cc8a93c89985f5d9fa2984b" title="Task to monitor cell voltages and temperatures, as well as perform balance charging." alt="" coords="5,31,96,57"/>
</map>
</div>

</div>
</div>
<a id="ade4720060f19979c4071eae3fb08ff92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade4720060f19979c4071eae3fb08ff92">&#9670;&nbsp;</a></span>clearSendOnlyOneCell()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void clearSendOnlyOneCell </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stop sending only one cell repeatedly, and go back to sending all cells over CAN. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8c_ade4720060f19979c4071eae3fb08ff92_icgraph.png" border="0" usemap="#batteries_8c_ade4720060f19979c4071eae3fb08ff92_icgraph" alt=""/></div>
<map name="batteries_8c_ade4720060f19979c4071eae3fb08ff92_icgraph" id="batteries_8c_ade4720060f19979c4071eae3fb08ff92_icgraph">
<area shape="rect" title="Stop sending only one cell repeatedly, and go back to sending all cells over CAN." alt="" coords="213,5,368,32"/>
<area shape="rect" href="control_state_machine__mock_8c.html#a07f875c96434a4f6c4a2362b3cd71ec4" title=" " alt="" coords="5,5,165,32"/>
</map>
</div>

</div>
</div>
<a id="a19d5fb02c3547746d76a121bf9f10807"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19d5fb02c3547746d76a121bf9f10807">&#9670;&nbsp;</a></span>cliSetIBus()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_StatusTypeDef cliSetIBus </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>IBus</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>For nucleo testing, allows setting a dummy value for the IBus reading. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">IBus</td><td>The value to set for IBus, in volts</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>HAL_StatusTypeDef </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8c_a19d5fb02c3547746d76a121bf9f10807_icgraph.png" border="0" usemap="#batteries_8c_a19d5fb02c3547746d76a121bf9f10807_icgraph" alt=""/></div>
<map name="batteries_8c_a19d5fb02c3547746d76a121bf9f10807_icgraph" id="batteries_8c_a19d5fb02c3547746d76a121bf9f10807_icgraph">
<area shape="rect" title="For nucleo testing, allows setting a dummy value for the IBus reading." alt="" coords="317,31,400,57"/>
<area shape="rect" href="control_state_machine__mock_8c.html#ae589dd0ff2c7eef372eda76de2c820de" title=" " alt="" coords="161,5,227,32"/>
<area shape="rect" href="control_state_machine__mock_8h.html#a814694b73a579d4576140f0ff7582510" title=" " alt="" coords="119,56,269,83"/>
<area shape="rect" href="user_init_8c.html#a0c5fe2b0843784b74406a16461353491" title=" " alt="" coords="5,56,71,83"/>
</map>
</div>

</div>
</div>
<a id="a6e1bc0d2209bd309c4db0a06009a339a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e1bc0d2209bd309c4db0a06009a339a">&#9670;&nbsp;</a></span>cliSetVBatt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_StatusTypeDef cliSetVBatt </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>VBatt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>For nucleo testing, allows setting a dummy value for the VBatt reading. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VBatt</td><td>The value to set for VBatt, in volts</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>HAL_StatusTypeDef </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8c_a6e1bc0d2209bd309c4db0a06009a339a_icgraph.png" border="0" usemap="#batteries_8c_a6e1bc0d2209bd309c4db0a06009a339a_icgraph" alt=""/></div>
<map name="batteries_8c_a6e1bc0d2209bd309c4db0a06009a339a_icgraph" id="batteries_8c_a6e1bc0d2209bd309c4db0a06009a339a_icgraph">
<area shape="rect" title="For nucleo testing, allows setting a dummy value for the VBatt reading." alt="" coords="317,31,405,57"/>
<area shape="rect" href="control_state_machine__mock_8c.html#a0dda484881d82c63b656ecae468da7cd" title=" " alt="" coords="157,5,231,32"/>
<area shape="rect" href="control_state_machine__mock_8h.html#a814694b73a579d4576140f0ff7582510" title=" " alt="" coords="119,56,269,83"/>
<area shape="rect" href="user_init_8c.html#a0c5fe2b0843784b74406a16461353491" title=" " alt="" coords="5,56,71,83"/>
</map>
</div>

</div>
</div>
<a id="a2ab7e555695e672e38894f394a31a3ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ab7e555695e672e38894f394a31a3ef">&#9670;&nbsp;</a></span>cliSetVBus()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_StatusTypeDef cliSetVBus </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>VBus</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>For nucleo testing, allows setting a dummy value for the VBus reading. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VBus</td><td>The value to set for VBus, in volts</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>HAL_StatusTypeDef </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8c_a2ab7e555695e672e38894f394a31a3ef_icgraph.png" border="0" usemap="#batteries_8c_a2ab7e555695e672e38894f394a31a3ef_icgraph" alt=""/></div>
<map name="batteries_8c_a2ab7e555695e672e38894f394a31a3ef_icgraph" id="batteries_8c_a2ab7e555695e672e38894f394a31a3ef_icgraph">
<area shape="rect" title="For nucleo testing, allows setting a dummy value for the VBus reading." alt="" coords="317,31,404,57"/>
<area shape="rect" href="control_state_machine__mock_8c.html#a675e2d9a32917c7ea848a381b54608a4" title=" " alt="" coords="158,5,230,32"/>
<area shape="rect" href="control_state_machine__mock_8h.html#a814694b73a579d4576140f0ff7582510" title=" " alt="" coords="119,56,269,83"/>
<area shape="rect" href="user_init_8c.html#a0c5fe2b0843784b74406a16461353491" title=" " alt="" coords="5,56,71,83"/>
</map>
</div>

</div>
</div>
<a id="a533907b25f7b1dbb355151d336ed9ff6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a533907b25f7b1dbb355151d336ed9ff6">&#9670;&nbsp;</a></span>continueCharging()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_StatusTypeDef continueCharging </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sends messages to the charger. The charger expects a message every second so this needs to be repeatedly called during charging. </p>
<dl class="section return"><dt>Returns</dt><dd>HAL_StatusTypeDef </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8c_a533907b25f7b1dbb355151d336ed9ff6_cgraph.png" border="0" usemap="#batteries_8c_a533907b25f7b1dbb355151d336ed9ff6_cgraph" alt=""/></div>
<map name="batteries_8c_a533907b25f7b1dbb355151d336ed9ff6_cgraph" id="batteries_8c_a533907b25f7b1dbb355151d336ed9ff6_cgraph">
<area shape="rect" title="Sends messages to the charger. The charger expects a message every second so this needs to be repeate..." alt="" coords="5,128,128,155"/>
<area shape="rect" href="charger_control_8c.html#a3924dbd41d109e69d729fefb4eae394f" title=" " alt="" coords="875,163,1016,189"/>
<area shape="rect" href="charger_control_8c.html#a7be8905ea1fecd563a161d1479f42812" title=" " alt="" coords="176,216,332,243"/>
<area shape="rect" href="_b_m_u__charger__can_8h.html#aed1361c90fff728fcdda8e010dc39a7b" title=" " alt="" coords="380,188,572,215"/>
<area shape="rect" href="batteries_8c.html#a43ea41cc1c21bd36b3622076e20b596c" title="Sends the maximum charge current and voltage to the charger and waits for the charger to start chargi..." alt="" coords="426,245,526,272"/>
<area shape="rect" href="_b_m_u__charger__can_8c.html#acd8b3ae6e7b109bda6eb39b1c3bb587d" title=" " alt="" coords="620,61,827,88"/>
<area shape="rect" href="_b_m_u__charger__can_8c.html#a830d3215e831c9651237cc0e7b494c8e" title=" " alt="" coords="622,112,825,139"/>
<area shape="rect" href="_b_m_u__charger__can_8c.html#a801381da95855eddaf3a02490e2f1929" title=" " alt="" coords="620,163,827,189"/>
<area shape="rect" href="_b_m_u__charger__can_8c.html#a4dec07f9486294bef6c03189395f26eb" title=" " alt="" coords="621,213,825,240"/>
<area shape="rect" href="_b_m_u__charger__can_8c.html#a2c1b47a8d4f9dfcf2ede4c3e93d531a7" title=" " alt="" coords="640,264,807,291"/>
<area shape="rect" href="charger_control_8c.html#a5a2d967359b16e33f7e6631942424a62" title=" " alt="" coords="631,315,816,341"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8c_a533907b25f7b1dbb355151d336ed9ff6_icgraph.png" border="0" usemap="#batteries_8c_a533907b25f7b1dbb355151d336ed9ff6_icgraph" alt=""/></div>
<map name="batteries_8c_a533907b25f7b1dbb355151d336ed9ff6_icgraph" id="batteries_8c_a533907b25f7b1dbb355151d336ed9ff6_icgraph">
<area shape="rect" title="Sends messages to the charger. The charger expects a message every second so this needs to be repeate..." alt="" coords="301,5,424,32"/>
<area shape="rect" href="batteries_8c.html#a9144cd162ceec3e710baea6601149b43" title="Performs balance charging. For more info, see the BMU page on confluence." alt="" coords="144,5,253,32"/>
<area shape="rect" href="batteries_8c.html#a3364449b5cc8a93c89985f5d9fa2984b" title="Task to monitor cell voltages and temperatures, as well as perform balance charging." alt="" coords="5,5,96,32"/>
</map>
</div>

</div>
</div>
<a id="acd3cd9ec15fdceb68c5516f59552605c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd3cd9ec15fdceb68c5516f59552605c">&#9670;&nbsp;</a></span>ERROR_COUNTER_SUCCESS()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ERROR_COUNTER_SUCCESS </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Call on a succesful run through main loop. Decrements error counter on succesful run through main loop. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8c_acd3cd9ec15fdceb68c5516f59552605c_icgraph.png" border="0" usemap="#batteries_8c_acd3cd9ec15fdceb68c5516f59552605c_icgraph" alt=""/></div>
<map name="batteries_8c_acd3cd9ec15fdceb68c5516f59552605c_icgraph" id="batteries_8c_acd3cd9ec15fdceb68c5516f59552605c_icgraph">
<area shape="rect" title="Call on a succesful run through main loop. Decrements error counter on succesful run through main loo..." alt="" coords="301,31,520,57"/>
<area shape="rect" href="batteries_8c.html#a9144cd162ceec3e710baea6601149b43" title="Performs balance charging. For more info, see the BMU page on confluence." alt="" coords="144,5,253,32"/>
<area shape="rect" href="batteries_8c.html#a3364449b5cc8a93c89985f5d9fa2984b" title="Task to monitor cell voltages and temperatures, as well as perform balance charging." alt="" coords="5,31,96,57"/>
</map>
</div>

</div>
</div>
<a id="ae1d79ed043eedc99cbc01f7c59ce369e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1d79ed043eedc99cbc01f7c59ce369e">&#9670;&nbsp;</a></span>filterCellVoltages()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void filterCellVoltages </td>
          <td>(</td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>cellVoltages</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>cellVoltagesFiltered</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This takes an array of the instantaneous cell volages, and filters them on an ongoing basis using the cellVoltagesFiltered array. For check cell voltages, a filtered version of cell voltages is needed to eliminate noise due to bad contact with AMS boards. The hypothesis is that the pogo pins make bad contact with the ams boards when the motors spin, thus the need for filtering. This hasn't been proven however, but the filtering fixed the errors we saw before (info up to date as of May 2020) NB: Filter voltages shouldn't be sent over CAN, only used with error checking. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cellVoltages</td><td>unfiltered cell voltage readings </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">cellVoltagesFiltered</td><td>filtered cell voltage readings </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8c_ae1d79ed043eedc99cbc01f7c59ce369e_icgraph.png" border="0" usemap="#batteries_8c_ae1d79ed043eedc99cbc01f7c59ce369e_icgraph" alt=""/></div>
<map name="batteries_8c_ae1d79ed043eedc99cbc01f7c59ce369e_icgraph" id="batteries_8c_ae1d79ed043eedc99cbc01f7c59ce369e_icgraph">
<area shape="rect" title="This takes an array of the instantaneous cell volages, and filters them on an ongoing basis using the..." alt="" coords="543,31,664,57"/>
<area shape="rect" href="batteries_8c.html#a7090234402b08bb512cf5db06702c9f0" title="Checks cell voltages and temperatures to ensure they are within safe limits, as well as sending out w..." alt="" coords="301,31,495,57"/>
<area shape="rect" href="batteries_8c.html#a9144cd162ceec3e710baea6601149b43" title="Performs balance charging. For more info, see the BMU page on confluence." alt="" coords="144,5,253,32"/>
<area shape="rect" href="batteries_8c.html#a3364449b5cc8a93c89985f5d9fa2984b" title="Task to monitor cell voltages and temperatures, as well as perform balance charging." alt="" coords="5,31,96,57"/>
</map>
</div>

</div>
</div>
<a id="a1300d8fea84c20d3945380460f61f81d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1300d8fea84c20d3945380460f61f81d">&#9670;&nbsp;</a></span>filterIBus()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float filterIBus </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>IBus</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Low pass filters the HV Bus current measurement. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">IBus</td><td>the measured HV Bus current </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The filtered HV Bus current </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8c_a1300d8fea84c20d3945380460f61f81d_icgraph.png" border="0" usemap="#batteries_8c_a1300d8fea84c20d3945380460f61f81d_icgraph" alt=""/></div>
<map name="batteries_8c_a1300d8fea84c20d3945380460f61f81d_icgraph" id="batteries_8c_a1300d8fea84c20d3945380460f61f81d_icgraph">
<area shape="rect" title="Low pass filters the HV Bus current measurement." alt="" coords="415,5,489,32"/>
<area shape="rect" href="batteries_8c.html#a4d72951e5a03e396bb864b5c45bda0f0" title="Measures HV voltages and currents using the HV ADC." alt="" coords="172,5,367,32"/>
<area shape="rect" href="batteries_8c.html#a1ef8191389452a8f21cb2d02b20cba29" title=" " alt="" coords="5,5,124,32"/>
</map>
</div>

</div>
</div>
<a id="a0ee7fbdeb8e2e8413b4fc77ba59223d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ee7fbdeb8e2e8413b4fc77ba59223d5">&#9670;&nbsp;</a></span>getIBus()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_StatusTypeDef getIBus </td>
          <td>(</td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>IBus</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the most recent bus current reading. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">IBus</td><td>pointer to a float to store the IBus reading, in amps</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>HAL_StatusTypeDef </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8c_a0ee7fbdeb8e2e8413b4fc77ba59223d5_icgraph.png" border="0" usemap="#batteries_8c_a0ee7fbdeb8e2e8413b4fc77ba59223d5_icgraph" alt=""/></div>
<map name="batteries_8c_a0ee7fbdeb8e2e8413b4fc77ba59223d5_icgraph" id="batteries_8c_a0ee7fbdeb8e2e8413b4fc77ba59223d5_icgraph">
<area shape="rect" title="Get the most recent bus current reading." alt="" coords="585,59,652,86"/>
<area shape="rect" href="precharge_discharge_8c.html#aeb4682e026fd4f795f52338469d54915" title="Discharges HV Bus. Opens contactors which connects in discharge resistor to discharge bus voltage...." alt="" coords="259,84,337,111"/>
<area shape="rect" href="control_state_machine__mock_8c.html#ab8fcd76c656df5bde6a289c559ae4599" title=" " alt="" coords="415,34,508,60"/>
<area shape="rect" href="control_state_machine__mock_8c.html#a7776993523843f04088c3c030136c38a" title=" " alt="" coords="385,84,537,111"/>
<area shape="rect" href="precharge_discharge_8c.html#af98be4ce700b42b38a9f1126522cbd75" title="Update HV Bus measurements." alt="" coords="388,135,535,162"/>
<area shape="rect" href="precharge_discharge_8c.html#a65d178f293cd832dab02da08d5e86748" title="Task to control precharge and discharge. Receives notifications from the control state machine to eit..." alt="" coords="5,110,84,136"/>
<area shape="rect" href="precharge_discharge_8c.html#a7c67d24028b0fc2b67821ea9b0b55144" title="Perform precharge. If succesful, bus voltage will equal battery voltage." alt="" coords="132,135,211,162"/>
</map>
</div>

</div>
</div>
<a id="ab07aef73f633627b5a1a78e40f15961f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab07aef73f633627b5a1a78e40f15961f">&#9670;&nbsp;</a></span>getPackVoltage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_StatusTypeDef getPackVoltage </td>
          <td>(</td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>packVoltage</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the current pack voltage. This returns the pack voltage as calculated by summing all the cell voltages. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">packVoltage</td><td>pointer to a float to return the pack voltage (in volts)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>HAL_StatusTypeDe </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8c_ab07aef73f633627b5a1a78e40f15961f_icgraph.png" border="0" usemap="#batteries_8c_ab07aef73f633627b5a1a78e40f15961f_icgraph" alt=""/></div>
<map name="batteries_8c_ab07aef73f633627b5a1a78e40f15961f_icgraph" id="batteries_8c_ab07aef73f633627b5a1a78e40f15961f_icgraph">
<area shape="rect" title="Gets the current pack voltage. This returns the pack voltage as calculated by summing all the cell vo..." alt="" coords="273,31,388,57"/>
<area shape="rect" href="precharge_discharge_8c.html#a7c67d24028b0fc2b67821ea9b0b55144" title="Perform precharge. If succesful, bus voltage will equal battery voltage." alt="" coords="139,5,218,32"/>
<area shape="rect" href="control_state_machine__mock_8c.html#ab8fcd76c656df5bde6a289c559ae4599" title=" " alt="" coords="132,56,225,83"/>
<area shape="rect" href="precharge_discharge_8c.html#a65d178f293cd832dab02da08d5e86748" title="Task to control precharge and discharge. Receives notifications from the control state machine to eit..." alt="" coords="5,5,84,32"/>
</map>
</div>

</div>
</div>
<a id="a3d41850a2fe8400978c4f68163d726be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d41850a2fe8400978c4f68163d726be">&#9670;&nbsp;</a></span>getSOCFromVoltage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float getSOCFromVoltage </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>cellVoltage</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the SoC of a cell from the cell's voltage. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cellVoltage</td><td>The cell voltage</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the SoC of the cell in percent (0-100) </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8c_a3d41850a2fe8400978c4f68163d726be_cgraph.png" border="0" usemap="#batteries_8c_a3d41850a2fe8400978c4f68163d726be_cgraph" alt=""/></div>
<map name="batteries_8c_a3d41850a2fe8400978c4f68163d726be_cgraph" id="batteries_8c_a3d41850a2fe8400978c4f68163d726be_cgraph">
<area shape="rect" title="Calculates the SoC of a cell from the cell&#39;s voltage." alt="" coords="5,5,148,32"/>
<area shape="rect" href="batteries_8c.html#aed5d06c4a55e40673204ceacf2fde819" title="Maps a value from one range to another in a linear manner." alt="" coords="196,5,315,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8c_a3d41850a2fe8400978c4f68163d726be_icgraph.png" border="0" usemap="#batteries_8c_a3d41850a2fe8400978c4f68163d726be_icgraph" alt=""/></div>
<map name="batteries_8c_a3d41850a2fe8400978c4f68163d726be_icgraph" id="batteries_8c_a3d41850a2fe8400978c4f68163d726be_icgraph">
<area shape="rect" title="Calculates the SoC of a cell from the cell&#39;s voltage." alt="" coords="301,5,444,32"/>
<area shape="rect" href="batteries_8c.html#a9144cd162ceec3e710baea6601149b43" title="Performs balance charging. For more info, see the BMU page on confluence." alt="" coords="144,5,253,32"/>
<area shape="rect" href="batteries_8c.html#a3364449b5cc8a93c89985f5d9fa2984b" title="Task to monitor cell voltages and temperatures, as well as perform balance charging." alt="" coords="5,5,96,32"/>
</map>
</div>

</div>
</div>
<a id="aff30116cb629c2efdad61c2ccaec0c36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff30116cb629c2efdad61c2ccaec0c36">&#9670;&nbsp;</a></span>getVBatt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_StatusTypeDef getVBatt </td>
          <td>(</td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>VBatt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the most recent battery voltage reading (from the HV ADC). Note: this is only equal to the battery voltage when both contactors are closed. to get the battery voltage in all times, use <a class="el" href="batteries_8h.html#ab07aef73f633627b5a1a78e40f15961f">getPackVoltage</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">pointer</td><td>to a float to store the VBatt reading, in volts</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>HAL_StatusTypeDef </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8c_aff30116cb629c2efdad61c2ccaec0c36_icgraph.png" border="0" usemap="#batteries_8c_aff30116cb629c2efdad61c2ccaec0c36_icgraph" alt=""/></div>
<map name="batteries_8c_aff30116cb629c2efdad61c2ccaec0c36_icgraph" id="batteries_8c_aff30116cb629c2efdad61c2ccaec0c36_icgraph">
<area shape="rect" title="Get the most recent battery voltage reading (from the HV ADC). Note: this is only equal to the batter..." alt="" coords="585,56,659,83"/>
<area shape="rect" href="control_state_machine__mock_8c.html#ab8fcd76c656df5bde6a289c559ae4599" title=" " alt="" coords="415,5,508,32"/>
<area shape="rect" href="control_state_machine__mock_8c.html#a7776993523843f04088c3c030136c38a" title=" " alt="" coords="385,56,537,83"/>
<area shape="rect" href="precharge_discharge_8c.html#af98be4ce700b42b38a9f1126522cbd75" title="Update HV Bus measurements." alt="" coords="388,107,535,133"/>
<area shape="rect" href="precharge_discharge_8c.html#aeb4682e026fd4f795f52338469d54915" title="Discharges HV Bus. Opens contactors which connects in discharge resistor to discharge bus voltage...." alt="" coords="259,81,337,108"/>
<area shape="rect" href="precharge_discharge_8c.html#a7c67d24028b0fc2b67821ea9b0b55144" title="Perform precharge. If succesful, bus voltage will equal battery voltage." alt="" coords="132,132,211,159"/>
<area shape="rect" href="precharge_discharge_8c.html#a65d178f293cd832dab02da08d5e86748" title="Task to control precharge and discharge. Receives notifications from the control state machine to eit..." alt="" coords="5,107,84,133"/>
</map>
</div>

</div>
</div>
<a id="a6fbf3bf910348af26a580fc418f89f5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6fbf3bf910348af26a580fc418f89f5e">&#9670;&nbsp;</a></span>getVBus()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_StatusTypeDef getVBus </td>
          <td>(</td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>VBus</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the most recent HV Bus voltage reading (from the HV ADC) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">pointer</td><td>to a float to store the VBus reading, in volts</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>HAL_StatusTypeDef </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8c_a6fbf3bf910348af26a580fc418f89f5e_icgraph.png" border="0" usemap="#batteries_8c_a6fbf3bf910348af26a580fc418f89f5e_icgraph" alt=""/></div>
<map name="batteries_8c_a6fbf3bf910348af26a580fc418f89f5e_icgraph" id="batteries_8c_a6fbf3bf910348af26a580fc418f89f5e_icgraph">
<area shape="rect" title="Get the most recent HV Bus voltage reading (from the HV ADC)" alt="" coords="585,56,657,83"/>
<area shape="rect" href="control_state_machine__mock_8c.html#ab8fcd76c656df5bde6a289c559ae4599" title=" " alt="" coords="415,5,508,32"/>
<area shape="rect" href="control_state_machine__mock_8c.html#a7776993523843f04088c3c030136c38a" title=" " alt="" coords="385,56,537,83"/>
<area shape="rect" href="precharge_discharge_8c.html#af98be4ce700b42b38a9f1126522cbd75" title="Update HV Bus measurements." alt="" coords="388,107,535,133"/>
<area shape="rect" href="precharge_discharge_8c.html#aeb4682e026fd4f795f52338469d54915" title="Discharges HV Bus. Opens contactors which connects in discharge resistor to discharge bus voltage...." alt="" coords="259,81,337,108"/>
<area shape="rect" href="precharge_discharge_8c.html#a7c67d24028b0fc2b67821ea9b0b55144" title="Perform precharge. If succesful, bus voltage will equal battery voltage." alt="" coords="132,132,211,159"/>
<area shape="rect" href="precharge_discharge_8c.html#a65d178f293cd832dab02da08d5e86748" title="Task to control precharge and discharge. Receives notifications from the control state machine to eit..." alt="" coords="5,107,84,133"/>
</map>
</div>

</div>
</div>
<a id="a1ef8191389452a8f21cb2d02b20cba29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ef8191389452a8f21cb2d02b20cba29">&#9670;&nbsp;</a></span>HVMeasureTask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void HVMeasureTask </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>pvParamaters</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Measures the voltage and current on the HV Bus as well as the HV battery pack voltage. Note that the HV battery pack voltage (VBatt) is only equal to the actual pack voltage in ceraint contactor states, see prechargeDischarge procedure on confluence for more info. Instead, use <a class="el" href="batteries_8h.html#ab07aef73f633627b5a1a78e40f15961f">getPackVoltage</a> which bases it measurement on the sum of cell voltages </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8c_a1ef8191389452a8f21cb2d02b20cba29_cgraph.png" border="0" usemap="#batteries_8c_a1ef8191389452a8f21cb2d02b20cba29_cgraph" alt=""/></div>
<map name="batteries_8c_a1ef8191389452a8f21cb2d02b20cba29_cgraph" id="batteries_8c_a1ef8191389452a8f21cb2d02b20cba29_cgraph">
<area shape="rect" title=" " alt="" coords="5,157,124,184"/>
<area shape="rect" href="ade7912_8c.html#ae4f34cba54df4511eefe9c6e1b87b9c7" title=" " alt="" coords="233,56,314,83"/>
<area shape="rect" href="batteries_8c.html#a37d4140213dc1708776032fc935e0b39" title="Publishes the most recent HV Bus measurements to queues for other tasks to read from Queue overwrite,..." alt="" coords="172,132,375,159"/>
<area shape="rect" href="batteries_8c.html#a4d72951e5a03e396bb864b5c45bda0f0" title="Measures HV voltages and currents using the HV ADC." alt="" coords="176,183,371,209"/>
<area shape="rect" href="_b_m_u__can_8h.html#a6e17ca7fed9637a18fc11e407a3684a3" title=" " alt="" coords="176,360,371,387"/>
<area shape="rect" href="ade7912_8c.html#a491bcafc23bd1602ed45988ee15b5333" title=" " alt="" coords="632,5,732,32"/>
<area shape="rect" href="ade7912_8c.html#ab46c27793771a87a99acfbbda9db0ca5" title=" " alt="" coords="464,56,543,83"/>
<area shape="rect" href="ade7912_8c.html#ae3cbdc95c83faf3865265519f8d59859" title=" " alt="" coords="780,56,883,83"/>
<area shape="rect" href="ade7912_8c.html#ac93c6c24e9f7f55cf6bd041fda4ab91e" title=" " alt="" coords="639,56,725,83"/>
<area shape="rect" href="ade7912_8c.html#af0f5c0f7b51bfb3d1644b87f85d3588a" title=" " alt="" coords="442,107,565,133"/>
<area shape="rect" href="ade7912_8c.html#a1a71e3fb2f93c6556b723a1a70e4fa1b" title=" " alt="" coords="455,157,551,184"/>
<area shape="rect" href="ade7912_8c.html#ac933b80dc6a6509a513f4b73b559a78a" title=" " alt="" coords="455,208,551,235"/>
<area shape="rect" href="batteries_8c.html#a1300d8fea84c20d3945380460f61f81d" title="Low pass filters the HV Bus current measurement." alt="" coords="466,259,541,285"/>
<area shape="rect" href="ade7912_8c.html#ac044d42855f65563378bfd5f320571d5" title=" " alt="" coords="645,132,719,159"/>
<area shape="rect" href="_b_m_u__can_8c.html#af3db50d42c9b0d4ef45fb61bdf664130" title=" " alt="" coords="426,309,581,336"/>
<area shape="rect" href="_b_m_u__can_8c.html#af11d799f4c3ade845767a930c0f55e98" title=" " alt="" coords="426,360,581,387"/>
<area shape="rect" href="_b_m_u__can_8c.html#a2f60a82b4edc547a944d8d127736cf4b" title=" " alt="" coords="423,411,584,437"/>
<area shape="rect" href="_b_m_u__can_8c.html#a05b2f7808f176a2a2b5c7fe590dde9c0" title=" " alt="" coords="425,461,582,488"/>
</map>
</div>

</div>
</div>
<a id="a1f0375c4fc87fa9cfd8fbc1c5fcd33c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f0375c4fc87fa9cfd8fbc1c5fcd33c9">&#9670;&nbsp;</a></span>imdTask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void imdTask </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>pvParamaters</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Monitors the Insulation Monitoring Device (IMD). Raises error if IMD reports fault. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8c_a1f0375c4fc87fa9cfd8fbc1c5fcd33c9_cgraph.png" border="0" usemap="#batteries_8c_a1f0375c4fc87fa9cfd8fbc1c5fcd33c9_cgraph" alt=""/></div>
<map name="batteries_8c_a1f0375c4fc87fa9cfd8fbc1c5fcd33c9_cgraph" id="batteries_8c_a1f0375c4fc87fa9cfd8fbc1c5fcd33c9_cgraph">
<area shape="rect" title="Monitors the Insulation Monitoring Device (IMD). Raises error if IMD reports fault." alt="" coords="5,31,76,57"/>
<area shape="rect" href="imd_driver_8c.html#ac32ede0a3ccf3e67a68ecf2610a5f27a" title=" " alt="" coords="124,5,291,32"/>
<area shape="rect" href="imd_driver_8c.html#a9604fac4bed1c3a28bad1e6be5c7f62c" title=" " alt="" coords="152,56,263,83"/>
<area shape="rect" href="imd_driver_8c.html#af1f048b39ad5d1c58fedb14d8b71ceac" title=" " alt="" coords="379,5,459,32"/>
<area shape="rect" href="imd_driver_8c.html#ae7c47b247d60f019398ac13248a4e13d" title=" " alt="" coords="373,56,466,83"/>
<area shape="rect" href="imd_driver_8c.html#aebd1c3b62e54f80fde0f344a7544f44f" title=" " alt="" coords="339,107,500,133"/>
</map>
</div>

</div>
</div>
<a id="a951b2aac55838c4b1abd243f38e2ca47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a951b2aac55838c4b1abd243f38e2ca47">&#9670;&nbsp;</a></span>initBusVoltagesAndCurrentQueues()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_StatusTypeDef initBusVoltagesAndCurrentQueues </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates queues for HV Bus measurements Queue overwrite, Queue peek, and queue size of 1 is used to ensure only the most recent data is in the queue and read from the queue. Queues use Amps and Volts for units. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8c_a951b2aac55838c4b1abd243f38e2ca47_icgraph.png" border="0" usemap="#batteries_8c_a951b2aac55838c4b1abd243f38e2ca47_icgraph" alt=""/></div>
<map name="batteries_8c_a951b2aac55838c4b1abd243f38e2ca47_icgraph" id="batteries_8c_a951b2aac55838c4b1abd243f38e2ca47_icgraph">
<area shape="rect" title="Creates queues for HV Bus measurements Queue overwrite, Queue peek, and queue size of 1 is used to en..." alt="" coords="119,5,297,47"/>
<area shape="rect" href="user_init_8c.html#a0c5fe2b0843784b74406a16461353491" title=" " alt="" coords="5,13,71,39"/>
</map>
</div>

</div>
</div>
<a id="a92932081ca58208175ca6c4e0971f06d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92932081ca58208175ca6c4e0971f06d">&#9670;&nbsp;</a></span>initPackVoltageQueue()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_StatusTypeDef initPackVoltageQueue </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates the pack voltage queue. Needs to be called before RTOS starts. </p>
<dl class="section return"><dt>Returns</dt><dd>HAL_StatusTypeDef </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8c_a92932081ca58208175ca6c4e0971f06d_icgraph.png" border="0" usemap="#batteries_8c_a92932081ca58208175ca6c4e0971f06d_icgraph" alt=""/></div>
<map name="batteries_8c_a92932081ca58208175ca6c4e0971f06d_icgraph" id="batteries_8c_a92932081ca58208175ca6c4e0971f06d_icgraph">
<area shape="rect" title="Creates the pack voltage queue. Needs to be called before RTOS starts." alt="" coords="119,5,269,32"/>
<area shape="rect" href="user_init_8c.html#a0c5fe2b0843784b74406a16461353491" title=" " alt="" coords="5,5,71,32"/>
</map>
</div>

</div>
</div>
<a id="a34364371025450fc6bc3f0d86df0e5ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34364371025450fc6bc3f0d86df0e5ca">&#9670;&nbsp;</a></span>initVoltageAndTempArrays()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_StatusTypeDef initVoltageAndTempArrays </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This functions sets all cell voltages and temps to known values. This is necessary for testing on Nucleo so it doesn't immediately error before the user can manually set the Voltages and Temperatures. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8c_a34364371025450fc6bc3f0d86df0e5ca_icgraph.png" border="0" usemap="#batteries_8c_a34364371025450fc6bc3f0d86df0e5ca_icgraph" alt=""/></div>
<map name="batteries_8c_a34364371025450fc6bc3f0d86df0e5ca_icgraph" id="batteries_8c_a34364371025450fc6bc3f0d86df0e5ca_icgraph">
<area shape="rect" title="This functions sets all cell voltages and temps to known values. This is necessary for testing on Nuc..." alt="" coords="144,5,320,32"/>
<area shape="rect" href="batteries_8c.html#a3364449b5cc8a93c89985f5d9fa2984b" title="Task to monitor cell voltages and temperatures, as well as perform balance charging." alt="" coords="5,5,96,32"/>
</map>
</div>

</div>
</div>
<a id="aed5d06c4a55e40673204ceacf2fde819"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed5d06c4a55e40673204ceacf2fde819">&#9670;&nbsp;</a></span>map_range_float()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float map_range_float </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>low</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>high</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>low_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>high_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maps a value from one range to another in a linear manner. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">in</td><td>The value to map </td></tr>
    <tr><td class="paramname">low</td><td>low value of in range </td></tr>
    <tr><td class="paramname">high</td><td>high value of in range </td></tr>
    <tr><td class="paramname">low_out</td><td>low value of out range </td></tr>
    <tr><td class="paramname">high_out</td><td>high value of out range</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>in value mapped to out range </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8c_aed5d06c4a55e40673204ceacf2fde819_icgraph.png" border="0" usemap="#batteries_8c_aed5d06c4a55e40673204ceacf2fde819_icgraph" alt=""/></div>
<map name="batteries_8c_aed5d06c4a55e40673204ceacf2fde819_icgraph" id="batteries_8c_aed5d06c4a55e40673204ceacf2fde819_icgraph">
<area shape="rect" title="Maps a value from one range to another in a linear manner." alt="" coords="492,31,611,57"/>
<area shape="rect" href="fan_control_8c.html#af8b63e1141165474f388757d14b73d8d" title=" " alt="" coords="306,5,439,32"/>
<area shape="rect" href="batteries_8c.html#a3d41850a2fe8400978c4f68163d726be" title="Calculates the SoC of a cell from the cell&#39;s voltage." alt="" coords="301,56,444,83"/>
<area shape="rect" href="fan_control_8c.html#a184ee44a7689f1d3d3aec78b7c4a0e01" title=" " alt="" coords="167,5,230,32"/>
<area shape="rect" href="fan_control_8c.html#a34c9fabe6bbdea59eabd8e06a24aee8d" title=" " alt="" coords="17,5,85,32"/>
<area shape="rect" href="batteries_8c.html#a9144cd162ceec3e710baea6601149b43" title="Performs balance charging. For more info, see the BMU page on confluence." alt="" coords="144,56,253,83"/>
<area shape="rect" href="batteries_8c.html#a3364449b5cc8a93c89985f5d9fa2984b" title="Task to monitor cell voltages and temperatures, as well as perform balance charging." alt="" coords="5,56,96,83"/>
</map>
</div>

</div>
</div>
<a id="aa04706789e98d82797970064b10dd0c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa04706789e98d82797970064b10dd0c9">&#9670;&nbsp;</a></span>pauseBalance()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_StatusTypeDef pauseBalance </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stops all cells balancing, but stores which cells were balancing to allowing resuming of balance for cells that were balancing. </p>
<dl class="section return"><dt>Returns</dt><dd>HAL_StatusTypeDef </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8c_aa04706789e98d82797970064b10dd0c9_cgraph.png" border="0" usemap="#batteries_8c_aa04706789e98d82797970064b10dd0c9_cgraph" alt=""/></div>
<map name="batteries_8c_aa04706789e98d82797970064b10dd0c9_cgraph" id="batteries_8c_aa04706789e98d82797970064b10dd0c9_cgraph">
<area shape="rect" title="Stops all cells balancing, but stores which cells were balancing to allowing resuming of balance for ..." alt="" coords="5,53,109,79"/>
<area shape="rect" href="ltc6811_8c.html#a4daa19d51cc618af1f72e0b8094640df" title=" " alt="" coords="157,21,308,47"/>
<area shape="rect" href="batteries_8c.html#ad54912c48ac30fc66796b2aeca58cea7" title="Stops all cells balancing by sending command to AMS boards." alt="" coords="185,78,280,105"/>
<area shape="rect" href="ltc6811_8c.html#a4688fa058fa172d966321d08a57022c8" title=" " alt="" coords="363,5,494,47"/>
<area shape="rect" href="ltc6811_8c.html#a2a661887e71a5361cf40681241c096b4" title=" " alt="" coords="356,71,501,112"/>
<area shape="rect" href="ltc6811_8c.html#a2150f002603baac59966270488687aaa" title=" " alt="" coords="368,151,489,178"/>
<area shape="rect" href="ltc6811_8c.html#ade492dd40b5c05cced4ddfc4dc11e473" title=" " alt="" coords="549,63,721,90"/>
<area shape="rect" href="ltc6811_8c.html#afc4b749b996cce4e7c4cb98f832a0e8b" title=" " alt="" coords="559,115,711,156"/>
<area shape="rect" href="ltc6811_8c.html#ae5189473d88cbc9c95bec62bea119690" title=" " alt="" coords="769,151,869,178"/>
<area shape="rect" href="ltc6811_8c.html#a877fbade1097a0f7a8d92cb1fe140fd4" title=" " alt="" coords="592,231,679,258"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8c_aa04706789e98d82797970064b10dd0c9_icgraph.png" border="0" usemap="#batteries_8c_aa04706789e98d82797970064b10dd0c9_icgraph" alt=""/></div>
<map name="batteries_8c_aa04706789e98d82797970064b10dd0c9_icgraph" id="batteries_8c_aa04706789e98d82797970064b10dd0c9_icgraph">
<area shape="rect" title="Stops all cells balancing, but stores which cells were balancing to allowing resuming of balance for ..." alt="" coords="301,5,405,32"/>
<area shape="rect" href="batteries_8c.html#a9144cd162ceec3e710baea6601149b43" title="Performs balance charging. For more info, see the BMU page on confluence." alt="" coords="144,5,253,32"/>
<area shape="rect" href="batteries_8c.html#a3364449b5cc8a93c89985f5d9fa2984b" title="Task to monitor cell voltages and temperatures, as well as perform balance charging." alt="" coords="5,5,96,32"/>
</map>
</div>

</div>
</div>
<a id="a37d4140213dc1708776032fc935e0b39"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37d4140213dc1708776032fc935e0b39">&#9670;&nbsp;</a></span>publishBusVoltagesAndCurrent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_StatusTypeDef publishBusVoltagesAndCurrent </td>
          <td>(</td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>pIBus</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>pVBus</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>pVBatt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Publishes the most recent HV Bus measurements to queues for other tasks to read from Queue overwrite, Queue peek, and queue size of 1 is used to ensure only the most recent data is in the queue and read from the queue. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pIbus</td><td>pointer to the HV bus current measurement (in Amps) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pVbus</td><td>pointer to the HV bus voltage measurement (in Volts) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pVbatt</td><td>pointer to the HV battery voltage measurement (in Volts) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>HAL_StatusTypeDef </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8c_a37d4140213dc1708776032fc935e0b39_icgraph.png" border="0" usemap="#batteries_8c_a37d4140213dc1708776032fc935e0b39_icgraph" alt=""/></div>
<map name="batteries_8c_a37d4140213dc1708776032fc935e0b39_icgraph" id="batteries_8c_a37d4140213dc1708776032fc935e0b39_icgraph">
<area shape="rect" title="Publishes the most recent HV Bus measurements to queues for other tasks to read from Queue overwrite,..." alt="" coords="172,5,375,32"/>
<area shape="rect" href="batteries_8c.html#a1ef8191389452a8f21cb2d02b20cba29" title=" " alt="" coords="5,5,124,32"/>
</map>
</div>

</div>
</div>
<a id="afa698a16023626be583ce5082c76f5ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa698a16023626be583ce5082c76f5ec">&#9670;&nbsp;</a></span>publishPackVoltage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_StatusTypeDef publishPackVoltage </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>packVoltage</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Publishes the current pack voltage value to the queue for other tasks to read from. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">packVoltage</td><td>The current pack voltage in volts</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>HAL_StatusTypeDef </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8c_afa698a16023626be583ce5082c76f5ec_icgraph.png" border="0" usemap="#batteries_8c_afa698a16023626be583ce5082c76f5ec_icgraph" alt=""/></div>
<map name="batteries_8c_afa698a16023626be583ce5082c76f5ec_icgraph" id="batteries_8c_afa698a16023626be583ce5082c76f5ec_icgraph">
<area shape="rect" title="Publishes the current pack voltage value to the queue for other tasks to read from." alt="" coords="301,31,439,57"/>
<area shape="rect" href="batteries_8c.html#a9144cd162ceec3e710baea6601149b43" title="Performs balance charging. For more info, see the BMU page on confluence." alt="" coords="144,5,253,32"/>
<area shape="rect" href="batteries_8c.html#a3364449b5cc8a93c89985f5d9fa2984b" title="Task to monitor cell voltages and temperatures, as well as perform balance charging." alt="" coords="5,31,96,57"/>
</map>
</div>

</div>
</div>
<a id="a4d72951e5a03e396bb864b5c45bda0f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d72951e5a03e396bb864b5c45bda0f0">&#9670;&nbsp;</a></span>readBusVoltagesAndCurrents()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_StatusTypeDef readBusVoltagesAndCurrents </td>
          <td>(</td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>IBus</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>VBus</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>VBatt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Measures HV voltages and currents using the HV ADC. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">Ibus</td><td>pointer to the HV bus current measurement (in Amps) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">Vbus</td><td>pointer to the HV bus voltage measurement (in Volts) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">Vbatt</td><td>pointer to the HV battery voltage measurement (in Volts)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>HAL_StatusTypeDef </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8c_a4d72951e5a03e396bb864b5c45bda0f0_cgraph.png" border="0" usemap="#batteries_8c_a4d72951e5a03e396bb864b5c45bda0f0_cgraph" alt=""/></div>
<map name="batteries_8c_a4d72951e5a03e396bb864b5c45bda0f0_cgraph" id="batteries_8c_a4d72951e5a03e396bb864b5c45bda0f0_cgraph">
<area shape="rect" title="Measures HV voltages and currents using the HV ADC." alt="" coords="5,81,200,108"/>
<area shape="rect" href="ade7912_8c.html#af0f5c0f7b51bfb3d1644b87f85d3588a" title=" " alt="" coords="248,5,371,32"/>
<area shape="rect" href="ade7912_8c.html#a1a71e3fb2f93c6556b723a1a70e4fa1b" title=" " alt="" coords="261,56,357,83"/>
<area shape="rect" href="ade7912_8c.html#ac933b80dc6a6509a513f4b73b559a78a" title=" " alt="" coords="261,107,357,133"/>
<area shape="rect" href="batteries_8c.html#a1300d8fea84c20d3945380460f61f81d" title="Low pass filters the HV Bus current measurement." alt="" coords="272,157,347,184"/>
<area shape="rect" href="ade7912_8c.html#ac044d42855f65563378bfd5f320571d5" title=" " alt="" coords="419,56,493,83"/>
<area shape="rect" href="ade7912_8c.html#ae3cbdc95c83faf3865265519f8d59859" title=" " alt="" coords="541,56,644,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8c_a4d72951e5a03e396bb864b5c45bda0f0_icgraph.png" border="0" usemap="#batteries_8c_a4d72951e5a03e396bb864b5c45bda0f0_icgraph" alt=""/></div>
<map name="batteries_8c_a4d72951e5a03e396bb864b5c45bda0f0_icgraph" id="batteries_8c_a4d72951e5a03e396bb864b5c45bda0f0_icgraph">
<area shape="rect" title="Measures HV voltages and currents using the HV ADC." alt="" coords="172,5,367,32"/>
<area shape="rect" href="batteries_8c.html#a1ef8191389452a8f21cb2d02b20cba29" title=" " alt="" coords="5,5,124,32"/>
</map>
</div>

</div>
</div>
<a id="a36a3c81e474331b59839cb2f565c7704"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a36a3c81e474331b59839cb2f565c7704">&#9670;&nbsp;</a></span>readCellVoltagesAndTemps()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_StatusTypeDef readCellVoltagesAndTemps </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads the cell voltages and temperatures from the AMS boards. The battery temperature and cell voltages are stored in the global arrays which are also used for sending them over CAN. </p>
<dl class="section return"><dt>Returns</dt><dd>HAL_StatusTypeDef </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8c_a36a3c81e474331b59839cb2f565c7704_cgraph.png" border="0" usemap="#batteries_8c_a36a3c81e474331b59839cb2f565c7704_cgraph" alt=""/></div>
<map name="batteries_8c_a36a3c81e474331b59839cb2f565c7704_cgraph" id="batteries_8c_a36a3c81e474331b59839cb2f565c7704_cgraph">
<area shape="rect" title="Reads the cell voltages and temperatures from the AMS boards. The battery temperature and cell voltag..." alt="" coords="5,247,188,273"/>
<area shape="rect" href="ltc6811_8c.html#a92a5527a207a1a7eab501cb274cfc4ec" title=" " alt="" coords="236,239,395,281"/>
<area shape="rect" href="ltc6811_8c.html#a461bf3185b47d4e5deec0ad8ed3703d5" title=" " alt="" coords="449,205,595,232"/>
<area shape="rect" href="ltc6811_8c.html#a270813547f0f30f31fbc2819ac381c5f" title=" " alt="" coords="443,272,601,299"/>
<area shape="rect" href="ltc6811_8c.html#a04b20b9c3b615110a88ccdf4930c51fd" title=" " alt="" coords="663,181,809,222"/>
<area shape="rect" href="ltc6811_8c.html#a44c47f5c168370dc0bb2f11b1b5cdc31" title=" " alt="" coords="871,29,1013,70"/>
<area shape="rect" href="ltc6811_8c.html#afc4b749b996cce4e7c4cb98f832a0e8b" title=" " alt="" coords="1061,29,1213,70"/>
<area shape="rect" href="ltc6811_8c.html#ad6013027859c0de9b051f6e211e9573b" title=" " alt="" coords="888,145,996,172"/>
<area shape="rect" href="ltc6811_8c.html#a877fbade1097a0f7a8d92cb1fe140fd4" title=" " alt="" coords="1094,297,1181,324"/>
<area shape="rect" href="ltc6811_8c.html#a33a22f924ede7e8772d0b4f56b344c41" title=" " alt="" coords="882,297,1002,324"/>
<area shape="rect" href="ltc6811_8c.html#ad6558a7978dc4e259a559dc105ae4f51" title=" " alt="" coords="1100,399,1175,425"/>
<area shape="rect" href="ltc6811_8c.html#a2150f002603baac59966270488687aaa" title=" " alt="" coords="881,196,1003,223"/>
<area shape="rect" href="ltc6811_8c.html#ae5189473d88cbc9c95bec62bea119690" title=" " alt="" coords="1261,95,1361,121"/>
<area shape="rect" href="ltc6811_8c.html#abb934da9ceb6a1033ecca18dc302ff63" title=" " alt="" coords="1095,95,1180,121"/>
<area shape="rect" href="ltc6811_8c.html#a7f2f9d2ae185730e08b49bb6c76b8456" title=" " alt="" coords="1080,145,1195,172"/>
<area shape="rect" href="ltc6811_8c.html#ad8b550ce6ec58f283e62a96ffc5012e7" title=" " alt="" coords="1100,196,1175,223"/>
<area shape="rect" href="ltc6811_8c.html#ae28ae4cc57cf46a9e442fb231db8425a" title=" " alt="" coords="649,247,823,273"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8c_a36a3c81e474331b59839cb2f565c7704_icgraph.png" border="0" usemap="#batteries_8c_a36a3c81e474331b59839cb2f565c7704_icgraph" alt=""/></div>
<map name="batteries_8c_a36a3c81e474331b59839cb2f565c7704_icgraph" id="batteries_8c_a36a3c81e474331b59839cb2f565c7704_icgraph">
<area shape="rect" title="Reads the cell voltages and temperatures from the AMS boards. The battery temperature and cell voltag..." alt="" coords="301,31,484,57"/>
<area shape="rect" href="batteries_8c.html#a9144cd162ceec3e710baea6601149b43" title="Performs balance charging. For more info, see the BMU page on confluence." alt="" coords="144,5,253,32"/>
<area shape="rect" href="batteries_8c.html#a3364449b5cc8a93c89985f5d9fa2984b" title="Task to monitor cell voltages and temperatures, as well as perform balance charging." alt="" coords="5,31,96,57"/>
</map>
</div>

</div>
</div>
<a id="a82969943d42e6067b966c64c61196dcd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82969943d42e6067b966c64c61196dcd">&#9670;&nbsp;</a></span>resumeBalance()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_StatusTypeDef resumeBalance </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Resumes balancing after call to <a class="el" href="batteries_8c.html#aa04706789e98d82797970064b10dd0c9">pauseBalance</a>. </p>
<dl class="section return"><dt>Returns</dt><dd>HAL_StatusTypeDef </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8c_a82969943d42e6067b966c64c61196dcd_cgraph.png" border="0" usemap="#batteries_8c_a82969943d42e6067b966c64c61196dcd_cgraph" alt=""/></div>
<map name="batteries_8c_a82969943d42e6067b966c64c61196dcd_cgraph" id="batteries_8c_a82969943d42e6067b966c64c61196dcd_cgraph">
<area shape="rect" title="Resumes balancing after call to pauseBalance." alt="" coords="5,68,117,95"/>
<area shape="rect" href="ltc6811_8c.html#a7cf49fe3c9809ef6d0920eb322b640e0" title=" " alt="" coords="165,24,288,51"/>
<area shape="rect" href="ltc6811_8c.html#a2150f002603baac59966270488687aaa" title=" " alt="" coords="166,93,287,120"/>
<area shape="rect" href="ltc6811_8c.html#a195d06cb021b2d6e1c3f6877c7dce697" title=" " alt="" coords="336,5,495,32"/>
<area shape="rect" href="ltc6811_8c.html#afc4b749b996cce4e7c4cb98f832a0e8b" title=" " alt="" coords="339,57,491,98"/>
<area shape="rect" href="ltc6811_8c.html#ae5189473d88cbc9c95bec62bea119690" title=" " alt="" coords="543,93,643,120"/>
<area shape="rect" href="ltc6811_8c.html#a877fbade1097a0f7a8d92cb1fe140fd4" title=" " alt="" coords="372,173,459,200"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8c_a82969943d42e6067b966c64c61196dcd_icgraph.png" border="0" usemap="#batteries_8c_a82969943d42e6067b966c64c61196dcd_icgraph" alt=""/></div>
<map name="batteries_8c_a82969943d42e6067b966c64c61196dcd_icgraph" id="batteries_8c_a82969943d42e6067b966c64c61196dcd_icgraph">
<area shape="rect" title="Resumes balancing after call to pauseBalance." alt="" coords="301,5,413,32"/>
<area shape="rect" href="batteries_8c.html#a9144cd162ceec3e710baea6601149b43" title="Performs balance charging. For more info, see the BMU page on confluence." alt="" coords="144,5,253,32"/>
<area shape="rect" href="batteries_8c.html#a3364449b5cc8a93c89985f5d9fa2984b" title="Task to monitor cell voltages and temperatures, as well as perform balance charging." alt="" coords="5,5,96,32"/>
</map>
</div>

</div>
</div>
<a id="aacf3b5ff9648b813208cb6f91b370fef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aacf3b5ff9648b813208cb6f91b370fef">&#9670;&nbsp;</a></span>setMaxChargeCurrent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_StatusTypeDef setMaxChargeCurrent </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>maxCurrent</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the maximum current for the charger. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">maxCurrent</td><td>The maximum current, in Amps</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>HAL_StatusTypeDef </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8c_aacf3b5ff9648b813208cb6f91b370fef_icgraph.png" border="0" usemap="#batteries_8c_aacf3b5ff9648b813208cb6f91b370fef_icgraph" alt=""/></div>
<map name="batteries_8c_aacf3b5ff9648b813208cb6f91b370fef_icgraph" id="batteries_8c_aacf3b5ff9648b813208cb6f91b370fef_icgraph">
<area shape="rect" title="Sets the maximum current for the charger." alt="" coords="245,5,396,32"/>
<area shape="rect" href="control_state_machine__mock_8c.html#a56cc0ce9d03dc53af6b0adf600b8610c" title=" " alt="" coords="5,5,197,32"/>
</map>
</div>

</div>
</div>
<a id="acd55a62448b408952283c28d12dd4c1d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd55a62448b408952283c28d12dd4c1d">&#9670;&nbsp;</a></span>setSendOnlyOneCell()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setSendOnlyOneCell </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cellIdx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Repeatedly send the cell voltage and temperature for a specific cell. This is instead of the normal behaviour which cycles through all the cells sending a message every <a class="el" href="batteries_8c.html#ab75dbcd7e0a59fc3d1fc3715de87544a">CAN_CELL_SEND_PERIOD_MS</a>. Useful for battery testing to monitor a cell at higher frequency. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cellIdx</td><td>The cell to repeatedly send (note, this uses firmwares 0 based indexing, instead of electricals 1 based indexing of cell numbers) </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8c_acd55a62448b408952283c28d12dd4c1d_icgraph.png" border="0" usemap="#batteries_8c_acd55a62448b408952283c28d12dd4c1d_icgraph" alt=""/></div>
<map name="batteries_8c_acd55a62448b408952283c28d12dd4c1d_icgraph" id="batteries_8c_acd55a62448b408952283c28d12dd4c1d_icgraph">
<area shape="rect" title="Repeatedly send the cell voltage and temperature for a specific cell. This is instead of the normal b..." alt="" coords="187,5,331,32"/>
<area shape="rect" href="control_state_machine__mock_8c.html#a8579cea544ffd2e8b4f8003a928bf189" title=" " alt="" coords="5,5,139,32"/>
</map>
</div>

</div>
</div>
<a id="a43ea41cc1c21bd36b3622076e20b596c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43ea41cc1c21bd36b3622076e20b596c">&#9670;&nbsp;</a></span>startCharging()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_StatusTypeDef startCharging </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sends the maximum charge current and voltage to the charger and waits for the charger to start charging. </p>
<dl class="section return"><dt>Returns</dt><dd>HAL_StatusTypeDef </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8c_a43ea41cc1c21bd36b3622076e20b596c_cgraph.png" border="0" usemap="#batteries_8c_a43ea41cc1c21bd36b3622076e20b596c_cgraph" alt=""/></div>
<map name="batteries_8c_a43ea41cc1c21bd36b3622076e20b596c_cgraph" id="batteries_8c_a43ea41cc1c21bd36b3622076e20b596c_cgraph">
<area shape="rect" title="Sends the maximum charge current and voltage to the charger and waits for the charger to start chargi..." alt="" coords="5,81,105,108"/>
<area shape="rect" href="charger_control_8c.html#a5a2d967359b16e33f7e6631942424a62" title=" " alt="" coords="153,56,339,83"/>
<area shape="rect" href="charger_control_8c.html#a3924dbd41d109e69d729fefb4eae394f" title=" " alt="" coords="394,56,535,83"/>
<area shape="rect" href="charger_control_8c.html#a7be8905ea1fecd563a161d1479f42812" title=" " alt="" coords="387,107,543,133"/>
<area shape="rect" href="_b_m_u__charger__can_8h.html#aed1361c90fff728fcdda8e010dc39a7b" title=" " alt="" coords="591,107,783,133"/>
<area shape="rect" href="_b_m_u__charger__can_8c.html#acd8b3ae6e7b109bda6eb39b1c3bb587d" title=" " alt="" coords="831,5,1037,32"/>
<area shape="rect" href="_b_m_u__charger__can_8c.html#a830d3215e831c9651237cc0e7b494c8e" title=" " alt="" coords="833,56,1035,83"/>
<area shape="rect" href="_b_m_u__charger__can_8c.html#a801381da95855eddaf3a02490e2f1929" title=" " alt="" coords="831,107,1037,133"/>
<area shape="rect" href="_b_m_u__charger__can_8c.html#a4dec07f9486294bef6c03189395f26eb" title=" " alt="" coords="832,157,1036,184"/>
<area shape="rect" href="_b_m_u__charger__can_8c.html#a2c1b47a8d4f9dfcf2ede4c3e93d531a7" title=" " alt="" coords="851,208,1017,235"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8c_a43ea41cc1c21bd36b3622076e20b596c_icgraph.png" border="0" usemap="#batteries_8c_a43ea41cc1c21bd36b3622076e20b596c_icgraph" alt=""/></div>
<map name="batteries_8c_a43ea41cc1c21bd36b3622076e20b596c_icgraph" id="batteries_8c_a43ea41cc1c21bd36b3622076e20b596c_icgraph">
<area shape="rect" title="Sends the maximum charge current and voltage to the charger and waits for the charger to start chargi..." alt="" coords="739,102,839,129"/>
<area shape="rect" href="batteries_8c.html#a9144cd162ceec3e710baea6601149b43" title="Performs balance charging. For more info, see the BMU page on confluence." alt="" coords="144,26,253,53"/>
<area shape="rect" href="charger_control_8h.html#a7be8905ea1fecd563a161d1479f42812" title=" " alt="" coords="535,102,691,129"/>
<area shape="rect" href="batteries_8c.html#a3364449b5cc8a93c89985f5d9fa2984b" title="Task to monitor cell voltages and temperatures, as well as perform balance charging." alt="" coords="5,26,96,53"/>
<area shape="rect" href="batteries_8c.html#a533907b25f7b1dbb355151d336ed9ff6" title="Sends messages to the charger. The charger expects a message every second so this needs to be repeate..." alt="" coords="333,26,455,53"/>
<area shape="rect" href="control_state_machine__mock_8c.html#ae113bdeee54207e1ca5a2d7d0ea4761f" title=" " alt="" coords="305,77,483,104"/>
<area shape="rect" href="charger_control_8h.html#a5a2d967359b16e33f7e6631942424a62" title=" " alt="" coords="301,178,487,205"/>
<area shape="rect" href="batteries_8c.html#a5cf6c235603af078c2dc841ae579f3b5" title="Sends a command to the charger to stop charging." alt="" coords="345,128,443,154"/>
</map>
</div>

</div>
</div>
<a id="ad54912c48ac30fc66796b2aeca58cea7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad54912c48ac30fc66796b2aeca58cea7">&#9670;&nbsp;</a></span>stopBalance()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_StatusTypeDef stopBalance </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stops all cells balancing by sending command to AMS boards. </p>
<dl class="section return"><dt>Returns</dt><dd>HAL_StatusTypeDef </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8c_ad54912c48ac30fc66796b2aeca58cea7_cgraph.png" border="0" usemap="#batteries_8c_ad54912c48ac30fc66796b2aeca58cea7_cgraph" alt=""/></div>
<map name="batteries_8c_ad54912c48ac30fc66796b2aeca58cea7_cgraph" id="batteries_8c_ad54912c48ac30fc66796b2aeca58cea7_cgraph">
<area shape="rect" title="Stops all cells balancing by sending command to AMS boards." alt="" coords="5,64,100,91"/>
<area shape="rect" href="ltc6811_8c.html#a2a661887e71a5361cf40681241c096b4" title=" " alt="" coords="148,13,293,54"/>
<area shape="rect" href="ltc6811_8c.html#a2150f002603baac59966270488687aaa" title=" " alt="" coords="160,93,281,120"/>
<area shape="rect" href="ltc6811_8c.html#ade492dd40b5c05cced4ddfc4dc11e473" title=" " alt="" coords="341,5,513,32"/>
<area shape="rect" href="ltc6811_8c.html#afc4b749b996cce4e7c4cb98f832a0e8b" title=" " alt="" coords="351,57,503,98"/>
<area shape="rect" href="ltc6811_8c.html#ae5189473d88cbc9c95bec62bea119690" title=" " alt="" coords="561,93,661,120"/>
<area shape="rect" href="ltc6811_8c.html#a877fbade1097a0f7a8d92cb1fe140fd4" title=" " alt="" coords="384,173,471,200"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8c_ad54912c48ac30fc66796b2aeca58cea7_icgraph.png" border="0" usemap="#batteries_8c_ad54912c48ac30fc66796b2aeca58cea7_icgraph" alt=""/></div>
<map name="batteries_8c_ad54912c48ac30fc66796b2aeca58cea7_icgraph" id="batteries_8c_ad54912c48ac30fc66796b2aeca58cea7_icgraph">
<area shape="rect" title="Stops all cells balancing by sending command to AMS boards." alt="" coords="453,5,548,32"/>
<area shape="rect" href="batteries_8c.html#a9144cd162ceec3e710baea6601149b43" title="Performs balance charging. For more info, see the BMU page on confluence." alt="" coords="144,5,253,32"/>
<area shape="rect" href="batteries_8c.html#aa04706789e98d82797970064b10dd0c9" title="Stops all cells balancing, but stores which cells were balancing to allowing resuming of balance for ..." alt="" coords="301,31,405,57"/>
<area shape="rect" href="batteries_8c.html#a3364449b5cc8a93c89985f5d9fa2984b" title="Task to monitor cell voltages and temperatures, as well as perform balance charging." alt="" coords="5,5,96,32"/>
</map>
</div>

</div>
</div>
<a id="a5cf6c235603af078c2dc841ae579f3b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5cf6c235603af078c2dc841ae579f3b5">&#9670;&nbsp;</a></span>stopCharging()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_StatusTypeDef stopCharging </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sends a command to the charger to stop charging. </p>
<dl class="section return"><dt>Returns</dt><dd>HAL_StatusTypeDef </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8c_a5cf6c235603af078c2dc841ae579f3b5_cgraph.png" border="0" usemap="#batteries_8c_a5cf6c235603af078c2dc841ae579f3b5_cgraph" alt=""/></div>
<map name="batteries_8c_a5cf6c235603af078c2dc841ae579f3b5_cgraph" id="batteries_8c_a5cf6c235603af078c2dc841ae579f3b5_cgraph">
<area shape="rect" title="Sends a command to the charger to stop charging." alt="" coords="5,208,104,235"/>
<area shape="rect" href="charger_control_8c.html#a7be8905ea1fecd563a161d1479f42812" title=" " alt="" coords="152,208,308,235"/>
<area shape="rect" href="_b_m_u__charger__can_8h.html#aed1361c90fff728fcdda8e010dc39a7b" title=" " alt="" coords="356,132,548,159"/>
<area shape="rect" href="batteries_8c.html#a43ea41cc1c21bd36b3622076e20b596c" title="Sends the maximum charge current and voltage to the charger and waits for the charger to start chargi..." alt="" coords="402,208,502,235"/>
<area shape="rect" href="_b_m_u__charger__can_8c.html#acd8b3ae6e7b109bda6eb39b1c3bb587d" title=" " alt="" coords="596,5,803,32"/>
<area shape="rect" href="_b_m_u__charger__can_8c.html#a830d3215e831c9651237cc0e7b494c8e" title=" " alt="" coords="598,56,801,83"/>
<area shape="rect" href="_b_m_u__charger__can_8c.html#a801381da95855eddaf3a02490e2f1929" title=" " alt="" coords="596,107,803,133"/>
<area shape="rect" href="_b_m_u__charger__can_8c.html#a4dec07f9486294bef6c03189395f26eb" title=" " alt="" coords="597,157,801,184"/>
<area shape="rect" href="_b_m_u__charger__can_8c.html#a2c1b47a8d4f9dfcf2ede4c3e93d531a7" title=" " alt="" coords="616,208,783,235"/>
<area shape="rect" href="charger_control_8c.html#a5a2d967359b16e33f7e6631942424a62" title=" " alt="" coords="607,259,792,285"/>
<area shape="rect" href="charger_control_8c.html#a3924dbd41d109e69d729fefb4eae394f" title=" " alt="" coords="851,259,992,285"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8c_a5cf6c235603af078c2dc841ae579f3b5_icgraph.png" border="0" usemap="#batteries_8c_a5cf6c235603af078c2dc841ae579f3b5_icgraph" alt=""/></div>
<map name="batteries_8c_a5cf6c235603af078c2dc841ae579f3b5_icgraph" id="batteries_8c_a5cf6c235603af078c2dc841ae579f3b5_icgraph">
<area shape="rect" title="Sends a command to the charger to stop charging." alt="" coords="301,5,400,32"/>
<area shape="rect" href="batteries_8c.html#a9144cd162ceec3e710baea6601149b43" title="Performs balance charging. For more info, see the BMU page on confluence." alt="" coords="144,5,253,32"/>
<area shape="rect" href="batteries_8c.html#a3364449b5cc8a93c89985f5d9fa2984b" title="Task to monitor cell voltages and temperatures, as well as perform balance charging." alt="" coords="5,5,96,32"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="aa95731d4ff40893bc5d4c80cc0fa055f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa95731d4ff40893bc5d4c80cc0fa055f">&#9670;&nbsp;</a></span>BatteryTaskHandle</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">osThreadId BatteryTaskHandle</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a45eac5b187ae199e0de1fa376e2024b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45eac5b187ae199e0de1fa376e2024b3">&#9670;&nbsp;</a></span>cellToSend</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cellToSend</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="afa99b901194e86a7784f6213f9420089"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa99b901194e86a7784f6213f9420089">&#9670;&nbsp;</a></span>cellVoltagesFiltered</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float cellVoltagesFiltered[<a class="el" href="_b_m_u__can_8h.html#ab438e1bff44c116778101ab624f3359f">VOLTAGECELL_COUNT</a>]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Array is used to store the filtered voltages. </p>

</div>
</div>
<a id="af01c96d690887303a5e5d5432739801a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af01c96d690887303a5e5d5432739801a">&#9670;&nbsp;</a></span>errorCounter</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t errorCounter = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a141159dacb84bda6d1ce0a156c258177"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a141159dacb84bda6d1ce0a156c258177">&#9670;&nbsp;</a></span>IBusQueue</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">QueueHandle_t IBusQueue</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Queue holding most recent bus current measurement. </p>

</div>
</div>
<a id="a58c53a03f6ed59b66477d9ff778a7ec1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58c53a03f6ed59b66477d9ff778a7ec1">&#9670;&nbsp;</a></span>isCellBalancing</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool isCellBalancing[<a class="el" href="_b_m_u__can_8h.html#ab438e1bff44c116778101ab624f3359f">VOLTAGECELL_COUNT</a>] = {0}</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Array to store if a cell is balancing. </p>

</div>
</div>
<a id="a4bb357024aa0bb23dcfba57009d3f836"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4bb357024aa0bb23dcfba57009d3f836">&#9670;&nbsp;</a></span>isTempCellWorking</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool isTempCellWorking[<a class="el" href="_b_m_u__can_8h.html#aa1408c5c3cd5903a4d88611eabf5ce4c">TEMPCELL_COUNT</a>]</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">true , true , true , <span class="keyword">false</span>, true , true , true , true , true , true , <span class="keyword">false</span>, <span class="keyword">false</span>,</div>
<div class="line"> </div>
<div class="line">true , true , true , <span class="keyword">false</span>, true , true , true , true , true , true , <span class="keyword">false</span>, <span class="keyword">false</span>,</div>
<div class="line"> </div>
<div class="line">true , true , <span class="keyword">false</span>, <span class="keyword">false</span>, true , <span class="keyword">false</span>, <span class="keyword">false</span>, true , true , <span class="keyword">false</span>, true , true ,</div>
<div class="line"> </div>
<div class="line"><span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>,</div>
<div class="line"> </div>
<div class="line"><span class="keyword">false</span>, true , true , <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, true , true , true , <span class="keyword">false</span>, <span class="keyword">false</span>,</div>
<div class="line"> </div>
<div class="line"><span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>,</div>
<div class="line">}</div>
</div><!-- fragment --><p>Since some thermistors don't give accurate readings (as of June 2020 not sure why, but maybe due to bad mechanical connections) this array specifies which temperature readings are working. The working readings are the only ones checked to ensure they are within safe limits and to determine min and max temperatures. </p>

</div>
</div>
<a id="a098ac94ec41c0b74569366cf7660c680"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a098ac94ec41c0b74569366cf7660c680">&#9670;&nbsp;</a></span>maxChargeCurrent</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float maxChargeCurrent = <a class="el" href="batteries_8c.html#a68aaf77b085834ea0c03a6ab2e2910f6">CHARGE_DEFAULT_MAX_CURRENT</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Charging current limit. </p>

</div>
</div>
<a id="a1e19984c8df58b545da1c8f8b5547acd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e19984c8df58b545da1c8f8b5547acd">&#9670;&nbsp;</a></span>maxChargeVoltage</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float maxChargeVoltage = <a class="el" href="batteries_8c.html#aa4b530cc846953d732a4582912f703d2">LIMIT_OVERVOLTAGE</a> * <a class="el" href="_b_m_u__can_8h.html#ab438e1bff44c116778101ab624f3359f">VOLTAGECELL_COUNT</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Charging voltage limit to be sent to charger. Charging is actually stopped based on min cell SoC as specified by <a class="el" href="batteries_8c.html#a1c3f97f617827a946894da14b7e6e4d4">CHARGE_STOP_SOC</a> </p>

</div>
</div>
<a id="a17c95138c88cf1a7a64a0dd006730b6c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17c95138c88cf1a7a64a0dd006730b6c">&#9670;&nbsp;</a></span>PackVoltageQueue</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">QueueHandle_t PackVoltageQueue</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Queue holding most recent battery voltage (calculated from sum of cell voltages) measurement. </p>

</div>
</div>
<a id="a08165bcd985456a8bb4f39d29b0132d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08165bcd985456a8bb4f39d29b0132d8">&#9670;&nbsp;</a></span>sendOneCellVoltAndTemp</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool sendOneCellVoltAndTemp = false</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ad64f368c4f439a41338c59c0c4b685e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad64f368c4f439a41338c59c0c4b685e2">&#9670;&nbsp;</a></span>VBattQueue</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">QueueHandle_t VBattQueue</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Queue holding most recent battery voltage measurement. </p>

</div>
</div>
<a id="abafdcf601bccb3238fcb8534b517d130"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abafdcf601bccb3238fcb8534b517d130">&#9670;&nbsp;</a></span>VBusQueue</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">QueueHandle_t VBusQueue</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Queue holding most recent bus volage measurement. </p>

</div>
</div>
<a id="ab483cabe57068f7e0fd4bcaee6c1fb59"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab483cabe57068f7e0fd4bcaee6c1fb59">&#9670;&nbsp;</a></span>voltageToSOCLookup</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float voltageToSOCLookup[<a class="el" href="batteries_8c.html#a4ec6365ec832a79d6e0633c4f49b3b55">NUM_SOC_LOOKUP_VALS</a>]</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">   0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,</div>
<div class="line">   21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,</div>
<div class="line">   41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,</div>
<div class="line">   61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,</div>
<div class="line">   81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100</div>
<div class="line">}</div>
</div><!-- fragment --><p>Lookup table to convert cell voltage to cell state of charge. See BMU confluence page for more info </p>

</div>
</div>
<a id="a61bd11f0a0377192a9a1950e18664728"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61bd11f0a0377192a9a1950e18664728">&#9670;&nbsp;</a></span>warningSentForCellTemp</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool warningSentForCellTemp[<a class="el" href="_b_m_u__can_8h.html#aa1408c5c3cd5903a4d88611eabf5ce4c">TEMPCELL_COUNT</a>]</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set to true if we've already sent a high temperature warning for this cell to stop repeated warnings being sent. Reset to false on init or when cell voltage increases above high temperature warning limit </p>

</div>
</div>
<a id="afeb7e3ce5be75e8a7d03ae9bbc3c2150"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afeb7e3ce5be75e8a7d03ae9bbc3c2150">&#9670;&nbsp;</a></span>warningSentForCellVoltage</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool warningSentForCellVoltage[<a class="el" href="_b_m_u__can_8h.html#ab438e1bff44c116778101ab624f3359f">VOLTAGECELL_COUNT</a>]</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set to true if we've already sent a low voltage warning for this cell to stop repeated warnings being sent. Reset to false on init or when cell voltage increases above low voltage warning limit </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.18
</small></address>
</body>
</html>
