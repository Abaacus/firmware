<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>BMU: /Users/Richard/Documents/Waterloo/WFE/Code.nosync/2018_bmu-2/Inc/batteries.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">BMU
   </div>
   <div id="projectbrief">BatteryManagementUnit</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_f93dfce691d792349f1c14ede440e2e6.html">Inc</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">batteries.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;FreeRTOS.h&quot;</code><br />
<code>#include &quot;queue.h&quot;</code><br />
<code>#include &quot;<a class="el" href="bsp_8h_source.html">bsp.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for batteries.h:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8h__incl.png" border="0" usemap="#_2_users_2_richard_2_documents_2_waterloo_2_w_f_e_2_code_8nosync_22018__bmu-2_2_inc_2batteries_8h" alt=""/></div>
<map name="_2_users_2_richard_2_documents_2_waterloo_2_w_f_e_2_code_8nosync_22018__bmu-2_2_inc_2batteries_8h" id="_2_users_2_richard_2_documents_2_waterloo_2_w_f_e_2_code_8nosync_22018__bmu-2_2_inc_2batteries_8h">
<area shape="rect" title=" " alt="" coords="139,5,331,61"/>
<area shape="rect" title=" " alt="" coords="81,109,177,136"/>
<area shape="rect" title=" " alt="" coords="201,109,269,136"/>
<area shape="rect" href="bsp_8h.html" title="Board support package (BSP) header file." alt="" coords="293,109,348,136"/>
<area shape="rect" title=" " alt="" coords="5,184,105,211"/>
<area shape="rect" title=" " alt="" coords="130,184,191,211"/>
<area shape="rect" title=" " alt="" coords="216,184,271,211"/>
<area shape="rect" title=" " alt="" coords="295,184,346,211"/>
<area shape="rect" title=" " alt="" coords="370,184,445,211"/>
<area shape="rect" title=" " alt="" coords="469,184,529,211"/>
<area shape="rect" title=" " alt="" coords="553,184,616,211"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8h__dep__incl.png" border="0" usemap="#_2_users_2_richard_2_documents_2_waterloo_2_w_f_e_2_code_8nosync_22018__bmu-2_2_inc_2batteries_8hdep" alt=""/></div>
<map name="_2_users_2_richard_2_documents_2_waterloo_2_w_f_e_2_code_8nosync_22018__bmu-2_2_inc_2batteries_8hdep" id="_2_users_2_richard_2_documents_2_waterloo_2_w_f_e_2_code_8nosync_22018__bmu-2_2_inc_2batteries_8hdep">
<area shape="rect" title=" " alt="" coords="687,5,879,61"/>
<area shape="rect" href="batteries_8c.html" title="Battery Monitoring, Charging, HV Bus Sense, IMD monitor." alt="" coords="5,109,197,165"/>
<area shape="rect" href="control_state_machine_8c.html" title="State machine controlling BMU&#39;s high level logic." alt="" coords="222,109,477,165"/>
<area shape="rect" href="control_state_machine__mock_8c.html" title="Module containing CLI commands for the BMU." alt="" coords="501,109,795,165"/>
<area shape="rect" href="fan_control_8c.html" title="Module controlling battery pack fans." alt="" coords="819,109,1015,165"/>
<area shape="rect" href="precharge_discharge_8c.html" title="Controls the precharge and dishcarge procedures of the HV bus." alt="" coords="1039,109,1291,165"/>
<area shape="rect" href="user_init_8c.html" title="Initialization before RTOS starts." alt="" coords="1316,109,1508,165"/>
</map>
</div>
</div>
<p><a href="batteries_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:aca152be2322f2c62c655e2a234c88fd3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8h.html#aca152be2322f2c62c655e2a234c88fd3">CELL_MAX_TEMP_C</a>&#160;&#160;&#160;(60.0)</td></tr>
<tr class="separator:aca152be2322f2c62c655e2a234c88fd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:afafd4ab2db0429aabc15e408fcaad454"><td class="memItemLeft" align="right" valign="top">typedef enum <a class="el" href="batteries_8h.html#aa5cc81ab95f71f17129ffd163d038c6e">Charge_Notifications_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8h.html#afafd4ab2db0429aabc15e408fcaad454">Charge_Notifications_t</a></td></tr>
<tr class="separator:afafd4ab2db0429aabc15e408fcaad454"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:aa5cc81ab95f71f17129ffd163d038c6e"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8h.html#aa5cc81ab95f71f17129ffd163d038c6e">Charge_Notifications_t</a> { <a class="el" href="batteries_8h.html#aa5cc81ab95f71f17129ffd163d038c6eaa00db7f1f8038fc1f7b12f36c4b29bcd">CHARGE_START_NOTIFICATION</a>, 
<a class="el" href="batteries_8h.html#aa5cc81ab95f71f17129ffd163d038c6ea183c1400a97f7c19bd0dc48b0486c440">CHARGE_STOP_NOTIFICATION</a>
 }</td></tr>
<tr class="separator:aa5cc81ab95f71f17129ffd163d038c6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a0ee7fbdeb8e2e8413b4fc77ba59223d5"><td class="memItemLeft" align="right" valign="top">HAL_StatusTypeDef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8h.html#a0ee7fbdeb8e2e8413b4fc77ba59223d5">getIBus</a> (float *IBus)</td></tr>
<tr class="memdesc:a0ee7fbdeb8e2e8413b4fc77ba59223d5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the most recent bus current reading.  <a href="batteries_8h.html#a0ee7fbdeb8e2e8413b4fc77ba59223d5">More...</a><br /></td></tr>
<tr class="separator:a0ee7fbdeb8e2e8413b4fc77ba59223d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff30116cb629c2efdad61c2ccaec0c36"><td class="memItemLeft" align="right" valign="top">HAL_StatusTypeDef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8h.html#aff30116cb629c2efdad61c2ccaec0c36">getVBatt</a> (float *VBatt)</td></tr>
<tr class="memdesc:aff30116cb629c2efdad61c2ccaec0c36"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the most recent battery voltage reading (from the HV ADC). Note: this is only equal to the battery voltage when both contactors are closed. to get the battery voltage in all times, use <a class="el" href="batteries_8h.html#ab07aef73f633627b5a1a78e40f15961f">getPackVoltage</a>.  <a href="batteries_8h.html#aff30116cb629c2efdad61c2ccaec0c36">More...</a><br /></td></tr>
<tr class="separator:aff30116cb629c2efdad61c2ccaec0c36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6fbf3bf910348af26a580fc418f89f5e"><td class="memItemLeft" align="right" valign="top">HAL_StatusTypeDef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8h.html#a6fbf3bf910348af26a580fc418f89f5e">getVBus</a> (float *VBus)</td></tr>
<tr class="memdesc:a6fbf3bf910348af26a580fc418f89f5e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the most recent HV Bus voltage reading (from the HV ADC)  <a href="batteries_8h.html#a6fbf3bf910348af26a580fc418f89f5e">More...</a><br /></td></tr>
<tr class="separator:a6fbf3bf910348af26a580fc418f89f5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a951b2aac55838c4b1abd243f38e2ca47"><td class="memItemLeft" align="right" valign="top">HAL_StatusTypeDef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8h.html#a951b2aac55838c4b1abd243f38e2ca47">initBusVoltagesAndCurrentQueues</a> ()</td></tr>
<tr class="memdesc:a951b2aac55838c4b1abd243f38e2ca47"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates queues for HV Bus measurements Queue overwrite, Queue peek, and queue size of 1 is used to ensure only the most recent data is in the queue and read from the queue. Queues use Amps and Volts for units.  <a href="batteries_8h.html#a951b2aac55838c4b1abd243f38e2ca47">More...</a><br /></td></tr>
<tr class="separator:a951b2aac55838c4b1abd243f38e2ca47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaacb3ffbd5367bbde01d4e8120fdbea0"><td class="memItemLeft" align="right" valign="top">HAL_StatusTypeDef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8h.html#aaacb3ffbd5367bbde01d4e8120fdbea0">balance_cell</a> (int cell, bool set)</td></tr>
<tr class="memdesc:aaacb3ffbd5367bbde01d4e8120fdbea0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Control the balance state of an individual cell. NB: this is inneficient if balancing multiple cells, as he entire balance config is sent to the AMS boards every time this is called. Instead, use the lower level batt_balance_cell/batt_stop_balance_cell to change state for all cells, then call batt_write_config to send the new balance config.  <a href="batteries_8h.html#aaacb3ffbd5367bbde01d4e8120fdbea0">More...</a><br /></td></tr>
<tr class="separator:aaacb3ffbd5367bbde01d4e8120fdbea0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab07aef73f633627b5a1a78e40f15961f"><td class="memItemLeft" align="right" valign="top">HAL_StatusTypeDef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8h.html#ab07aef73f633627b5a1a78e40f15961f">getPackVoltage</a> (float *packVoltage)</td></tr>
<tr class="memdesc:ab07aef73f633627b5a1a78e40f15961f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the current pack voltage. This returns the pack voltage as calculated by summing all the cell voltages.  <a href="batteries_8h.html#ab07aef73f633627b5a1a78e40f15961f">More...</a><br /></td></tr>
<tr class="separator:ab07aef73f633627b5a1a78e40f15961f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92932081ca58208175ca6c4e0971f06d"><td class="memItemLeft" align="right" valign="top">HAL_StatusTypeDef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8h.html#a92932081ca58208175ca6c4e0971f06d">initPackVoltageQueue</a> ()</td></tr>
<tr class="memdesc:a92932081ca58208175ca6c4e0971f06d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates the pack voltage queue. Needs to be called before RTOS starts.  <a href="batteries_8h.html#a92932081ca58208175ca6c4e0971f06d">More...</a><br /></td></tr>
<tr class="separator:a92932081ca58208175ca6c4e0971f06d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed5d06c4a55e40673204ceacf2fde819"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8h.html#aed5d06c4a55e40673204ceacf2fde819">map_range_float</a> (float in, float low, float high, float low_out, float high_out)</td></tr>
<tr class="memdesc:aed5d06c4a55e40673204ceacf2fde819"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maps a value from one range to another in a linear manner.  <a href="batteries_8h.html#aed5d06c4a55e40673204ceacf2fde819">More...</a><br /></td></tr>
<tr class="separator:aed5d06c4a55e40673204ceacf2fde819"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacf3b5ff9648b813208cb6f91b370fef"><td class="memItemLeft" align="right" valign="top">HAL_StatusTypeDef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8h.html#aacf3b5ff9648b813208cb6f91b370fef">setMaxChargeCurrent</a> (float maxCurrent)</td></tr>
<tr class="memdesc:aacf3b5ff9648b813208cb6f91b370fef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the maximum current for the charger.  <a href="batteries_8h.html#aacf3b5ff9648b813208cb6f91b370fef">More...</a><br /></td></tr>
<tr class="separator:aacf3b5ff9648b813208cb6f91b370fef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd55a62448b408952283c28d12dd4c1d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8h.html#acd55a62448b408952283c28d12dd4c1d">setSendOnlyOneCell</a> (int cellIdx)</td></tr>
<tr class="memdesc:acd55a62448b408952283c28d12dd4c1d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Repeatedly send the cell voltage and temperature for a specific cell. This is instead of the normal behaviour which cycles through all the cells sending a message every <a class="el" href="batteries_8c.html#ab75dbcd7e0a59fc3d1fc3715de87544a">CAN_CELL_SEND_PERIOD_MS</a>. Useful for battery testing to monitor a cell at higher frequency.  <a href="batteries_8h.html#acd55a62448b408952283c28d12dd4c1d">More...</a><br /></td></tr>
<tr class="separator:acd55a62448b408952283c28d12dd4c1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade4720060f19979c4071eae3fb08ff92"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8h.html#ade4720060f19979c4071eae3fb08ff92">clearSendOnlyOneCell</a> ()</td></tr>
<tr class="memdesc:ade4720060f19979c4071eae3fb08ff92"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stop sending only one cell repeatedly, and go back to sending all cells over CAN.  <a href="batteries_8h.html#ade4720060f19979c4071eae3fb08ff92">More...</a><br /></td></tr>
<tr class="separator:ade4720060f19979c4071eae3fb08ff92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e1bc0d2209bd309c4db0a06009a339a"><td class="memItemLeft" align="right" valign="top">HAL_StatusTypeDef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8h.html#a6e1bc0d2209bd309c4db0a06009a339a">cliSetVBatt</a> (float VBatt)</td></tr>
<tr class="memdesc:a6e1bc0d2209bd309c4db0a06009a339a"><td class="mdescLeft">&#160;</td><td class="mdescRight">For nucleo testing, allows setting a dummy value for the VBatt reading.  <a href="batteries_8h.html#a6e1bc0d2209bd309c4db0a06009a339a">More...</a><br /></td></tr>
<tr class="separator:a6e1bc0d2209bd309c4db0a06009a339a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ab7e555695e672e38894f394a31a3ef"><td class="memItemLeft" align="right" valign="top">HAL_StatusTypeDef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8h.html#a2ab7e555695e672e38894f394a31a3ef">cliSetVBus</a> (float VBus)</td></tr>
<tr class="memdesc:a2ab7e555695e672e38894f394a31a3ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">For nucleo testing, allows setting a dummy value for the VBus reading.  <a href="batteries_8h.html#a2ab7e555695e672e38894f394a31a3ef">More...</a><br /></td></tr>
<tr class="separator:a2ab7e555695e672e38894f394a31a3ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19d5fb02c3547746d76a121bf9f10807"><td class="memItemLeft" align="right" valign="top">HAL_StatusTypeDef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="batteries_8h.html#a19d5fb02c3547746d76a121bf9f10807">cliSetIBus</a> (float IBus)</td></tr>
<tr class="memdesc:a19d5fb02c3547746d76a121bf9f10807"><td class="mdescLeft">&#160;</td><td class="mdescRight">For nucleo testing, allows setting a dummy value for the IBus reading.  <a href="batteries_8h.html#a19d5fb02c3547746d76a121bf9f10807">More...</a><br /></td></tr>
<tr class="separator:a19d5fb02c3547746d76a121bf9f10807"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="aca152be2322f2c62c655e2a234c88fd3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca152be2322f2c62c655e2a234c88fd3">&#9670;&nbsp;</a></span>CELL_MAX_TEMP_C</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CELL_MAX_TEMP_C&#160;&#160;&#160;(60.0)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="afafd4ab2db0429aabc15e408fcaad454"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afafd4ab2db0429aabc15e408fcaad454">&#9670;&nbsp;</a></span>Charge_Notifications_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef enum <a class="el" href="batteries_8h.html#aa5cc81ab95f71f17129ffd163d038c6e">Charge_Notifications_t</a> <a class="el" href="batteries_8h.html#aa5cc81ab95f71f17129ffd163d038c6e">Charge_Notifications_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="aa5cc81ab95f71f17129ffd163d038c6e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5cc81ab95f71f17129ffd163d038c6e">&#9670;&nbsp;</a></span>Charge_Notifications_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="batteries_8h.html#aa5cc81ab95f71f17129ffd163d038c6e">Charge_Notifications_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="aa5cc81ab95f71f17129ffd163d038c6eaa00db7f1f8038fc1f7b12f36c4b29bcd"></a>CHARGE_START_NOTIFICATION&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aa5cc81ab95f71f17129ffd163d038c6ea183c1400a97f7c19bd0dc48b0486c440"></a>CHARGE_STOP_NOTIFICATION&#160;</td><td class="fielddoc"></td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="aaacb3ffbd5367bbde01d4e8120fdbea0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaacb3ffbd5367bbde01d4e8120fdbea0">&#9670;&nbsp;</a></span>balance_cell()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_StatusTypeDef balance_cell </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>set</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Control the balance state of an individual cell. NB: this is inneficient if balancing multiple cells, as he entire balance config is sent to the AMS boards every time this is called. Instead, use the lower level batt_balance_cell/batt_stop_balance_cell to change state for all cells, then call batt_write_config to send the new balance config. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cell</td><td>The cell to change the balance state of </td></tr>
    <tr><td class="paramname">set</td><td>True if should balance cell</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>HAL_StatusTypeDef </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8h_aaacb3ffbd5367bbde01d4e8120fdbea0_cgraph.png" border="0" usemap="#batteries_8h_aaacb3ffbd5367bbde01d4e8120fdbea0_cgraph" alt=""/></div>
<map name="batteries_8h_aaacb3ffbd5367bbde01d4e8120fdbea0_cgraph" id="batteries_8h_aaacb3ffbd5367bbde01d4e8120fdbea0_cgraph">
<area shape="rect" title="Control the balance state of an individual cell. NB: this is inneficient if balancing multiple cells,..." alt="" coords="5,56,100,83"/>
<area shape="rect" href="ltc6811_8c.html#a7cf49fe3c9809ef6d0920eb322b640e0" title=" " alt="" coords="164,5,287,32"/>
<area shape="rect" href="ltc6811_8c.html#a265419e3399d2e64f36eba3e266ca7ed" title=" " alt="" coords="148,56,303,83"/>
<area shape="rect" href="ltc6811_8c.html#a2150f002603baac59966270488687aaa" title=" " alt="" coords="165,144,286,171"/>
<area shape="rect" href="ltc6811_8c.html#a195d06cb021b2d6e1c3f6877c7dce697" title=" " alt="" coords="357,5,516,32"/>
<area shape="rect" href="ltc6811_8c.html#ade492dd40b5c05cced4ddfc4dc11e473" title=" " alt="" coords="351,56,523,83"/>
<area shape="rect" href="ltc6811_8c.html#afc4b749b996cce4e7c4cb98f832a0e8b" title=" " alt="" coords="361,107,513,149"/>
<area shape="rect" href="ltc6811_8c.html#ae5189473d88cbc9c95bec62bea119690" title=" " alt="" coords="571,144,671,171"/>
<area shape="rect" href="ltc6811_8c.html#a877fbade1097a0f7a8d92cb1fe140fd4" title=" " alt="" coords="393,224,480,251"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8h_aaacb3ffbd5367bbde01d4e8120fdbea0_icgraph.png" border="0" usemap="#batteries_8h_aaacb3ffbd5367bbde01d4e8120fdbea0_icgraph" alt=""/></div>
<map name="batteries_8h_aaacb3ffbd5367bbde01d4e8120fdbea0_icgraph" id="batteries_8h_aaacb3ffbd5367bbde01d4e8120fdbea0_icgraph">
<area shape="rect" title="Control the balance state of an individual cell. NB: this is inneficient if balancing multiple cells,..." alt="" coords="204,5,299,32"/>
<area shape="rect" href="control_state_machine__mock_8c.html#a1ff8bdf04d048eab40c9b97f42dc0c23" title=" " alt="" coords="5,5,156,32"/>
</map>
</div>

</div>
</div>
<a id="ade4720060f19979c4071eae3fb08ff92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade4720060f19979c4071eae3fb08ff92">&#9670;&nbsp;</a></span>clearSendOnlyOneCell()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void clearSendOnlyOneCell </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stop sending only one cell repeatedly, and go back to sending all cells over CAN. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8h_ade4720060f19979c4071eae3fb08ff92_icgraph.png" border="0" usemap="#batteries_8h_ade4720060f19979c4071eae3fb08ff92_icgraph" alt=""/></div>
<map name="batteries_8h_ade4720060f19979c4071eae3fb08ff92_icgraph" id="batteries_8h_ade4720060f19979c4071eae3fb08ff92_icgraph">
<area shape="rect" title="Stop sending only one cell repeatedly, and go back to sending all cells over CAN." alt="" coords="213,5,368,32"/>
<area shape="rect" href="control_state_machine__mock_8c.html#a07f875c96434a4f6c4a2362b3cd71ec4" title=" " alt="" coords="5,5,165,32"/>
</map>
</div>

</div>
</div>
<a id="a19d5fb02c3547746d76a121bf9f10807"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19d5fb02c3547746d76a121bf9f10807">&#9670;&nbsp;</a></span>cliSetIBus()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_StatusTypeDef cliSetIBus </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>IBus</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>For nucleo testing, allows setting a dummy value for the IBus reading. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">IBus</td><td>The value to set for IBus, in volts</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>HAL_StatusTypeDef </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8h_a19d5fb02c3547746d76a121bf9f10807_icgraph.png" border="0" usemap="#batteries_8h_a19d5fb02c3547746d76a121bf9f10807_icgraph" alt=""/></div>
<map name="batteries_8h_a19d5fb02c3547746d76a121bf9f10807_icgraph" id="batteries_8h_a19d5fb02c3547746d76a121bf9f10807_icgraph">
<area shape="rect" title="For nucleo testing, allows setting a dummy value for the IBus reading." alt="" coords="317,31,400,57"/>
<area shape="rect" href="control_state_machine__mock_8c.html#ae589dd0ff2c7eef372eda76de2c820de" title=" " alt="" coords="161,5,227,32"/>
<area shape="rect" href="control_state_machine__mock_8h.html#a814694b73a579d4576140f0ff7582510" title=" " alt="" coords="119,56,269,83"/>
<area shape="rect" href="user_init_8c.html#a0c5fe2b0843784b74406a16461353491" title=" " alt="" coords="5,56,71,83"/>
</map>
</div>

</div>
</div>
<a id="a6e1bc0d2209bd309c4db0a06009a339a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e1bc0d2209bd309c4db0a06009a339a">&#9670;&nbsp;</a></span>cliSetVBatt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_StatusTypeDef cliSetVBatt </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>VBatt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>For nucleo testing, allows setting a dummy value for the VBatt reading. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VBatt</td><td>The value to set for VBatt, in volts</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>HAL_StatusTypeDef </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8h_a6e1bc0d2209bd309c4db0a06009a339a_icgraph.png" border="0" usemap="#batteries_8h_a6e1bc0d2209bd309c4db0a06009a339a_icgraph" alt=""/></div>
<map name="batteries_8h_a6e1bc0d2209bd309c4db0a06009a339a_icgraph" id="batteries_8h_a6e1bc0d2209bd309c4db0a06009a339a_icgraph">
<area shape="rect" title="For nucleo testing, allows setting a dummy value for the VBatt reading." alt="" coords="317,31,405,57"/>
<area shape="rect" href="control_state_machine__mock_8c.html#a0dda484881d82c63b656ecae468da7cd" title=" " alt="" coords="157,5,231,32"/>
<area shape="rect" href="control_state_machine__mock_8h.html#a814694b73a579d4576140f0ff7582510" title=" " alt="" coords="119,56,269,83"/>
<area shape="rect" href="user_init_8c.html#a0c5fe2b0843784b74406a16461353491" title=" " alt="" coords="5,56,71,83"/>
</map>
</div>

</div>
</div>
<a id="a2ab7e555695e672e38894f394a31a3ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ab7e555695e672e38894f394a31a3ef">&#9670;&nbsp;</a></span>cliSetVBus()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_StatusTypeDef cliSetVBus </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>VBus</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>For nucleo testing, allows setting a dummy value for the VBus reading. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VBus</td><td>The value to set for VBus, in volts</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>HAL_StatusTypeDef </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8h_a2ab7e555695e672e38894f394a31a3ef_icgraph.png" border="0" usemap="#batteries_8h_a2ab7e555695e672e38894f394a31a3ef_icgraph" alt=""/></div>
<map name="batteries_8h_a2ab7e555695e672e38894f394a31a3ef_icgraph" id="batteries_8h_a2ab7e555695e672e38894f394a31a3ef_icgraph">
<area shape="rect" title="For nucleo testing, allows setting a dummy value for the VBus reading." alt="" coords="317,31,404,57"/>
<area shape="rect" href="control_state_machine__mock_8c.html#a675e2d9a32917c7ea848a381b54608a4" title=" " alt="" coords="158,5,230,32"/>
<area shape="rect" href="control_state_machine__mock_8h.html#a814694b73a579d4576140f0ff7582510" title=" " alt="" coords="119,56,269,83"/>
<area shape="rect" href="user_init_8c.html#a0c5fe2b0843784b74406a16461353491" title=" " alt="" coords="5,56,71,83"/>
</map>
</div>

</div>
</div>
<a id="a0ee7fbdeb8e2e8413b4fc77ba59223d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ee7fbdeb8e2e8413b4fc77ba59223d5">&#9670;&nbsp;</a></span>getIBus()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_StatusTypeDef getIBus </td>
          <td>(</td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>IBus</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the most recent bus current reading. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">IBus</td><td>pointer to a float to store the IBus reading, in amps</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>HAL_StatusTypeDef </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8h_a0ee7fbdeb8e2e8413b4fc77ba59223d5_icgraph.png" border="0" usemap="#batteries_8h_a0ee7fbdeb8e2e8413b4fc77ba59223d5_icgraph" alt=""/></div>
<map name="batteries_8h_a0ee7fbdeb8e2e8413b4fc77ba59223d5_icgraph" id="batteries_8h_a0ee7fbdeb8e2e8413b4fc77ba59223d5_icgraph">
<area shape="rect" title="Get the most recent bus current reading." alt="" coords="585,59,652,86"/>
<area shape="rect" href="precharge_discharge_8c.html#aeb4682e026fd4f795f52338469d54915" title="Discharges HV Bus. Opens contactors which connects in discharge resistor to discharge bus voltage...." alt="" coords="259,84,337,111"/>
<area shape="rect" href="control_state_machine__mock_8c.html#ab8fcd76c656df5bde6a289c559ae4599" title=" " alt="" coords="415,34,508,60"/>
<area shape="rect" href="control_state_machine__mock_8c.html#a7776993523843f04088c3c030136c38a" title=" " alt="" coords="385,84,537,111"/>
<area shape="rect" href="precharge_discharge_8c.html#af98be4ce700b42b38a9f1126522cbd75" title="Update HV Bus measurements." alt="" coords="388,135,535,162"/>
<area shape="rect" href="precharge_discharge_8c.html#a65d178f293cd832dab02da08d5e86748" title="Task to control precharge and discharge. Receives notifications from the control state machine to eit..." alt="" coords="5,110,84,136"/>
<area shape="rect" href="precharge_discharge_8c.html#a7c67d24028b0fc2b67821ea9b0b55144" title="Perform precharge. If succesful, bus voltage will equal battery voltage." alt="" coords="132,135,211,162"/>
</map>
</div>

</div>
</div>
<a id="ab07aef73f633627b5a1a78e40f15961f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab07aef73f633627b5a1a78e40f15961f">&#9670;&nbsp;</a></span>getPackVoltage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_StatusTypeDef getPackVoltage </td>
          <td>(</td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>packVoltage</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the current pack voltage. This returns the pack voltage as calculated by summing all the cell voltages. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">packVoltage</td><td>pointer to a float to return the pack voltage (in volts)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>HAL_StatusTypeDe </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8h_ab07aef73f633627b5a1a78e40f15961f_icgraph.png" border="0" usemap="#batteries_8h_ab07aef73f633627b5a1a78e40f15961f_icgraph" alt=""/></div>
<map name="batteries_8h_ab07aef73f633627b5a1a78e40f15961f_icgraph" id="batteries_8h_ab07aef73f633627b5a1a78e40f15961f_icgraph">
<area shape="rect" title="Gets the current pack voltage. This returns the pack voltage as calculated by summing all the cell vo..." alt="" coords="273,31,388,57"/>
<area shape="rect" href="precharge_discharge_8c.html#a7c67d24028b0fc2b67821ea9b0b55144" title="Perform precharge. If succesful, bus voltage will equal battery voltage." alt="" coords="139,5,218,32"/>
<area shape="rect" href="control_state_machine__mock_8c.html#ab8fcd76c656df5bde6a289c559ae4599" title=" " alt="" coords="132,56,225,83"/>
<area shape="rect" href="precharge_discharge_8c.html#a65d178f293cd832dab02da08d5e86748" title="Task to control precharge and discharge. Receives notifications from the control state machine to eit..." alt="" coords="5,5,84,32"/>
</map>
</div>

</div>
</div>
<a id="aff30116cb629c2efdad61c2ccaec0c36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff30116cb629c2efdad61c2ccaec0c36">&#9670;&nbsp;</a></span>getVBatt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_StatusTypeDef getVBatt </td>
          <td>(</td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>VBatt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the most recent battery voltage reading (from the HV ADC). Note: this is only equal to the battery voltage when both contactors are closed. to get the battery voltage in all times, use <a class="el" href="batteries_8h.html#ab07aef73f633627b5a1a78e40f15961f">getPackVoltage</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">pointer</td><td>to a float to store the VBatt reading, in volts</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>HAL_StatusTypeDef </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8h_aff30116cb629c2efdad61c2ccaec0c36_icgraph.png" border="0" usemap="#batteries_8h_aff30116cb629c2efdad61c2ccaec0c36_icgraph" alt=""/></div>
<map name="batteries_8h_aff30116cb629c2efdad61c2ccaec0c36_icgraph" id="batteries_8h_aff30116cb629c2efdad61c2ccaec0c36_icgraph">
<area shape="rect" title="Get the most recent battery voltage reading (from the HV ADC). Note: this is only equal to the batter..." alt="" coords="585,56,659,83"/>
<area shape="rect" href="control_state_machine__mock_8c.html#ab8fcd76c656df5bde6a289c559ae4599" title=" " alt="" coords="415,5,508,32"/>
<area shape="rect" href="control_state_machine__mock_8c.html#a7776993523843f04088c3c030136c38a" title=" " alt="" coords="385,56,537,83"/>
<area shape="rect" href="precharge_discharge_8c.html#af98be4ce700b42b38a9f1126522cbd75" title="Update HV Bus measurements." alt="" coords="388,107,535,133"/>
<area shape="rect" href="precharge_discharge_8c.html#aeb4682e026fd4f795f52338469d54915" title="Discharges HV Bus. Opens contactors which connects in discharge resistor to discharge bus voltage...." alt="" coords="259,81,337,108"/>
<area shape="rect" href="precharge_discharge_8c.html#a7c67d24028b0fc2b67821ea9b0b55144" title="Perform precharge. If succesful, bus voltage will equal battery voltage." alt="" coords="132,132,211,159"/>
<area shape="rect" href="precharge_discharge_8c.html#a65d178f293cd832dab02da08d5e86748" title="Task to control precharge and discharge. Receives notifications from the control state machine to eit..." alt="" coords="5,107,84,133"/>
</map>
</div>

</div>
</div>
<a id="a6fbf3bf910348af26a580fc418f89f5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6fbf3bf910348af26a580fc418f89f5e">&#9670;&nbsp;</a></span>getVBus()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_StatusTypeDef getVBus </td>
          <td>(</td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>VBus</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the most recent HV Bus voltage reading (from the HV ADC) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">pointer</td><td>to a float to store the VBus reading, in volts</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>HAL_StatusTypeDef </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8h_a6fbf3bf910348af26a580fc418f89f5e_icgraph.png" border="0" usemap="#batteries_8h_a6fbf3bf910348af26a580fc418f89f5e_icgraph" alt=""/></div>
<map name="batteries_8h_a6fbf3bf910348af26a580fc418f89f5e_icgraph" id="batteries_8h_a6fbf3bf910348af26a580fc418f89f5e_icgraph">
<area shape="rect" title="Get the most recent HV Bus voltage reading (from the HV ADC)" alt="" coords="585,56,657,83"/>
<area shape="rect" href="control_state_machine__mock_8c.html#ab8fcd76c656df5bde6a289c559ae4599" title=" " alt="" coords="415,5,508,32"/>
<area shape="rect" href="control_state_machine__mock_8c.html#a7776993523843f04088c3c030136c38a" title=" " alt="" coords="385,56,537,83"/>
<area shape="rect" href="precharge_discharge_8c.html#af98be4ce700b42b38a9f1126522cbd75" title="Update HV Bus measurements." alt="" coords="388,107,535,133"/>
<area shape="rect" href="precharge_discharge_8c.html#aeb4682e026fd4f795f52338469d54915" title="Discharges HV Bus. Opens contactors which connects in discharge resistor to discharge bus voltage...." alt="" coords="259,81,337,108"/>
<area shape="rect" href="precharge_discharge_8c.html#a7c67d24028b0fc2b67821ea9b0b55144" title="Perform precharge. If succesful, bus voltage will equal battery voltage." alt="" coords="132,132,211,159"/>
<area shape="rect" href="precharge_discharge_8c.html#a65d178f293cd832dab02da08d5e86748" title="Task to control precharge and discharge. Receives notifications from the control state machine to eit..." alt="" coords="5,107,84,133"/>
</map>
</div>

</div>
</div>
<a id="a951b2aac55838c4b1abd243f38e2ca47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a951b2aac55838c4b1abd243f38e2ca47">&#9670;&nbsp;</a></span>initBusVoltagesAndCurrentQueues()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_StatusTypeDef initBusVoltagesAndCurrentQueues </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates queues for HV Bus measurements Queue overwrite, Queue peek, and queue size of 1 is used to ensure only the most recent data is in the queue and read from the queue. Queues use Amps and Volts for units. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8h_a951b2aac55838c4b1abd243f38e2ca47_icgraph.png" border="0" usemap="#batteries_8h_a951b2aac55838c4b1abd243f38e2ca47_icgraph" alt=""/></div>
<map name="batteries_8h_a951b2aac55838c4b1abd243f38e2ca47_icgraph" id="batteries_8h_a951b2aac55838c4b1abd243f38e2ca47_icgraph">
<area shape="rect" title="Creates queues for HV Bus measurements Queue overwrite, Queue peek, and queue size of 1 is used to en..." alt="" coords="119,5,297,47"/>
<area shape="rect" href="user_init_8c.html#a0c5fe2b0843784b74406a16461353491" title=" " alt="" coords="5,13,71,39"/>
</map>
</div>

</div>
</div>
<a id="a92932081ca58208175ca6c4e0971f06d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92932081ca58208175ca6c4e0971f06d">&#9670;&nbsp;</a></span>initPackVoltageQueue()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_StatusTypeDef initPackVoltageQueue </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates the pack voltage queue. Needs to be called before RTOS starts. </p>
<dl class="section return"><dt>Returns</dt><dd>HAL_StatusTypeDef </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8h_a92932081ca58208175ca6c4e0971f06d_icgraph.png" border="0" usemap="#batteries_8h_a92932081ca58208175ca6c4e0971f06d_icgraph" alt=""/></div>
<map name="batteries_8h_a92932081ca58208175ca6c4e0971f06d_icgraph" id="batteries_8h_a92932081ca58208175ca6c4e0971f06d_icgraph">
<area shape="rect" title="Creates the pack voltage queue. Needs to be called before RTOS starts." alt="" coords="119,5,269,32"/>
<area shape="rect" href="user_init_8c.html#a0c5fe2b0843784b74406a16461353491" title=" " alt="" coords="5,5,71,32"/>
</map>
</div>

</div>
</div>
<a id="aed5d06c4a55e40673204ceacf2fde819"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed5d06c4a55e40673204ceacf2fde819">&#9670;&nbsp;</a></span>map_range_float()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float map_range_float </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>low</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>high</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>low_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>high_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maps a value from one range to another in a linear manner. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">in</td><td>The value to map </td></tr>
    <tr><td class="paramname">low</td><td>low value of in range </td></tr>
    <tr><td class="paramname">high</td><td>high value of in range </td></tr>
    <tr><td class="paramname">low_out</td><td>low value of out range </td></tr>
    <tr><td class="paramname">high_out</td><td>high value of out range</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>in value mapped to out range </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8h_aed5d06c4a55e40673204ceacf2fde819_icgraph.png" border="0" usemap="#batteries_8h_aed5d06c4a55e40673204ceacf2fde819_icgraph" alt=""/></div>
<map name="batteries_8h_aed5d06c4a55e40673204ceacf2fde819_icgraph" id="batteries_8h_aed5d06c4a55e40673204ceacf2fde819_icgraph">
<area shape="rect" title="Maps a value from one range to another in a linear manner." alt="" coords="492,31,611,57"/>
<area shape="rect" href="fan_control_8c.html#af8b63e1141165474f388757d14b73d8d" title=" " alt="" coords="306,5,439,32"/>
<area shape="rect" href="batteries_8c.html#a3d41850a2fe8400978c4f68163d726be" title="Calculates the SoC of a cell from the cell&#39;s voltage." alt="" coords="301,56,444,83"/>
<area shape="rect" href="fan_control_8c.html#a184ee44a7689f1d3d3aec78b7c4a0e01" title=" " alt="" coords="167,5,230,32"/>
<area shape="rect" href="fan_control_8c.html#a34c9fabe6bbdea59eabd8e06a24aee8d" title=" " alt="" coords="17,5,85,32"/>
<area shape="rect" href="batteries_8c.html#a9144cd162ceec3e710baea6601149b43" title="Performs balance charging. For more info, see the BMU page on confluence." alt="" coords="144,56,253,83"/>
<area shape="rect" href="batteries_8c.html#a3364449b5cc8a93c89985f5d9fa2984b" title="Task to monitor cell voltages and temperatures, as well as perform balance charging." alt="" coords="5,56,96,83"/>
</map>
</div>

</div>
</div>
<a id="aacf3b5ff9648b813208cb6f91b370fef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aacf3b5ff9648b813208cb6f91b370fef">&#9670;&nbsp;</a></span>setMaxChargeCurrent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_StatusTypeDef setMaxChargeCurrent </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>maxCurrent</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the maximum current for the charger. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">maxCurrent</td><td>The maximum current, in Amps</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>HAL_StatusTypeDef </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8h_aacf3b5ff9648b813208cb6f91b370fef_icgraph.png" border="0" usemap="#batteries_8h_aacf3b5ff9648b813208cb6f91b370fef_icgraph" alt=""/></div>
<map name="batteries_8h_aacf3b5ff9648b813208cb6f91b370fef_icgraph" id="batteries_8h_aacf3b5ff9648b813208cb6f91b370fef_icgraph">
<area shape="rect" title="Sets the maximum current for the charger." alt="" coords="245,5,396,32"/>
<area shape="rect" href="control_state_machine__mock_8c.html#a56cc0ce9d03dc53af6b0adf600b8610c" title=" " alt="" coords="5,5,197,32"/>
</map>
</div>

</div>
</div>
<a id="acd55a62448b408952283c28d12dd4c1d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd55a62448b408952283c28d12dd4c1d">&#9670;&nbsp;</a></span>setSendOnlyOneCell()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setSendOnlyOneCell </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cellIdx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Repeatedly send the cell voltage and temperature for a specific cell. This is instead of the normal behaviour which cycles through all the cells sending a message every <a class="el" href="batteries_8c.html#ab75dbcd7e0a59fc3d1fc3715de87544a">CAN_CELL_SEND_PERIOD_MS</a>. Useful for battery testing to monitor a cell at higher frequency. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cellIdx</td><td>The cell to repeatedly send (note, this uses firmwares 0 based indexing, instead of electricals 1 based indexing of cell numbers) </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="batteries_8h_acd55a62448b408952283c28d12dd4c1d_icgraph.png" border="0" usemap="#batteries_8h_acd55a62448b408952283c28d12dd4c1d_icgraph" alt=""/></div>
<map name="batteries_8h_acd55a62448b408952283c28d12dd4c1d_icgraph" id="batteries_8h_acd55a62448b408952283c28d12dd4c1d_icgraph">
<area shape="rect" title="Repeatedly send the cell voltage and temperature for a specific cell. This is instead of the normal b..." alt="" coords="187,5,331,32"/>
<area shape="rect" href="control_state_machine__mock_8c.html#a8579cea544ffd2e8b4f8003a928bf189" title=" " alt="" coords="5,5,139,32"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.18
</small></address>
</body>
</html>
