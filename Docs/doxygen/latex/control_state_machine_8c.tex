\hypertarget{control_state_machine_8c}{}\doxysection{/\+Users/djgood/\+WFE/firmware/2018\+\_\+bmu/\+Src/control\+State\+Machine.c File Reference}
\label{control_state_machine_8c}\index{/Users/djgood/WFE/firmware/2018\_bmu/Src/controlStateMachine.c@{/Users/djgood/WFE/firmware/2018\_bmu/Src/controlStateMachine.c}}


State machine controlling BMU\textquotesingle{}s high level logic.  


{\ttfamily \#include \char`\"{}control\+State\+Machine.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}stm32f7xx\+\_\+hal.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}stdbool.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Free\+RTOS.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}task.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}cmsis\+\_\+os.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}debug.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}state\+\_\+machine.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}BMU\+\_\+dtc.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}BMU\+\_\+can.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}precharge\+Discharge.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}bsp.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}watchdog.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}batteries.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}charger\+Control.\+h\char`\"{}}\newline
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{control_state_machine_8c_a3930589722c8565674bf4289b62b6736}\label{control_state_machine_8c_a3930589722c8565674bf4289b62b6736}} 
uint32\+\_\+t {\bfseries run\+Selft\+Tests} (uint32\+\_\+t event)
\item 
\mbox{\Hypertarget{control_state_machine_8c_a98d9d786d6b22fa60c01e1cf97015ded}\label{control_state_machine_8c_a98d9d786d6b22fa60c01e1cf97015ded}} 
uint32\+\_\+t {\bfseries start\+Precharge} (uint32\+\_\+t event)
\item 
\mbox{\Hypertarget{control_state_machine_8c_a7e5546a1f92fadbb12b47ee8dd6fa788}\label{control_state_machine_8c_a7e5546a1f92fadbb12b47ee8dd6fa788}} 
uint32\+\_\+t {\bfseries start\+Discharge} (uint32\+\_\+t event)
\item 
\mbox{\Hypertarget{control_state_machine_8c_a97006f02eb598a66665edbdac4bdd2b6}\label{control_state_machine_8c_a97006f02eb598a66665edbdac4bdd2b6}} 
uint32\+\_\+t {\bfseries discharge\+Finished} (uint32\+\_\+t event)
\item 
\mbox{\Hypertarget{control_state_machine_8c_a42829f4f939b085a43d57cb54270c20d}\label{control_state_machine_8c_a42829f4f939b085a43d57cb54270c20d}} 
uint32\+\_\+t {\bfseries precharge\+Finished} (uint32\+\_\+t event)
\item 
\mbox{\Hypertarget{control_state_machine_8c_a14813207cfb2fa6bc84f9a8d2819db15}\label{control_state_machine_8c_a14813207cfb2fa6bc84f9a8d2819db15}} 
uint32\+\_\+t {\bfseries control\+Do\+Nothing} (uint32\+\_\+t event)
\item 
\mbox{\Hypertarget{control_state_machine_8c_a7559fe52b7e5fa43249fe0a515e6eb90}\label{control_state_machine_8c_a7559fe52b7e5fa43249fe0a515e6eb90}} 
uint32\+\_\+t {\bfseries Default\+Transition} (uint32\+\_\+t event)
\item 
\mbox{\Hypertarget{control_state_machine_8c_a960d21918a75b8646133de150aa2db8a}\label{control_state_machine_8c_a960d21918a75b8646133de150aa2db8a}} 
uint32\+\_\+t {\bfseries handle\+Fault} (uint32\+\_\+t event)
\item 
\mbox{\Hypertarget{control_state_machine_8c_a51c946a4fcc42914f3fc2c79d95602de}\label{control_state_machine_8c_a51c946a4fcc42914f3fc2c79d95602de}} 
uint32\+\_\+t {\bfseries stop\+Precharge} (uint32\+\_\+t event)
\item 
\mbox{\Hypertarget{control_state_machine_8c_aec0bbf23130028c099e9ceb26f24b917}\label{control_state_machine_8c_aec0bbf23130028c099e9ceb26f24b917}} 
uint32\+\_\+t {\bfseries enter\+Charge\+Mode} (uint32\+\_\+t event)
\item 
\mbox{\Hypertarget{control_state_machine_8c_a04344918770ff3e25965c9dd392901df}\label{control_state_machine_8c_a04344918770ff3e25965c9dd392901df}} 
uint32\+\_\+t {\bfseries start\+Charge} (uint32\+\_\+t event)
\item 
\mbox{\Hypertarget{control_state_machine_8c_a80323800602805e1cd2c6c44231d79fe}\label{control_state_machine_8c_a80323800602805e1cd2c6c44231d79fe}} 
uint32\+\_\+t {\bfseries stop\+Charge} (uint32\+\_\+t event)
\item 
\mbox{\Hypertarget{control_state_machine_8c_a9d51a7a220e061ece203b20d33064eb6}\label{control_state_machine_8c_a9d51a7a220e061ece203b20d33064eb6}} 
uint32\+\_\+t {\bfseries charge\+Done} (uint32\+\_\+t event)
\item 
\mbox{\Hypertarget{control_state_machine_8c_a8cc0e4f7e7666631a49f66b35a5cdf93}\label{control_state_machine_8c_a8cc0e4f7e7666631a49f66b35a5cdf93}} 
uint32\+\_\+t {\bfseries system\+Up\+Check} (uint32\+\_\+t event)
\item 
\mbox{\Hypertarget{control_state_machine_8c_af51ccc9cfed340f0fbe6be7321b413e1}\label{control_state_machine_8c_af51ccc9cfed340f0fbe6be7321b413e1}} 
uint32\+\_\+t {\bfseries system\+Not\+Ready} (uint32\+\_\+t event)
\item 
\mbox{\Hypertarget{control_state_machine_8c_aeeb6f51c860f255a4f6800cbd9c63d2c}\label{control_state_machine_8c_aeeb6f51c860f255a4f6800cbd9c63d2c}} 
HAL\+\_\+\+Status\+Type\+Def {\bfseries control\+Init} ()
\item 
\mbox{\Hypertarget{control_state_machine_8c_a67a8d726e911bbb9d70f976f8ca7357b}\label{control_state_machine_8c_a67a8d726e911bbb9d70f976f8ca7357b}} 
void {\bfseries control\+Task} (void $\ast$pv\+Parameters)
\item 
\mbox{\Hypertarget{control_state_machine_8c_a92d8141b01e22248e6fbbcce4540ce13}\label{control_state_machine_8c_a92d8141b01e22248e6fbbcce4540ce13}} 
HAL\+\_\+\+Status\+Type\+Def {\bfseries start\+Control} ()
\item 
BMU\+\_\+\+System\+Up\+Fail \mbox{\hyperlink{control_state_machine_8c_ae31c6dff7ba88e74cbd059d814e90a42}{is\+System\+Ready}} ()
\begin{DoxyCompactList}\small\item\em Checks if the system is ready to run Checks components of the IL to make sure the system is ready to run. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{control_state_machine_8c_a757fb540ee64def424d675d863a74fee}\label{control_state_machine_8c_a757fb540ee64def424d675d863a74fee}} 
uint32\+\_\+t {\bfseries stop\+Discharge} ()
\item 
\mbox{\Hypertarget{control_state_machine_8c_a98d3c4dc6c6dff8256024c0f84ee8272}\label{control_state_machine_8c_a98d3c4dc6c6dff8256024c0f84ee8272}} 
void {\bfseries send\+Stop\+Precharge} ()
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{control_state_machine_8c_a2272f9b83e25d7eba05f1682a57c479a}\label{control_state_machine_8c_a2272f9b83e25d7eba05f1682a57c479a}} 
os\+Thread\+Id {\bfseries PCDCHandle}
\item 
\mbox{\Hypertarget{control_state_machine_8c_aa95731d4ff40893bc5d4c80cc0fa055f}\label{control_state_machine_8c_aa95731d4ff40893bc5d4c80cc0fa055f}} 
os\+Thread\+Id {\bfseries Battery\+Task\+Handle}
\item 
\mbox{\Hypertarget{control_state_machine_8c_a5d150347acb1b09a3a62e79cb15c09a0}\label{control_state_machine_8c_a5d150347acb1b09a3a62e79cb15c09a0}} 
FSM\+\_\+\+Handle\+\_\+\+Struct {\bfseries fsm\+Handle}
\item 
\mbox{\Hypertarget{control_state_machine_8c_afbfaabebed8be324b4ccef54587f46c5}\label{control_state_machine_8c_afbfaabebed8be324b4ccef54587f46c5}} 
bool {\bfseries g\+Charge\+Mode}
\item 
\mbox{\Hypertarget{control_state_machine_8c_ace58e8d827f63ba0f259e760f565c188}\label{control_state_machine_8c_ace58e8d827f63ba0f259e760f565c188}} 
Transition\+\_\+t {\bfseries transitions} \mbox{[}$\,$\mbox{]}
\item 
\mbox{\Hypertarget{control_state_machine_8c_a18d22898430d02e4c9d5ccafd67944c3}\label{control_state_machine_8c_a18d22898430d02e4c9d5ccafd67944c3}} 
bool {\bfseries imd\+Ready} = false
\item 
\mbox{\Hypertarget{control_state_machine_8c_a5b0b5ac3df7bded60adde46ba917d49e}\label{control_state_machine_8c_a5b0b5ac3df7bded60adde46ba917d49e}} 
bool {\bfseries fault\+Monitor\+Ready} = false
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
State machine controlling BMU\textquotesingle{}s high level logic. 

\begin{DoxyAuthor}{Author}
Richard Matthews
\end{DoxyAuthor}
State machine logic, including transition array, and transition function. See confluence for more details 

\doxysubsection{Function Documentation}
\mbox{\Hypertarget{control_state_machine_8c_ae31c6dff7ba88e74cbd059d814e90a42}\label{control_state_machine_8c_ae31c6dff7ba88e74cbd059d814e90a42}} 
\index{controlStateMachine.c@{controlStateMachine.c}!isSystemReady@{isSystemReady}}
\index{isSystemReady@{isSystemReady}!controlStateMachine.c@{controlStateMachine.c}}
\doxysubsubsection{\texorpdfstring{isSystemReady()}{isSystemReady()}}
{\footnotesize\ttfamily BMU\+\_\+\+System\+Up\+Fail is\+System\+Ready (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Checks if the system is ready to run Checks components of the IL to make sure the system is ready to run. 

\begin{DoxyReturn}{Returns}
@\+BMU\+\_\+\+System\+Up\+Fail 
\end{DoxyReturn}
