\hypertarget{ade7912_8c}{}\doxysection{/\+Users/djgood/\+WFE/firmware/2018\+\_\+bmu/\+Src/\+F7\+\_\+\+Src/ade7912.c File Reference}
\label{ade7912_8c}\index{/Users/djgood/WFE/firmware/2018\_bmu/Src/F7\_Src/ade7912.c@{/Users/djgood/WFE/firmware/2018\_bmu/Src/F7\_Src/ade7912.c}}


Function to read HV ADC.  


{\ttfamily \#include \char`\"{}bsp.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}debug.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Free\+RTOS.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}task.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}math.\+h\char`\"{}}\newline
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{ade7912_8c_adb3cf7c79cf13df77296deec51efb00f}\label{ade7912_8c_adb3cf7c79cf13df77296deec51efb00f}} 
\#define {\bfseries ADDR\+\_\+\+CURRENT}~(0x00)
\item 
\mbox{\Hypertarget{ade7912_8c_a8bf86ec2d18eaeefe49328466df2d37f}\label{ade7912_8c_a8bf86ec2d18eaeefe49328466df2d37f}} 
\#define {\bfseries ADDR\+\_\+\+V1}~(0x01)
\item 
\mbox{\Hypertarget{ade7912_8c_a875c21c5eb9006ccf675bde3cf956402}\label{ade7912_8c_a875c21c5eb9006ccf675bde3cf956402}} 
\#define {\bfseries ADDR\+\_\+\+V2}~(0x02)
\item 
\mbox{\Hypertarget{ade7912_8c_a18051ad9f296b2f52f41246943525329}\label{ade7912_8c_a18051ad9f296b2f52f41246943525329}} 
\#define {\bfseries ADDR\+\_\+\+STATUS0}~(0x9)
\item 
\mbox{\Hypertarget{ade7912_8c_a105654aac863a992946fe5d438e73c4e}\label{ade7912_8c_a105654aac863a992946fe5d438e73c4e}} 
\#define {\bfseries RESET\+\_\+\+ON\+\_\+\+BIT}~(0x0)
\item 
\mbox{\Hypertarget{ade7912_8c_aed6ad170917d19293c3e0ca3fcdc3393}\label{ade7912_8c_aed6ad170917d19293c3e0ca3fcdc3393}} 
\#define {\bfseries ADDR\+\_\+\+CFG}~(0x8)
\item 
\mbox{\Hypertarget{ade7912_8c_a6cded5f4eb0131bdaae4acaeb102e8ce}\label{ade7912_8c_a6cded5f4eb0131bdaae4acaeb102e8ce}} 
\#define {\bfseries ADC\+\_\+\+FREQ\+\_\+2\+KHZ}~(0x20)
\item 
\mbox{\Hypertarget{ade7912_8c_addeb6c35c00c7d64b75f4804ab2b1ab5}\label{ade7912_8c_addeb6c35c00c7d64b75f4804ab2b1ab5}} 
\#define {\bfseries ADC\+\_\+\+FREQ\+\_\+1\+KHZ}~(0x30)
\item 
\mbox{\Hypertarget{ade7912_8c_a0290304422f9f948bda5c2ac59546633}\label{ade7912_8c_a0290304422f9f948bda5c2ac59546633}} 
\#define {\bfseries ADC\+\_\+\+LOW\+\_\+\+BW\+\_\+\+ENABLE}~(0x80)
\item 
\mbox{\Hypertarget{ade7912_8c_a0131f2774f4e3dd71567400683b60405}\label{ade7912_8c_a0131f2774f4e3dd71567400683b60405}} 
\#define {\bfseries SPI\+\_\+\+TIMEOUT}~15
\item 
\mbox{\Hypertarget{ade7912_8c_ade3cbac59b95d40d47bcd6bfc65abf87}\label{ade7912_8c_ade3cbac59b95d40d47bcd6bfc65abf87}} 
\#define {\bfseries VOLTAGE\+\_\+1\+\_\+\+SCALE}~(-\/0.\+000052670388F)
\item 
\mbox{\Hypertarget{ade7912_8c_aaa6121b489d7f399a453dc80f2a4abb3}\label{ade7912_8c_aaa6121b489d7f399a453dc80f2a4abb3}} 
\#define {\bfseries VOLTAGE\+\_\+1\+\_\+\+OFFSET}~(20.\+451204825373F)
\item 
\mbox{\Hypertarget{ade7912_8c_ae95369b0141e0e310a0171b4f4fb3bc6}\label{ade7912_8c_ae95369b0141e0e310a0171b4f4fb3bc6}} 
\#define {\bfseries VOLTAGE\+\_\+2\+\_\+\+SCALE}~(-\/0.\+000052273823F)
\item 
\mbox{\Hypertarget{ade7912_8c_a8f06bef071865c160a7cf642fb15050e}\label{ade7912_8c_a8f06bef071865c160a7cf642fb15050e}} 
\#define {\bfseries VOLTAGE\+\_\+2\+\_\+\+OFFSET}~(23.\+442233510687)
\item 
\mbox{\Hypertarget{ade7912_8c_af282c2dea8d5a7abdad5d3ebcce554a8}\label{ade7912_8c_af282c2dea8d5a7abdad5d3ebcce554a8}} 
\#define {\bfseries CURRENT\+\_\+\+SCALE}~(0.\+000000005332795540972819F)
\item 
\mbox{\Hypertarget{ade7912_8c_aa4c5585f0614881f8b9a56ce287ed2f7}\label{ade7912_8c_aa4c5585f0614881f8b9a56ce287ed2f7}} 
\#define {\bfseries CURRENT\+\_\+\+OFFSET}~(-\/0.\+002105965908664F)
\item 
\mbox{\Hypertarget{ade7912_8c_a6d0dca1a7a491d2bef42beeba8d84ead}\label{ade7912_8c_a6d0dca1a7a491d2bef42beeba8d84ead}} 
\#define {\bfseries CURRENT\+\_\+\+SHUNT\+\_\+\+VAL\+\_\+\+OHMS\+\_\+\+HITL}~(0.\+000235F)
\item 
\mbox{\Hypertarget{ade7912_8c_a6fe11d575d209abca78ee8986d36268f}\label{ade7912_8c_a6fe11d575d209abca78ee8986d36268f}} 
\#define {\bfseries CURRENT\+\_\+\+SHUNT\+\_\+\+VAL\+\_\+\+OHMS\+\_\+\+CAR}~(0.\+0001F)
\item 
\mbox{\Hypertarget{ade7912_8c_a443622cfebffbc87bc846ee3ff096d22}\label{ade7912_8c_a443622cfebffbc87bc846ee3ff096d22}} 
\#define {\bfseries MAX\+\_\+\+CURRENT\+\_\+\+ADC\+\_\+\+VOLTAGE}~(0.\+03125F)
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{ade7912_8c_ac93c6c24e9f7f55cf6bd041fda4ab91e}\label{ade7912_8c_ac93c6c24e9f7f55cf6bd041fda4ab91e}} 
HAL\+\_\+\+Status\+Type\+Def {\bfseries adc\+\_\+spi\+\_\+tx} (uint8\+\_\+t $\ast$tdata, unsigned int len)
\item 
\mbox{\Hypertarget{ade7912_8c_ae3cbdc95c83faf3865265519f8d59859}\label{ade7912_8c_ae3cbdc95c83faf3865265519f8d59859}} 
HAL\+\_\+\+Status\+Type\+Def {\bfseries adc\+\_\+spi\+\_\+tx\+\_\+rx} (uint8\+\_\+t $\ast$tdata, uint8\+\_\+t $\ast$rbuffer, unsigned int len)
\item 
\mbox{\Hypertarget{ade7912_8c_a491bcafc23bd1602ed45988ee15b5333}\label{ade7912_8c_a491bcafc23bd1602ed45988ee15b5333}} 
uint8\+\_\+t {\bfseries adc\+\_\+readbyte} (uint8\+\_\+t addr, uint8\+\_\+t $\ast$data\+Out)
\item 
\mbox{\Hypertarget{ade7912_8c_ac044d42855f65563378bfd5f320571d5}\label{ade7912_8c_ac044d42855f65563378bfd5f320571d5}} 
HAL\+\_\+\+Status\+Type\+Def {\bfseries adc\+\_\+read} (uint8\+\_\+t addr, int32\+\_\+t $\ast$data\+Out)
\item 
\mbox{\Hypertarget{ade7912_8c_ab46c27793771a87a99acfbbda9db0ca5}\label{ade7912_8c_ab46c27793771a87a99acfbbda9db0ca5}} 
HAL\+\_\+\+Status\+Type\+Def {\bfseries adc\+\_\+write} (uint8\+\_\+t addr, uint8\+\_\+t data)
\item 
\mbox{\Hypertarget{ade7912_8c_af0f5c0f7b51bfb3d1644b87f85d3588a}\label{ade7912_8c_af0f5c0f7b51bfb3d1644b87f85d3588a}} 
HAL\+\_\+\+Status\+Type\+Def {\bfseries adc\+\_\+read\+\_\+current} (float $\ast$data\+Out)
\item 
\mbox{\Hypertarget{ade7912_8c_a1a71e3fb2f93c6556b723a1a70e4fa1b}\label{ade7912_8c_a1a71e3fb2f93c6556b723a1a70e4fa1b}} 
HAL\+\_\+\+Status\+Type\+Def {\bfseries adc\+\_\+read\+\_\+v1} (float $\ast$data\+Out)
\item 
\mbox{\Hypertarget{ade7912_8c_ac933b80dc6a6509a513f4b73b559a78a}\label{ade7912_8c_ac933b80dc6a6509a513f4b73b559a78a}} 
HAL\+\_\+\+Status\+Type\+Def {\bfseries adc\+\_\+read\+\_\+v2} (float $\ast$data\+Out)
\item 
\mbox{\Hypertarget{ade7912_8c_ae4f34cba54df4511eefe9c6e1b87b9c7}\label{ade7912_8c_ae4f34cba54df4511eefe9c6e1b87b9c7}} 
HAL\+\_\+\+Status\+Type\+Def {\bfseries hvadc\+\_\+init} ()
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{ade7912_8c_a9586edc6945922e1f2308286e7e0f42f}\label{ade7912_8c_a9586edc6945922e1f2308286e7e0f42f}} 
bool {\bfseries HITL\+\_\+\+Precharge\+\_\+\+Mode}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Function to read HV ADC. 

\begin{DoxyAuthor}{Author}
Richard Matthews
\end{DoxyAuthor}
Functions to read the HV ADC. The HV ADC measures the HV bus current, HV bus voltage, and HV battery voltage. The HV ADC is connected to the BMU over SPI. 