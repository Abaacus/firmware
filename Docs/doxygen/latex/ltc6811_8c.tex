\hypertarget{ltc6811_8c}{}\doxysection{/\+Users/djgood/\+WFE/firmware/2018\+\_\+bmu/\+Src/\+F7\+\_\+\+Src/ltc6811.c File Reference}
\label{ltc6811_8c}\index{/Users/djgood/WFE/firmware/2018\_bmu/Src/F7\_Src/ltc6811.c@{/Users/djgood/WFE/firmware/2018\_bmu/Src/F7\_Src/ltc6811.c}}


Module for communicating with ltc6811 chips on the AMS boards.  


{\ttfamily \#include \char`\"{}ltc6811.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}bsp.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}math.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}stdbool.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}error\+Handler.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}debug.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Free\+RTOS.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}task.\+h\char`\"{}}\newline
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{ltc6811_8c_ac6d5e91a8da2f47d194eefb07e4be46c}\label{ltc6811_8c_ac6d5e91a8da2f47d194eefb07e4be46c}} 
\#define {\bfseries VOLTAGE\+\_\+\+BLOCKS\+\_\+\+PER\+\_\+\+BOARD}~4
\item 
\mbox{\Hypertarget{ltc6811_8c_a2c5827838c98e03bf8d54a3f1f7708e1}\label{ltc6811_8c_a2c5827838c98e03bf8d54a3f1f7708e1}} 
\#define {\bfseries VOLTAGES\+\_\+\+PER\+\_\+\+BLOCK}~3
\item 
\mbox{\Hypertarget{ltc6811_8c_a505a6d0555afc439d72bea570baa8911}\label{ltc6811_8c_a505a6d0555afc439d72bea570baa8911}} 
\#define {\bfseries TEMP\+\_\+\+CHANNELS\+\_\+\+PER\+\_\+\+BOARD}~12
\item 
\mbox{\Hypertarget{ltc6811_8c_a85b439ce13a961948d01264ae64d8db5}\label{ltc6811_8c_a85b439ce13a961948d01264ae64d8db5}} 
\#define {\bfseries VOLTAGE\+\_\+\+MEASURE\+\_\+\+DELAY\+\_\+\+MS}~2
\item 
\mbox{\Hypertarget{ltc6811_8c_aa5158c512c213bc8754a85f89b8bd4ab}\label{ltc6811_8c_aa5158c512c213bc8754a85f89b8bd4ab}} 
\#define {\bfseries VOLTAGE\+\_\+\+MEASURE\+\_\+\+DELAY\+\_\+\+EXTRA\+\_\+\+US}~400
\item 
\mbox{\Hypertarget{ltc6811_8c_a53211cccda532d16601d45b59e105b16}\label{ltc6811_8c_a53211cccda532d16601d45b59e105b16}} 
\#define {\bfseries TEMP\+\_\+\+MEASURE\+\_\+\+DELAY\+\_\+\+US}~405
\item 
\mbox{\Hypertarget{ltc6811_8c_a31f5ceb2d1dfbb6c878af7e9cf0aa9a8}\label{ltc6811_8c_a31f5ceb2d1dfbb6c878af7e9cf0aa9a8}} 
\#define {\bfseries MUX\+\_\+\+MEASURE\+\_\+\+DELAY\+\_\+\+US}~1
\item 
\mbox{\Hypertarget{ltc6811_8c_a280feb883e9d4a7edcc69c8bcb9f38f2}\label{ltc6811_8c_a280feb883e9d4a7edcc69c8bcb9f38f2}} 
\#define {\bfseries ADDRESS}~1
\item 
\mbox{\Hypertarget{ltc6811_8c_a4e3f687d9ca24db4385382c1009f2e9f}\label{ltc6811_8c_a4e3f687d9ca24db4385382c1009f2e9f}} 
\#define {\bfseries WRCFG\+\_\+\+BYTE0}~(0x00)
\item 
\mbox{\Hypertarget{ltc6811_8c_a78ecb0ee5b49f0cc4b68290e88f48239}\label{ltc6811_8c_a78ecb0ee5b49f0cc4b68290e88f48239}} 
\#define {\bfseries WRCFG\+\_\+\+BYTE1}~0x01
\item 
\mbox{\Hypertarget{ltc6811_8c_aa6a613651822dcd9933f5a4b4ebecb08}\label{ltc6811_8c_aa6a613651822dcd9933f5a4b4ebecb08}} 
\#define {\bfseries RDCFG\+\_\+\+BYTE0}~(0x00)
\item 
\mbox{\Hypertarget{ltc6811_8c_a298b2361cb5c43322d85d16796cf8f75}\label{ltc6811_8c_a298b2361cb5c43322d85d16796cf8f75}} 
\#define {\bfseries RDCFG\+\_\+\+BYTE1}~0x02
\item 
\mbox{\Hypertarget{ltc6811_8c_a793be63d04d305bd406a543e80574979}\label{ltc6811_8c_a793be63d04d305bd406a543e80574979}} 
\#define {\bfseries RDCVA\+\_\+\+BYTE0}~(0x00)
\item 
\mbox{\Hypertarget{ltc6811_8c_afe84e95baa5b77cfe3393fae2820003d}\label{ltc6811_8c_afe84e95baa5b77cfe3393fae2820003d}} 
\#define {\bfseries RDCVA\+\_\+\+BYTE1}~0x04
\item 
\mbox{\Hypertarget{ltc6811_8c_ad24e68619a0ec4a98ce4cd4c5fc3f637}\label{ltc6811_8c_ad24e68619a0ec4a98ce4cd4c5fc3f637}} 
\#define {\bfseries RDCVB\+\_\+\+BYTE0}~(0x00)
\item 
\mbox{\Hypertarget{ltc6811_8c_aa690a5a8c3f6bf4328195f8a423a4b1a}\label{ltc6811_8c_aa690a5a8c3f6bf4328195f8a423a4b1a}} 
\#define {\bfseries RDCVB\+\_\+\+BYTE1}~0x06
\item 
\mbox{\Hypertarget{ltc6811_8c_a857a1e5d9b95e253397e363745914f43}\label{ltc6811_8c_a857a1e5d9b95e253397e363745914f43}} 
\#define {\bfseries RDCVC\+\_\+\+BYTE0}~(0x00)
\item 
\mbox{\Hypertarget{ltc6811_8c_ae5dc0a874fe988941bd2321ea314568c}\label{ltc6811_8c_ae5dc0a874fe988941bd2321ea314568c}} 
\#define {\bfseries RDCVC\+\_\+\+BYTE1}~0x08
\item 
\mbox{\Hypertarget{ltc6811_8c_a431483204ffb2d0c830b237dbd77e42a}\label{ltc6811_8c_a431483204ffb2d0c830b237dbd77e42a}} 
\#define {\bfseries RDCVD\+\_\+\+BYTE0}~(0x00)
\item 
\mbox{\Hypertarget{ltc6811_8c_a50f91f64964103907bda95ec7675935d}\label{ltc6811_8c_a50f91f64964103907bda95ec7675935d}} 
\#define {\bfseries RDCVD\+\_\+\+BYTE1}~0x0a
\item 
\mbox{\Hypertarget{ltc6811_8c_a93506fcd33a597ad38c7b5be85b2285d}\label{ltc6811_8c_a93506fcd33a597ad38c7b5be85b2285d}} 
\#define {\bfseries PLADC\+\_\+\+BYTE0}~(0x07)
\item 
\mbox{\Hypertarget{ltc6811_8c_a077a86df89a99b6eb73f6dded632086d}\label{ltc6811_8c_a077a86df89a99b6eb73f6dded632086d}} 
\#define {\bfseries PLADC\+\_\+\+BYTE1}~0x14
\item 
\mbox{\Hypertarget{ltc6811_8c_a7ac4aa42f35baedb8ebf8bf0a921bbf9}\label{ltc6811_8c_a7ac4aa42f35baedb8ebf8bf0a921bbf9}} 
\#define {\bfseries CLRSTAT\+\_\+\+BYTE0}~(0x07)
\item 
\mbox{\Hypertarget{ltc6811_8c_a87d441156fc8775fa29baf32b156f035}\label{ltc6811_8c_a87d441156fc8775fa29baf32b156f035}} 
\#define {\bfseries CLRSTAT\+\_\+\+BYTE1}~0x13
\item 
\mbox{\Hypertarget{ltc6811_8c_a21d174afc47bcc48dcdf8630a5d1683c}\label{ltc6811_8c_a21d174afc47bcc48dcdf8630a5d1683c}} 
\#define {\bfseries CLRCELL\+\_\+\+BYTE0}~(0x07)
\item 
\mbox{\Hypertarget{ltc6811_8c_a4e55affc5ea590557d88e0553a2bdf4b}\label{ltc6811_8c_a4e55affc5ea590557d88e0553a2bdf4b}} 
\#define {\bfseries CLRCELL\+\_\+\+BYTE1}~0x11
\item 
\mbox{\Hypertarget{ltc6811_8c_a42bd7692d065a2b5e18bb4d25f126fae}\label{ltc6811_8c_a42bd7692d065a2b5e18bb4d25f126fae}} 
\#define {\bfseries CLRAUX\+\_\+\+BYTE0}~(0x07)
\item 
\mbox{\Hypertarget{ltc6811_8c_a9475d702e49976286a27ed03eb112b1d}\label{ltc6811_8c_a9475d702e49976286a27ed03eb112b1d}} 
\#define {\bfseries CLRAUX\+\_\+\+BYTE1}~0x12
\item 
\mbox{\Hypertarget{ltc6811_8c_a749015788b2c11c11627cb1897ef92c0}\label{ltc6811_8c_a749015788b2c11c11627cb1897ef92c0}} 
\#define {\bfseries RDAUXA\+\_\+\+BYTE0}~(0x00)
\item 
\mbox{\Hypertarget{ltc6811_8c_a4b51efa2dd74bef85406b3a3988ff4c3}\label{ltc6811_8c_a4b51efa2dd74bef85406b3a3988ff4c3}} 
\#define {\bfseries RDAUXA\+\_\+\+BYTE1}~0x0c
\item 
\mbox{\Hypertarget{ltc6811_8c_a5b304f75669b27132e98c1eae134b932}\label{ltc6811_8c_a5b304f75669b27132e98c1eae134b932}} 
\#define {\bfseries RDAUXB\+\_\+\+BYTE0}~(0x00)
\item 
\mbox{\Hypertarget{ltc6811_8c_a01646d6c1b761b6eed7d38b5fd2d338f}\label{ltc6811_8c_a01646d6c1b761b6eed7d38b5fd2d338f}} 
\#define {\bfseries RDAUXB\+\_\+\+BYTE1}~0x0e
\item 
\mbox{\Hypertarget{ltc6811_8c_a71697a4afd8d150b17310c55a4237884}\label{ltc6811_8c_a71697a4afd8d150b17310c55a4237884}} 
\#define {\bfseries ADCVAX\+\_\+\+BYTE0}~(0x05)
\item 
\mbox{\Hypertarget{ltc6811_8c_af88d3c50cc0a27227530bf48f742ef23}\label{ltc6811_8c_af88d3c50cc0a27227530bf48f742ef23}} 
\#define {\bfseries ADCVAX\+\_\+\+BYTE1}~0x6f
\item 
\mbox{\Hypertarget{ltc6811_8c_aa2757a8e26fe2cda11c5eb72354b5742}\label{ltc6811_8c_aa2757a8e26fe2cda11c5eb72354b5742}} 
\#define {\bfseries ADCV\+\_\+\+BYTE0}~(0x03)
\item 
\mbox{\Hypertarget{ltc6811_8c_ae07b0ca1bb7477d7dba78dd79dd05cdc}\label{ltc6811_8c_ae07b0ca1bb7477d7dba78dd79dd05cdc}} 
\#define {\bfseries ADCV\+\_\+\+BYTE1}~0x60
\item 
\mbox{\Hypertarget{ltc6811_8c_a65bf27833f88e8627f2e8cd8c06cce25}\label{ltc6811_8c_a65bf27833f88e8627f2e8cd8c06cce25}} 
\#define {\bfseries ADAX\+\_\+\+BYTE0}~(0x05)
\item 
\mbox{\Hypertarget{ltc6811_8c_ad3332b5fb30f398e6f212b56da197de4}\label{ltc6811_8c_ad3332b5fb30f398e6f212b56da197de4}} 
\#define {\bfseries ADAX\+\_\+\+BYTE1}~0x65
\item 
\mbox{\Hypertarget{ltc6811_8c_a3e5244ac37d8ef245881c2bb41f44d79}\label{ltc6811_8c_a3e5244ac37d8ef245881c2bb41f44d79}} 
\#define {\bfseries RDSTATB\+\_\+\+BYTE0}~(0x00)
\item 
\mbox{\Hypertarget{ltc6811_8c_a136adfa4c3cf79fec2779dfd1006f27b}\label{ltc6811_8c_a136adfa4c3cf79fec2779dfd1006f27b}} 
\#define {\bfseries RDSTATB\+\_\+\+BYTE1}~0x12
\item 
\mbox{\Hypertarget{ltc6811_8c_af602cf72ebcd8fecc7551bebbd2b1609}\label{ltc6811_8c_af602cf72ebcd8fecc7551bebbd2b1609}} 
\#define {\bfseries ADOW\+\_\+\+BYTE0}~(0x03)
\item 
\mbox{\Hypertarget{ltc6811_8c_adad2a21ee7dfe52fd5e161415fe65332}\label{ltc6811_8c_adad2a21ee7dfe52fd5e161415fe65332}} 
\#define {\bfseries ADOW\+\_\+\+BYTE1}(PUP)~(0x28 $\vert$ ((PUP)$<$$<$6))
\item 
\mbox{\Hypertarget{ltc6811_8c_ae93fed65681466d6c6e466d7e91a1ad4}\label{ltc6811_8c_ae93fed65681466d6c6e466d7e91a1ad4}} 
\#define {\bfseries PEC\+\_\+\+INIT\+\_\+\+VAL}~0x0010
\item 
\mbox{\Hypertarget{ltc6811_8c_a369ecd38b3ab077fc235f892354bb46f}\label{ltc6811_8c_a369ecd38b3ab077fc235f892354bb46f}} 
\#define {\bfseries BITS\+\_\+\+PER\+\_\+\+BYTE}~8
\item 
\mbox{\Hypertarget{ltc6811_8c_abb1214002521051a96925b047137dc17}\label{ltc6811_8c_abb1214002521051a96925b047137dc17}} 
\#define {\bfseries GETBIT}(value,  bit)~((value$>$$>$(bit))\&1)
\item 
\mbox{\Hypertarget{ltc6811_8c_aa207d81376ea588d3e1939d08beed8b5}\label{ltc6811_8c_aa207d81376ea588d3e1939d08beed8b5}} 
\#define {\bfseries CLEARBIT}(value,  bit)~value \&= $\sim$(1 $<$$<$ (bit))
\item 
\mbox{\Hypertarget{ltc6811_8c_a285d4d6120fe85065b72fd4082f001ab}\label{ltc6811_8c_a285d4d6120fe85065b72fd4082f001ab}} 
\#define {\bfseries SETBIT}(value,  bit)~value $\vert$= (1 $<$$<$ (bit))
\item 
\mbox{\Hypertarget{ltc6811_8c_a6bf534c4792f6eb7686963ae7737923d}\label{ltc6811_8c_a6bf534c4792f6eb7686963ae7737923d}} 
\#define {\bfseries ASSIGNBIT}(value,  newvalue,  bit)~value = ((value) \& $\sim$(1 $<$$<$ (bit))) $\vert$ ((newvalue) $<$$<$ (bit))
\item 
\mbox{\Hypertarget{ltc6811_8c_af74939cf4177382dbc4b6d063eaf95ad}\label{ltc6811_8c_af74939cf4177382dbc4b6d063eaf95ad}} 
\#define {\bfseries BATT\+\_\+\+CONFIG\+\_\+\+SIZE}~6
\item 
\mbox{\Hypertarget{ltc6811_8c_a87738054f9a89f0ac29c6ee1fb7da08d}\label{ltc6811_8c_a87738054f9a89f0ac29c6ee1fb7da08d}} 
\#define {\bfseries COMMAND\+\_\+\+SIZE}~2
\item 
\mbox{\Hypertarget{ltc6811_8c_a04ff6e55085dace34c25eb0f3a4174f3}\label{ltc6811_8c_a04ff6e55085dace34c25eb0f3a4174f3}} 
\#define {\bfseries PEC\+\_\+\+SIZE}~2
\item 
\mbox{\Hypertarget{ltc6811_8c_accdf2bb6277ead15124b67e519d4cf18}\label{ltc6811_8c_accdf2bb6277ead15124b67e519d4cf18}} 
\#define {\bfseries VOLTAGE\+\_\+\+BLOCK\+\_\+\+SIZE}~6
\item 
\mbox{\Hypertarget{ltc6811_8c_ac4b9c36ba3e73f44bbf3c77ef99efd9d}\label{ltc6811_8c_ac4b9c36ba3e73f44bbf3c77ef99efd9d}} 
\#define {\bfseries AUX\+\_\+\+BLOCK\+\_\+\+SIZE}~6
\item 
\mbox{\Hypertarget{ltc6811_8c_aab753a90305f2ea20894c89fbe5b4835}\label{ltc6811_8c_aab753a90305f2ea20894c89fbe5b4835}} 
\#define {\bfseries CELL\+\_\+\+VOLTAGE\+\_\+\+SIZE\+\_\+\+BYTES}~2
\item 
\mbox{\Hypertarget{ltc6811_8c_a4a61b9aeb7e1d0a9268a03bf29aa62fa}\label{ltc6811_8c_a4a61b9aeb7e1d0a9268a03bf29aa62fa}} 
\#define {\bfseries STATUS\+\_\+\+SIZE}~6
\item 
\mbox{\Hypertarget{ltc6811_8c_ad20232d08327b5fd77fa6618a48127ef}\label{ltc6811_8c_ad20232d08327b5fd77fa6618a48127ef}} 
\#define {\bfseries JUNK\+\_\+\+SIZE}~1
\item 
\mbox{\Hypertarget{ltc6811_8c_a9cbe7e6c88591303dc3f33a89947cf79}\label{ltc6811_8c_a9cbe7e6c88591303dc3f33a89947cf79}} 
\#define {\bfseries STATUS\+\_\+\+INDEX\+\_\+\+END}~4
\item 
\mbox{\Hypertarget{ltc6811_8c_a86a7db3177f5bc29c14dae2accdde1ee}\label{ltc6811_8c_a86a7db3177f5bc29c14dae2accdde1ee}} 
\#define {\bfseries STATUS\+\_\+\+INDEX\+\_\+\+START}~2
\item 
\mbox{\Hypertarget{ltc6811_8c_afe49c32283f393bb40d81a22c8ebcb2e}\label{ltc6811_8c_afe49c32283f393bb40d81a22c8ebcb2e}} 
\#define {\bfseries TEMP\+\_\+\+ADC\+\_\+\+IDX\+\_\+\+LOW}~2
\item 
\mbox{\Hypertarget{ltc6811_8c_a71c9b927afd11fcebd4166e186fdc75c}\label{ltc6811_8c_a71c9b927afd11fcebd4166e186fdc75c}} 
\#define {\bfseries TEMP\+\_\+\+ADC\+\_\+\+IDX\+\_\+\+HIGH}~3
\item 
\mbox{\Hypertarget{ltc6811_8c_a858ce927ea437917ac9eb27e797df670}\label{ltc6811_8c_a858ce927ea437917ac9eb27e797df670}} 
\#define {\bfseries GPIO\+\_\+\+CONVERSION\+\_\+\+TIME}~800
\item 
\mbox{\Hypertarget{ltc6811_8c_acad099d2d71f1ab68957e8b83efb73d1}\label{ltc6811_8c_acad099d2d71f1ab68957e8b83efb73d1}} 
\#define {\bfseries BATT\+\_\+\+CONVERSION\+\_\+\+TIME}~3000
\item 
\mbox{\Hypertarget{ltc6811_8c_ac03b217cf0faae0a0052bd9e699a7780}\label{ltc6811_8c_ac03b217cf0faae0a0052bd9e699a7780}} 
\#define {\bfseries T\+\_\+\+SLEEP\+\_\+\+US}~2000000
\item 
\mbox{\Hypertarget{ltc6811_8c_a912c30cb81d42f3282521aee2d3ab021}\label{ltc6811_8c_a912c30cb81d42f3282521aee2d3ab021}} 
\#define {\bfseries T\+\_\+\+WAKE\+\_\+\+MS}~1
\item 
\mbox{\Hypertarget{ltc6811_8c_a1e2365ab89f2a709d6f07f2f90c7f961}\label{ltc6811_8c_a1e2365ab89f2a709d6f07f2f90c7f961}} 
\#define {\bfseries T\+\_\+\+READY\+\_\+\+US}~10
\item 
\mbox{\Hypertarget{ltc6811_8c_a31b762bf40fcac7694d88bd7ce4b450c}\label{ltc6811_8c_a31b762bf40fcac7694d88bd7ce4b450c}} 
\#define {\bfseries T\+\_\+\+IDLE\+\_\+\+MS}~5
\item 
\mbox{\Hypertarget{ltc6811_8c_aa500dc0b436d69a2e9b0bd7c4c2c75b6}\label{ltc6811_8c_aa500dc0b436d69a2e9b0bd7c4c2c75b6}} 
\#define {\bfseries T\+\_\+\+REFUP\+\_\+\+MS}~6
\item 
\mbox{\Hypertarget{ltc6811_8c_a50cd7bdbfc3378829fbef7a1e648c0ef}\label{ltc6811_8c_a50cd7bdbfc3378829fbef7a1e648c0ef}} 
\#define {\bfseries ADC\+\_\+\+OPT}(en)~(en $<$$<$ 0)
\item 
\mbox{\Hypertarget{ltc6811_8c_aa7f91eaa43b142f2cb47f1dec5fe9463}\label{ltc6811_8c_aa7f91eaa43b142f2cb47f1dec5fe9463}} 
\#define {\bfseries SWTRD}(en)~(en $<$$<$ 1)
\item 
\mbox{\Hypertarget{ltc6811_8c_a2bef9dc3d18fc1dcc9ad3875bda0f331}\label{ltc6811_8c_a2bef9dc3d18fc1dcc9ad3875bda0f331}} 
\#define {\bfseries REFON}(en)~(en $<$$<$ 2)
\item 
\mbox{\Hypertarget{ltc6811_8c_ac229bc7d7ab296bae8d618bfc263cb6f}\label{ltc6811_8c_ac229bc7d7ab296bae8d618bfc263cb6f}} 
\#define {\bfseries GPIO5\+\_\+\+POS}~7
\item 
\mbox{\Hypertarget{ltc6811_8c_a6b7b0b1548ed6d80f164551d5db54bb2}\label{ltc6811_8c_a6b7b0b1548ed6d80f164551d5db54bb2}} 
\#define {\bfseries GPIO4\+\_\+\+POS}~6
\item 
\mbox{\Hypertarget{ltc6811_8c_a1421f5d74b0c9d188d600794643cae0a}\label{ltc6811_8c_a1421f5d74b0c9d188d600794643cae0a}} 
\#define {\bfseries GPIO3\+\_\+\+POS}~5
\item 
\mbox{\Hypertarget{ltc6811_8c_ac596b7d456e5c45f78057be73c2df717}\label{ltc6811_8c_ac596b7d456e5c45f78057be73c2df717}} 
\#define {\bfseries GPIO2\+\_\+\+POS}~4
\item 
\mbox{\Hypertarget{ltc6811_8c_a66dd7216a0486d23ee886f94572f8b79}\label{ltc6811_8c_a66dd7216a0486d23ee886f94572f8b79}} 
\#define {\bfseries GPIO1\+\_\+\+POS}~3
\item 
\#define \mbox{\hyperlink{ltc6811_8c_adc860e0c23d84c824007b6a211e79c61}{VUV}}~0x658
\item 
\mbox{\Hypertarget{ltc6811_8c_a7f4f4c74e436e233078f69214b0de84e}\label{ltc6811_8c_a7f4f4c74e436e233078f69214b0de84e}} 
\#define {\bfseries VOV}~0x8\+CA
\item 
\mbox{\Hypertarget{ltc6811_8c_a701803ff9a7e6abc9fb71fb647260c4e}\label{ltc6811_8c_a701803ff9a7e6abc9fb71fb647260c4e}} 
\#define {\bfseries VOLTAGE\+\_\+\+REGISTER\+\_\+\+COUNTS\+\_\+\+PER\+\_\+\+VOLT}~10000
\item 
\mbox{\Hypertarget{ltc6811_8c_a828c46ad272332ae84845531a78b41d5}\label{ltc6811_8c_a828c46ad272332ae84845531a78b41d5}} 
\#define {\bfseries HSPI\+\_\+\+TIMEOUT}~15
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{ltc6811_8c_ad8b550ce6ec58f283e62a96ffc5012e7}\label{ltc6811_8c_ad8b550ce6ec58f283e62a96ffc5012e7}} 
HAL\+\_\+\+Status\+Type\+Def {\bfseries spi\+\_\+tx\+\_\+rx} (uint8\+\_\+t $\ast$tdata, uint8\+\_\+t $\ast$rbuffer, unsigned int len)
\item 
\mbox{\Hypertarget{ltc6811_8c_a877fbade1097a0f7a8d92cb1fe140fd4}\label{ltc6811_8c_a877fbade1097a0f7a8d92cb1fe140fd4}} 
HAL\+\_\+\+Status\+Type\+Def {\bfseries batt\+\_\+spi\+\_\+tx} (uint8\+\_\+t $\ast$tx\+Buffer, size\+\_\+t len)
\item 
\mbox{\Hypertarget{ltc6811_8c_aa34880d25e5271cdc802f42244f296eb}\label{ltc6811_8c_aa34880d25e5271cdc802f42244f296eb}} 
void {\bfseries batt\+\_\+init\+\_\+board\+\_\+config} (uint16\+\_\+t board)
\item 
\mbox{\Hypertarget{ltc6811_8c_ae5189473d88cbc9c95bec62bea119690}\label{ltc6811_8c_ae5189473d88cbc9c95bec62bea119690}} 
void {\bfseries batt\+\_\+gen\+\_\+pec} (uint8\+\_\+t $\ast$arrdata, unsigned int num\+\_\+bytes, uint8\+\_\+t $\ast$pec\+Addr)
\item 
\mbox{\Hypertarget{ltc6811_8c_abb934da9ceb6a1033ecca18dc302ff63}\label{ltc6811_8c_abb934da9ceb6a1033ecca18dc302ff63}} 
HAL\+\_\+\+Status\+Type\+Def {\bfseries check\+PEC} (uint8\+\_\+t $\ast$rx\+Buffer, size\+\_\+t data\+Size)
\item 
\mbox{\Hypertarget{ltc6811_8c_ad6558a7978dc4e259a559dc105ae4f51}\label{ltc6811_8c_ad6558a7978dc4e259a559dc105ae4f51}} 
void {\bfseries delay\+\_\+us} (uint32\+\_\+t time\+\_\+us)
\item 
\mbox{\Hypertarget{ltc6811_8c_a33a22f924ede7e8772d0b4f56b344c41}\label{ltc6811_8c_a33a22f924ede7e8772d0b4f56b344c41}} 
int {\bfseries batt\+\_\+spi\+\_\+wakeup} (bool sleeping)
\item 
\mbox{\Hypertarget{ltc6811_8c_afc4b749b996cce4e7c4cb98f832a0e8b}\label{ltc6811_8c_afc4b749b996cce4e7c4cb98f832a0e8b}} 
HAL\+\_\+\+Status\+Type\+Def {\bfseries batt\+\_\+format\+\_\+broadcast\+\_\+command} (uint8\+\_\+t cmd\+Byte\+Low, uint8\+\_\+t cmd\+Byte\+High, uint8\+\_\+t $\ast$tx\+Buffer)
\item 
\mbox{\Hypertarget{ltc6811_8c_a2150f002603baac59966270488687aaa}\label{ltc6811_8c_a2150f002603baac59966270488687aaa}} 
HAL\+\_\+\+Status\+Type\+Def {\bfseries batt\+\_\+write\+\_\+config} ()
\item 
\mbox{\Hypertarget{ltc6811_8c_ad6013027859c0de9b051f6e211e9573b}\label{ltc6811_8c_ad6013027859c0de9b051f6e211e9573b}} 
HAL\+\_\+\+Status\+Type\+Def {\bfseries batt\+\_\+read\+\_\+data} (uint8\+\_\+t cmd\+Byte\+Low, uint8\+\_\+t cmd\+Byte\+High, uint8\+\_\+t $\ast$data\+Out\+Buffer, size\+\_\+t read\+Size\+Per\+Board)
\item 
\mbox{\Hypertarget{ltc6811_8c_a89185e147fa6785b3470869603e18acb}\label{ltc6811_8c_a89185e147fa6785b3470869603e18acb}} 
HAL\+\_\+\+Status\+Type\+Def {\bfseries batt\+\_\+read\+\_\+config} (uint8\+\_\+t $\ast$rx\+Buffer)
\item 
\mbox{\Hypertarget{ltc6811_8c_a69e579b99844f6bd5f02bdfb7b835f3b}\label{ltc6811_8c_a69e579b99844f6bd5f02bdfb7b835f3b}} 
HAL\+\_\+\+Status\+Type\+Def {\bfseries batt\+\_\+init} ()
\item 
\mbox{\Hypertarget{ltc6811_8c_ae28ae4cc57cf46a9e442fb231db8425a}\label{ltc6811_8c_ae28ae4cc57cf46a9e442fb231db8425a}} 
HAL\+\_\+\+Status\+Type\+Def {\bfseries batt\+\_\+read\+Back\+Cell\+Voltage} (float $\ast$cell\+\_\+voltage\+\_\+array)
\item 
\mbox{\Hypertarget{ltc6811_8c_a270813547f0f30f31fbc2819ac381c5f}\label{ltc6811_8c_a270813547f0f30f31fbc2819ac381c5f}} 
HAL\+\_\+\+Status\+Type\+Def {\bfseries batt\+\_\+read\+\_\+cell\+\_\+voltages} (float $\ast$cell\+\_\+voltage\+\_\+array)
\item 
\mbox{\Hypertarget{ltc6811_8c_a44c47f5c168370dc0bb2f11b1b5cdc31}\label{ltc6811_8c_a44c47f5c168370dc0bb2f11b1b5cdc31}} 
float {\bfseries batt\+\_\+convert\+\_\+voltage\+\_\+to\+\_\+temp} (float voltage)
\item 
\mbox{\Hypertarget{ltc6811_8c_a04b20b9c3b615110a88ccdf4930c51fd}\label{ltc6811_8c_a04b20b9c3b615110a88ccdf4930c51fd}} 
HAL\+\_\+\+Status\+Type\+Def {\bfseries batt\+\_\+read\+\_\+cell\+\_\+temps\+\_\+single\+\_\+channel} (size\+\_\+t channel, float $\ast$cell\+\_\+temp\+\_\+array)
\item 
\mbox{\Hypertarget{ltc6811_8c_a461bf3185b47d4e5deec0ad8ed3703d5}\label{ltc6811_8c_a461bf3185b47d4e5deec0ad8ed3703d5}} 
HAL\+\_\+\+Status\+Type\+Def {\bfseries batt\+\_\+read\+\_\+cell\+\_\+temps} (float $\ast$cell\+\_\+temp\+\_\+array)
\item 
\mbox{\Hypertarget{ltc6811_8c_a92a5527a207a1a7eab501cb274cfc4ec}\label{ltc6811_8c_a92a5527a207a1a7eab501cb274cfc4ec}} 
HAL\+\_\+\+Status\+Type\+Def {\bfseries batt\+\_\+read\+\_\+cell\+\_\+voltages\+\_\+and\+\_\+temps} (float $\ast$cell\+\_\+voltage\+\_\+array, float $\ast$cell\+\_\+temp\+\_\+array)
\item 
\mbox{\Hypertarget{ltc6811_8c_a8b81b1f445f3ea0a2ca4be7993a55fe1}\label{ltc6811_8c_a8b81b1f445f3ea0a2ca4be7993a55fe1}} 
HAL\+\_\+\+Status\+Type\+Def {\bfseries send\+ADOWCMD} (uint8\+\_\+t pullup)
\item 
\mbox{\Hypertarget{ltc6811_8c_a5f28e02e9042fac10566ccd33055107b}\label{ltc6811_8c_a5f28e02e9042fac10566ccd33055107b}} 
float {\bfseries float\+\_\+abs} (float x)
\item 
\mbox{\Hypertarget{ltc6811_8c_a34e3a15c6e14e689263ecf24e6976798}\label{ltc6811_8c_a34e3a15c6e14e689263ecf24e6976798}} 
void {\bfseries add\+Cell\+Voltages} (float $\ast$cell\+\_\+voltages, float $\ast$cell\+\_\+voltages\+\_\+average)
\item 
\mbox{\Hypertarget{ltc6811_8c_a4ad01f53790d62f9da74fc4c413b4a84}\label{ltc6811_8c_a4ad01f53790d62f9da74fc4c413b4a84}} 
void {\bfseries divide\+Cell\+Voltages} (float $\ast$cell\+\_\+voltages\+\_\+average, unsigned int num\+\_\+readings)
\item 
\mbox{\Hypertarget{ltc6811_8c_a5fa69ef198c71293dee9f06a19948197}\label{ltc6811_8c_a5fa69ef198c71293dee9f06a19948197}} 
HAL\+\_\+\+Status\+Type\+Def {\bfseries perform\+Open\+Circuit\+Test\+Reading} (float $\ast$cell\+\_\+voltages, bool pullup, unsigned int num\+\_\+readings)
\item 
\mbox{\Hypertarget{ltc6811_8c_ae1465efe2812c47454aa2472d07ba88f}\label{ltc6811_8c_ae1465efe2812c47454aa2472d07ba88f}} 
HAL\+\_\+\+Status\+Type\+Def {\bfseries check\+For\+Open\+Circuit} ()
\item 
\mbox{\Hypertarget{ltc6811_8c_a195d06cb021b2d6e1c3f6877c7dce697}\label{ltc6811_8c_a195d06cb021b2d6e1c3f6877c7dce697}} 
void {\bfseries batt\+\_\+set\+\_\+balancing\+\_\+cell} (int board, int cell)
\item 
\mbox{\Hypertarget{ltc6811_8c_ade492dd40b5c05cced4ddfc4dc11e473}\label{ltc6811_8c_ade492dd40b5c05cced4ddfc4dc11e473}} 
void {\bfseries batt\+\_\+unset\+\_\+balancing\+\_\+cell} (int board, int cell)
\item 
\mbox{\Hypertarget{ltc6811_8c_a4688fa058fa172d966321d08a57022c8}\label{ltc6811_8c_a4688fa058fa172d966321d08a57022c8}} 
bool {\bfseries batt\+\_\+get\+\_\+balancing\+\_\+cell\+\_\+state} (int board, int cell)
\item 
\mbox{\Hypertarget{ltc6811_8c_a7cf49fe3c9809ef6d0920eb322b640e0}\label{ltc6811_8c_a7cf49fe3c9809ef6d0920eb322b640e0}} 
HAL\+\_\+\+Status\+Type\+Def {\bfseries batt\+\_\+balance\+\_\+cell} (int cell)
\item 
\mbox{\Hypertarget{ltc6811_8c_a265419e3399d2e64f36eba3e266ca7ed}\label{ltc6811_8c_a265419e3399d2e64f36eba3e266ca7ed}} 
HAL\+\_\+\+Status\+Type\+Def {\bfseries batt\+\_\+stop\+\_\+balance\+\_\+cell} (int cell)
\item 
\mbox{\Hypertarget{ltc6811_8c_a4daa19d51cc618af1f72e0b8094640df}\label{ltc6811_8c_a4daa19d51cc618af1f72e0b8094640df}} 
bool {\bfseries batt\+\_\+is\+\_\+cell\+\_\+balancing} (int cell)
\item 
\mbox{\Hypertarget{ltc6811_8c_a2a661887e71a5361cf40681241c096b4}\label{ltc6811_8c_a2a661887e71a5361cf40681241c096b4}} 
HAL\+\_\+\+Status\+Type\+Def {\bfseries batt\+\_\+unset\+\_\+balancing\+\_\+all\+\_\+cells} ()
\item 
\mbox{\Hypertarget{ltc6811_8c_a834a806df72b807b8adb49a05a1b7e1d}\label{ltc6811_8c_a834a806df72b807b8adb49a05a1b7e1d}} 
HAL\+\_\+\+Status\+Type\+Def {\bfseries batt\+\_\+set\+\_\+disharge\+\_\+timer} (Discharge\+Timer\+Length length)
\item 
\mbox{\Hypertarget{ltc6811_8c_a55ef1ee39ffded111d7e8a7a110b3646}\label{ltc6811_8c_a55ef1ee39ffded111d7e8a7a110b3646}} 
HAL\+\_\+\+Status\+Type\+Def {\bfseries balance\+Test} ()
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
uint8\+\_\+t {\bfseries thermistor\+Channel\+To\+Mux\+Lookup} \mbox{[}TEMP\+\_\+\+CHANNELS\+\_\+\+PER\+\_\+\+BOARD+1\mbox{]}
\item 
\mbox{\Hypertarget{ltc6811_8c_a718ac3bdfaad5f4cd9743ff812f64139}\label{ltc6811_8c_a718ac3bdfaad5f4cd9743ff812f64139}} 
uint32\+\_\+t {\bfseries last\+Wakeup\+\_\+ticks} = 0
\item 
\mbox{\Hypertarget{ltc6811_8c_ad3791080d077a01d1a34d34a22c30105}\label{ltc6811_8c_ad3791080d077a01d1a34d34a22c30105}} 
float {\bfseries cell\+\_\+voltages\+\_\+single\+\_\+reading} \mbox{[}CELLS\+\_\+\+PER\+\_\+\+BOARD $\ast$NUM\+\_\+\+BOARDS\mbox{]}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Module for communicating with ltc6811 chips on the AMS boards. 

\begin{DoxyAuthor}{Author}
Richard Matthews
\end{DoxyAuthor}
The ltc6811 chips are battery monitoring chips, with one on each AMS board connected to 12 battery cells. The chips measure the voltage and temperature of the cells. They communicate with the BMU over iso\+SPI (an electrically isolated SPI interface). This file implements a driver for communicating with the ltc6811 chips 

\doxysubsection{Macro Definition Documentation}
\mbox{\Hypertarget{ltc6811_8c_adc860e0c23d84c824007b6a211e79c61}\label{ltc6811_8c_adc860e0c23d84c824007b6a211e79c61}} 
\index{ltc6811.c@{ltc6811.c}!VUV@{VUV}}
\index{VUV@{VUV}!ltc6811.c@{ltc6811.c}}
\doxysubsubsection{\texorpdfstring{VUV}{VUV}}
{\footnotesize\ttfamily \#define VUV~0x658}

Voltage constants in 100uV steps 

\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{ltc6811_8c_ae606ce0387682d384ca24c9c41613dd3}\label{ltc6811_8c_ae606ce0387682d384ca24c9c41613dd3}} 
\index{ltc6811.c@{ltc6811.c}!thermistorChannelToMuxLookup@{thermistorChannelToMuxLookup}}
\index{thermistorChannelToMuxLookup@{thermistorChannelToMuxLookup}!ltc6811.c@{ltc6811.c}}
\doxysubsubsection{\texorpdfstring{thermistorChannelToMuxLookup}{thermistorChannelToMuxLookup}}
{\footnotesize\ttfamily uint8\+\_\+t thermistor\+Channel\+To\+Mux\+Lookup\mbox{[}TEMP\+\_\+\+CHANNELS\+\_\+\+PER\+\_\+\+BOARD+1\mbox{]}}

{\bfseries Initial value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{= \{}
\DoxyCodeLine{    0xA, 0x9, 0x8, 0x7, 0x6, 0x5, 0x4, 0x2, 0x3, 0x0, 0x1, 0xB, 0xC \}}

\end{DoxyCode}
