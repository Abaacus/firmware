import slash
from testbeds.hil_testbed import *
import can.interfaces.slcan as slcan

@slash.plugins.active
class ParamsPlugin(slash.plugins.PluginInterface):
	def get_name(self):
		return "Param Parsing Algorithm"

	def configure_argument_parser(self, parser):
		parser.add_argument('-t', '--testbed', help='testbed to use')

	def configure_from_parsed_args(self, args):
		self.testbed_name = args.testbed
		if self.testbed_name is None:
			self.testbed_name = "VehicleHIL"

	def session_start(self):
		slash.g.vehicle_bus = None
		slash.g.hil_bus = None
		
		slash.g.vehicle_listeners = {}
		slash.g.hil_listeners = {}

		slash.g.testbed = globals()[self.testbed_name]()
